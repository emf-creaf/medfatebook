# (PART) Landscape processes {-}

# Watershed hydrology {#watershedhydrology}

## Design principles

In gridded simulations, lateral water transport between adjancent cells is also considered. Then, the surface water inputs of the stand include not only precipitation and snow melt but also overland surface flows from cells of its upper microwatershed, with routing following T-HYDRO @Ostendorf1993; and subsurface flows (and variations in water table depth) are modelled following the kinematic wave approach of DSHVM @Wigmosta1994.


## State variables {#statevariableswatershed}

## Water balance {#watershedbalance}

### Water balance at cell level
When landscape hydrological processes are considered, daily variations in soil water content is then summarized as:
  \begin{equation}
  \Delta{SWC} = Pr + Sm + Ro - In - Ru - Dd - Es - Tr + \Delta{S_{sub}}
  \end{equation}
where $Ro$ is surface runon water entering the cell from neighbouring cells at higher elevation and $\Delta{S_{sub}}$ is the variation in water content derived from subsurface lateral processes. 

### Water balance at watershed level

## Process scheduling {#watershedbalancescheduling}

In gridded simulations,  however, water balance of a given day is conducted for all cells before starting the next day. Moreover, surface flows and subsurface flows are dealt in separate steps:
+ Vertical flows and overland lateral flows are simulated first. A relative discharge parameter table is prepared at the beginning of the simulation, and cells are processed in an order determined by elevation (i.e. cells at higher elevation are processed before cells at lower elevation) and the water balance of a given target cell is influenced by surface runon ($Ro$) coming froom those neighboring cells that are at higher elevation.
+ Subsurface flows (i.e., flows leading to $\Delta{S_{sub}}$) are simulated at the end of the day. Cells are allowed to exchange subsurface water with their eight neighbours, depending on the water table slope in each direction, which may not exactly follow elevation differences.

## Inputs and outputs

### Soil, vegetation and meteorology

**Soil**

**Vegetation**

**Meteorology**


### Control parameters {#watershedbalancecontrol}

### Model output {#watershedbalanceoutput}

#### Daily output


## Applications

## Details of processes

### Overland flows

To simulate surface runoff from one cell to the other, the approach of Ostendorf \& Reynolds
(1993) is used, as in SIERRA (Mouillot et al. 2001). Overland  water lateral transport occurs instantaneously and depends on topography only. The model determines cell neigbours following the queen rule (up to eight neighbours per cell). The proportion of surface water runoff of cell $i$ that will be added to the infiltration input (runon) of a neighbouring cell $j$ is @Quinn1991:
\begin{equation}
q_{ij} = \frac{\Delta z_{ij}/L_{ij}}{\sum_{j}{\Delta z_{ij}/L_{ij}}}
\end{equation}
if $\Delta z_{ij} = z_i - z_j > 0$, that is, if the difference in elevation between the two cells is positive (i.e. if $z_j < z_i$). Otherwise there is no overland transport from $i$ to $j$, i.e. $q_{ij} = 0$. $L_{ij}$ indicates the distance between cell $i$ and $j$ (which depends on cell size and on whether the neighbouring cell $j$ is diagonal to cell $i$). The sumatory of the denominator is done only for neighbours at lower elevation, so that $\sum_{i}{qij} = 1$. The table of $q_{ij}$ values is calculated at the beginning of simulations only.

Every day, cells are processed in order from higher to lower elevation. After the daily water balance of a given cell $i$, water runoff $R_i$ is divided among the neighbouring cells at lower elevation. The runon of a neighbour $j$, $O_j$ is updated as:

\begin{equation}
O_j = O_j + R_i \cdot q_{ij}
\end{equation}

Note that a given cell $j$ can receive overland flow from more than one neighbour. $O_j$ values are set to zero at the beginning of each day.

### Subsurface and grounwater flows

