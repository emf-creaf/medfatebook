# (PART) Forest growth modelling {-}

# Forest growth model {#growthmodelling}

This chapter provides an overview of a forest growth model, which builds on previous models and allows simulating carbon and water balance on a daily step basis for a given forest stand and for the period corresponding to input weather data. The model is run using function `growth()`, for a set of days, or function `growth_day()`, for a single day. 

Since it builds on water balance modelling, the forest growth model can be run in two different levels of complexity (basic and advanced, corresponding to chapters \@ref(basicwaterbalance) and \@ref(advancedwaterbalance)). While most of the description correspond to the forest growth model using an advanced water balance, we will indicate those design and formulation elements where the basic forest growth model differs from the advanced one.

The information provided in this chapter should be enough to understand what the model does and when it can be useful, but the reading previous chapters and the following ones should provide a more detailed understanding on how the different processes are formulated.

## Design principles

Like the preceding models, the physical structure of the stand is represented in one (vertical) dimension (i.e. the coordinates of plants are not explicit). The model is cohort-based, meaning that similar plant individuals are represented using a single entity with average characteristics (e.g. tree height or diameter) and a density variable is used to scale from individual level to the cohort level. Processes are implemented either at the cohort-level (water balance and photosynthesis) or at the individual level (carbon balance and tissue growth). Water fluxes, soil water balance and plant photosynthesis processes follow the design of the soil water balance model and this part of the model design will not be repeated here. The model tries to reproduce the physiological processes that modulate leaf area changes, sapwood area changes and in fine root area changes (this last process only under the advanced model), including those affecting carbon availability and sink limitations to tissue growth. Sapwood area formation leads to diameter and height increases, so that physiological processes involve structural changes. Nevertheless, since the model does not implement all processes and drivers (such as nutrient availability) affecting growth, the model includes input parameters to empirically constrain growth rates and plant size, i.e. maximum relative sapwood area growth rates, maximum plant height and diameter-height ratios. Simulations with the forest growth model can eventually lead to the death of some plant cohorts, either because of exhaustion of carbon reserves (i.e. plant starvation) or dehydration of plant tissues (i.e. plant desiccation).


### Carbon compartments, transport and carbon balance

Carbon pools are differentiated between **structural** and **labile**. In turn, labile carbon involves two different pools (**metabolic** and **storage**) with a transfer rate between them [@Richardson2013; @Dietze2014], which we assume to be regulated by the need to maintain, as much as possible, a minimum amount of sugar carbon for metabolic and osmotic purposes. 

 + *Structural carbon* corresponds carbon forming cell membranes, cell walls and the cytosolic machinery. Structural carbon is used to calculate maintenance respiration and growth costs. Structural carbon occurs in three compartments: **leaves**, **sapwood** (stem, branches and coarse roots) and **fine roots**, which have different maintenance and growth costs. Structural carbon is lost when senescence occurs in each of these compartments (in the case of sapwood due to conversion to heartwood).
 + *Metabolic carbon* is labile carbon assumed to correspond to sugars (glucose or fructose) that are used to sustain cell functioning (i.e. provide carbon for maintenance and growth). Metabolic carbon occurs in **leaves** and **sapwood**. Leaf metabolic carbon is generated from photosynthesis and used in different functions, including export to sapwood. An excess of leaf metabolic carbon can inhibit photosynthesis. Sugar concentration in the phloem is assumed to be (passively) in equilibrium with leaf metabolic sugar concentration. In sapwood, metabolic carbon comes from phloem transport and is used to sustain growth and maintenance respiration of sapwood and fine roots. Moreover, changes metabolic carbon are coupled to variations in osmotic potential. Excess sapwood metabolic carbon is diverted towards storage or root exudation.
+ *Storage carbon* in the leaf is intended to represent short-term storage (mainly starch in chloroplasts) and its inclusion in the model follows the need to buffer daily variations in leaf metabolic carbon as well as the corresponding leaf osmotic potential. Storage carbon in sapwood (branches, stems and coarse roots) is intended to serve as long-term (seasonal and inter-annual) storage.

Carbon balance of leaf labile (metabolic and storage) carbon is performed by considering photosynthesis, sugar-starch conversion and phloem transport. Growth and maintenance respiration is calculated at the individual level, by estimating the respiration of leaves, sapwood and fine root compartments. Sapwood respiration depends on sapwood area, stem height and coarse root length.


### Leaf area, sapwood area and fine root area dynamics

The forest growth model allows simulating variation leaf area, sapwood area and fine root area via the following processes:

 i. **Leaf area** of each plant cohort is divided between live (whether in resistance buds or unfolded leaves) and dead (standing dead leaves). Whereas in the water balance models expanded leaf area corresponded to the portion of live leaf area that was unfolded at any given moment, in the growth model live leaf area and expanded leaf area are conceptually the same, but leaf phenological phases still control leaf development. Leaf area growth occurs during *leaf unfolding* periods only, whereas *bud formation* periods are required to update the target leaf area in accordance to an allocation strategy (see below). Leaf senescence (and the corresponding increases in dead leaf area) can occur due to aging (as determined by leaf life span), due to a leaf negative carbon balance or due to drought impacts. 
 ii. Formation of **sapwood area** can only occur if leaves are present. Sapwood formation is modelled as a ring of tracheids that are issued from cambium divisions and progressively undergo enlargement and maturation (ref). Losses in sapwood area (i.e. conversion to heartwood) can occur via stem embolism or aging (i.e. assuming a daily rate of conversion). Similarly to 3-PG [@Landsberg1997] we assume that the relative turnover rate of sapwood is smallest for young plants, and it increases up to a maximum value.
 iii. **Fine root area** dynamics also arises from the interplay of fine root growth and senescence, the latter occurring via aging (i.e. turnover rate depending on soil temperature). 

Formation of leaf, sapwood and fine root tissues is determined taking into account both source (i.e. carbon assimilation) and sink (i.e. carbon investment on plant tissue expansion) limitations [@Fatichi2014; @Guillemot2015; @Korner2015]. However, while leaf and fine root source limitations are set by available metabolic carbon, stem growth is assumed to be limited by availability of storage (i.e. starch) in the stem. This is done to create a preferential allocation into leaf and fine root tissues over stem growth, as long as leaf and fine root areas are below the respective targets set by allocation rules. Two options are possible regarding allocation between leaves and sapwood tissues:

  1. *Constant Huber value*: In this strategy, growth of leaf area and sapwood area need to be coordinated so that Huber value remains constant. Increases in leaf area are scheduled whenever Huber value is larger than the target (i.e. there is an excess of sapwood area). This is similar to the LPG model [@Sitch2003], where different turnover rates are applied for different tissues, but then tries to satisfy the pipe model [@Shinozaki1964] by allocating C where it is more limiting. Note that in this strategy the whole-plant conductance will progressively decrease with the progressive increase in plant height. 
  2. *Constant whole-plant conductance*: Ratios of leaf area to sapwood area (Huber value) can vary within species, due to environmental conditions [@Mencuccini1995]. In this allocation strategy, growth of leaf area, sapwood area and height needs to be coordinated so that whole-plant conductance (excluding rhizosphere) is constant and equal to the initial value. Increases in leaf area are scheduled whenever the current whole-plant conductance is above target value.  

Fine root area growth is coordinated with the other tissues via the need to ensure an average resistance fraction in the rhizosphere, which is used to define the fine root area target. Growth rate in all three tissues is regulated by maximum relative growth rates (i.e. the daily growth area relative to the amount of tissue area present). However, since leaf and fine root area targets depend on sapwood area, the relative growth rate for sapwood area indirectly determines the growth rates of leaves and fine roots. 

### Tree diameter, tree height and shrub cover updates

Tree structural variables are updated as in forest gap models [@Lindner1997].


### Links between plant hydraulics and carbon balance

The model tries to coordinate carbon and water aspects of plant functioning by establishing several links between them (figure below):

 a. Transpiration and photosynthesis are coordinated via the stomatal regulation model.
 b. Leaf water potential of symplastic tissues determines turgor of leaf tissues for growth, while sugar concentration in the leaf tissues determines changes in osmotic potential at full turgor and hence, the relative water content of symplasmic storage.
 c. Analogously, water potential of stem symplastic tissues determines the turgor in the cambium and the sapwood formation rate, while the sugar concentration in the sapwood determines the osmotic potential at full turgor of stem symplastic tissues.
 d. Leaf growth and senescence influence hydraulic conductance of several tissues (fine roots, coarse root sapwood and stem sapwood) via changes in leaf area.
 e. Sapwood growth and senescence influence hydraulic conductance of coarse root and stem sapwood via changes in sapwood area.
 f. Fine root dynamics (should) influence fine root conductance and distribution across soil layers.

```{r, out.width='100%', fig.align="center", fig.cap="Schematic representation of relationships between plant hydraulics and carbon balance", echo=FALSE}
knitr::include_graphics("hydraulics_carbon_relations.png")
```


## State variables

Some state variables are inherited by the corresponding water balance model (see  \@ref(statevariablesbasic) and \@ref(statevariablesadvanced)). 

Several structural variables that were treated parameters in the water balance models become state variables here (for each cohort $i$):

 + Leaf area index of live leaves, $LAI^{live}_i$.
 + Diameter at breast height for trees, $DBH_i$.
 + Percent cover of shrubs, $Cover_i$.
 + Plant height, $H_i$.
 + Crown ratio, $CR_i$.
 + The proportion of fine roots, $FRP_{i,s}$, in each soil layer $s$.
 + The radial length of coarse roots $L_{radial, i,s}$ in each soil layer $s$.
 
 Finally, there are functional state variables necessary to know the physiological status of plants, defined at the individual level:
 
 + Sapwood area, $SA_i$ (in $cm^2$).
 + Leaf area, $LA_i$ (in $m^2$)
 + Fine root area, $FRA_i$ (in $m^2$).
 + Sugar storage in leaves, $SS_{leaf,i}$ ($mol gluc ·L^{-1}$).
 + Starch storage in leaves, $ST_{leaf,i}$ ($mol gluc ·L^{-1}$).
 + Sugar storage in sapwood (stem, branches and coarse roots), $SS_{sapwood,i}$ ($mol gluc ·L^{-1}$).
 + Starch storage in sapwood (stem, branches and coarse roots), $ST_{sapwood,i}$ ($mol gluc ·L^{-1}$).
 
Note that other functional variables can be derived from state variables and, hence, hence do not need to be treated as state variables themselves:

 + Leaf biomass (in $g C$) from $LAI^{live}$, $N$ and $SLA$.
 + Leaf volume (in $l$) from leaf biomass and density of leaf tissue.
 + Sapwood volume (in $l$) from $SA$, $H$ and $FRP$ and $L_{radial}$.
 + Sapwood biomass (in $g C$) from sapwood volume and wood density.
 + Fine root biomass (in $g C$) from fine root area, specific root length ($SRL$) and fine root tissue density ($\rho_{fineroot}$).
 
## Carbon balance of different compartments

Since the growth model builds on soil and plant water balances models, the water and energy balances explained in sections \@ref(soilwaterbalance) or \@ref(waterenergybalances) (depending on `transpirationMode`) also hold for this model.

The model performs daily carbon balance in leaves and sapwood (stem, branches and coarse roots) for each plant cohort. In each of these two compartments carbon balance is performed for the two storage forms, dissolved sugars and starch. At the leaf level, the carbon balance equations for dissolved sugars and starch are ($i$ subscripts omitted):

\begin{eqnarray}
\Delta{SS_{leaf}} &=& A - R_{leaf} - F_{floem} - G_{leaf} - \Delta{ST_{leaf}}\\
\Delta{ST_{leaf}} &=& \Delta{t} \cdot [K_{synthesis}(SS_{leaf}) - K_{hydrolisis}(ST_{leaf})]
(\#eq:leafcarbonbalanceequations)
\end{eqnarray}
where $A$ is (gross) photosynthesis, $R_{leaf}$ is leaf respiration, $F_{floem}$ is the sugar flow via phloem towards the stem and roots, $G_{leaf}$ is the carbon lost via new leaf growth and $\Delta{ST_{leaf}}$ is the change in leaf starch. $K_{synthesis}$ and $K_{hydrolysis}$ are the instantaneous kinetic rates of starch synthesis and hydrolysis, respectively. Leaf senescence has no impact on dissolved sugar and starch compartments of leaves (but it affects leaf biomass, volume and leaf area) as it is assumed that these non-structural carbon sources are recycled before necrosis.

The corresponding carbon balance equations for sapwood dissolved sugars and starch are:
\begin{eqnarray}
\Delta{SS_{sapwood}} &=& F_{floem} - R_{sapwood} - R_{fineroots} - G_{sapwood} - G_{fineroots} \\
                     & & - \Delta{ST_{sapwood}} \\
\Delta{ST_{sapwood}} &=& \Delta{t} \cdot [K_{synthesis}(SS_{sapwood}) - K_{hydrolysis}(ST_{sapwood})]
(\#eq:sapwoodcarbonbalanceequations)
\end{eqnarray}
where $F_{floem}$ is the sugar inflow via phloem transport, $R_{sapwood}$ is the sum of respiration of branches, stem and coarse roots, $R_{fineroots}$ is the respiration of fine roots, $G_{sapwood}$ and $G_{fineroots}$ are the carbon expenses of growth of new sapwood tissue or fine roots (respectively). Analogously to leave senescence, when sapwood is converted into heartwood, non-structural carbon in the protoplasm of parenchyma cells is assumed to be absorbed by neighboring living cells.

## Process scheduling

For every day to be simulated, the model first updates the expanded leaf area of living plants according to the phenology of species and the day of the year and performs soil water balance, transpiration and photosynthesis calculations by calling the water balance submodel (see \@ref(basicwaterbalancescheduling) and \@ref(advancedwaterbalancescheduling)). 

After dealing with water fluxes and photosynthesis, the model performs the following daily steps:

1. Determine the current amount of live structural biomass (in leaves, sapwood and fine root compartments), storage volume (in leaves and sapwood) and carbon construction costs per unit tissue (leaf or sapwood) area. 
2. For every **subdaily step** perform carbon balance as follows:
    a. Calculate gross photosynthesis per individual ($A$).
    b. Determine maintenance respiration costs for leaves ($R_{leaf}$), sapwood ($R_{sapwood}$) and fine roots ($R_{fineroot}$), taking into account both live structural biomass and labile sugar biomass.
    c. Evaluate temperature and turgor sink limitations for growth of leaves and sapwood. If leaf/sapwood growth is permitted, estimate growth costs ($G_{leaf}$ and $G_{sapwood}$) and record leaf/sapwood area increases. 
    d. Update $SS_{leaf}$ and $SS_{sapwood}$ taking into account photosynthesis, maintenance respiration and growth respiration.
    e. Evaluate floem transport ($F_{floem}$) and sugar-starch dynamics ($K_{synthesis}$ and $K_{hydrolisis}$) in the leaf and sapwood compartments **at 1s time steps**. This completes the carbon balance of $SS_{leaf}$ \@ref(eq:leafcarbonbalanceequations) and $SS_{sapwood}$ \@ref(eq:sapwoodcarbonbalanceequations) for the subdaily time step.
  
3. If the balance of $SS_{leaf}$ is negative, apply leaf senescense as the exceeding leaf area according to respiration costs. Otherwise, a constant leaf senescense rate is applied according to leaf lifespan. Leaf senescence does not affect leaf C storage.
4. Apply a constant rate of sapwood senescense (conversion to heartwood), which does not affect sapwood C storage.
5. Increase sapwood area ($SA$) and leaf area ($LAI^{live}$) according to cumulative increases obtained from carbon balance.
6. Update Huber values, hydraulic conductance of stems and roots according to current sapwood and leaf area values. 
7. Update osmotic potential at full turgor of leaves and sapwood according to current sugar concentrations (a constant concentration of salts is assumed).
8. If non-stomatal photosynthesis limitations are considered, apply them.

At the end of each year (and at the end of the simulated period) the model translates cumulated sapwood area growth into structural variables (i.e., plant height, tree DBH, tree crown ratio and shrub cover). 


## Inputs and outputs

### Soil, vegetation and meteorology

**Soil**

Soil input requirements are the same as for the basic water balance model and were fully described in section \@ref(soilinput). @Genuchten1980 water retention curves are forced for this model, because rhizosphere conductance is modelled using van Genuchten hydraulic equations (see subsection \@ref(vulnerabilitycurves)).

**Vegetation**

Vegetation input requirements were fully described in section \@ref(vegetationinput). Trees and shrubs do not need to be characterized with different variables in soil water balance calculations, since both kinds of cohort have a $LAI$ value. In most cases, users only need to estimate the leaf area index corresponding to live leaves, i.e. $LAI^{live}$, because normally at the starting point all leaves are expanded (i.e. $LAI^{\phi} = LAI^{live}$) and one can assume no dead leaves in the canopy (i.e., $LAI^{dead} = 0$). Vegetation characteristics stay constant during simulations using function `spwb()`, although the actual expanded leaf area ($LAI^{\phi}$) and dead leaf area may vary if the species is winter deciduous.

**Metereological input**

Weather input data must include variables calculated at the **daily** scale. The variables required by function `growth()` depend on the transpiration mode, similarly to function `spwb()`. We recommend meteorological input to be generated using package **meteoland** [@DeCaceres2018].

### Vegetation functional parameters

Vegetation in the stand is described using a set of plant cohorts, described in an object of class `growthInput`. This function assembles all parameters needed for the simulation of a given stand in a single list. Model parameters are grouped by category.  Regarding physical aboveground description of the stand, each plant cohort is defined by its species identity ($SP$; with R name [`SP`]). In addition, each cohort needs to be defined regarding the following state variables:

+ $N$ [`N`]: The density of individuals (in $ind · ha^{-1}$).
+ $DBH$ [`DBH`]: Tree diameter at breast height (in cm).
+ $Cover$ [`Cover`]: Shrub percent cover (in %).
+ $H$ [`H`]: Total tree or shrub height (in cm).}
+ $CR$ [`CR`]: Crown ratio (i.e. the ratio between crown length and total height).}
+ $LAI^{live}$ [`LAI_live`]: Live leaf area index (one-side live leaf area of plants in the cohort per surface area of the stand) (in m$^2$·m$^{-2}$).}
+ $LAI^{\phi}$ [`LAI_expanded`]: Expanded leaf area index (one-side expanded leaf area of plants in the cohort per surface area of the stand) (in m$^2$·m$^{-2}$).}
+ $LAI^{dead}$ [`LAI_dead`]: Dead leaf area index (one-side dead leaf area of plants in the cohort per surface area of the stand) (in m$^2$·m$^{-2}$).}
+ $LAI^{predrought}$ [`LAI_predrought`]: Live leaf area index before the current drought started (one-side dead leaf area of plants in the cohort per surface area of the stand) (in m$^2$·m$^{-2}$).}
+ $SA$ [`SA`]: Area of functional sapwood per individual (in cm$^2$·ind$^{-1}$).}
+ $C_{fast}$ [`fastCstorage`]: Amount of C in the fast carbon storage pool (in g C·ind$^{-1}$).}
+ $C_{slow}$ [`slowCstorage`]: Amount of C in the slow carbon storage pool (in g C·ind$^{-1}$).}

Excepting $SP$ (species identity) and $N$ (density), the remaining aboveground state variables are modified during growth simulations. Belowground parameters are the following:

+ $Z$ [`Z`]: The rooting depth (in cm).}
+ $V$ [`V`]: A matrix with the proportion of fine roots in each soil layer.}

Additional belowground variables are included if `transpirationMode = "Complex"}. These, and the parameters needed for water balance calculations are described in vignette '\textbf{Soil description and root system architecture}'. 

The following physiological parameters are needed for growth calculations:

+ $SLA$ [`SLA`]: Specific leaf area (m$^2$·kg$^{-1}$).
+ $Hv$ [`Al2As`]: Huber value. Leaf area to sapwood area ratio (in m$^2$·m$^{-2}$).}
+ $W_{dens}$ [`WoodDens`]: Wood density (at 0\% humidity) (in g·cm$^{-3}$).}
+ $W_{C}$ [`WoodC`]: Wood carbon content in relation to dry weight (in g·g$^{-1}$).}
+ $C_{p,\max}$ [`Cstoragepmax`]: Maximum storage capacity, expressed as C per total respiratory C (in gC·gC$^{-1}$).
+ $RGR_{\max}$ [`RGRmax`]: Maximum daily relative growth rate (in sapwood area basis) (in cm$^2$·cm$^{-2}$).

Another set of parameters is needed to transform changes in sapwood area and leaf area to changes in the structural variables such as tree height, tree crown ratio or shrub cover:

+ $H_{\max}$ [`Hmax`]: Maximum plant height (in cm).
+ $f_{HD,\min}$, $f_{HD,\max}$ [`fHDmin}, `fHDmax`]: Minimum and maximum values of the height-diameter ratio (in cm·cm$^{-1}$).
+ $Z_{\max}$ [`Zmax`]: Maximum rooting depth (in mm).
+ $a_{ash}$ [`Aash`]: Regression coefficient for the quadratic relationship between shrub height and shrub area.
+ $a_{bsh}$, $b_{bsh}$ [`Absh`, `Bbsh`]: Allometric coefficients relating crown phytovolume with dry weight of shrub individuals.
+ $CR$ [`cr`]: Ratio between crown length and total height (constant value for shrubs).
+ $r_{6.35}$ [`r635`]: Ratio between the dry weight of leaves plus branches and the dry weight of leaves alone for branches of 6.35 mm of diameter.
+ $a_{cr}$, $b_{1cr}$, $b_{2cr}$, $b_{3cr}$, $c_{1cr}$, $c_{2cr}$ [`B1cr`, `B2cr`, `B3cr`, `C1cr`, `C2cr`]: Regression coefficients used to update the crown ratio of trees.
+ $a_{cw}$, $b_{cw}$ [`Acw`, `Bcw`]: Regression coefficients used to calculate the crown width of trees (as intermediary step to obtain the crown ratio).

### Control parameters

Control parameters modulate the overall behaviour of growth simulations (see section \@ref(controlparameters)). Parameters controlling water balance have been already described in sections \@ref(basicwaterbalancecontrol) and \@ref(basicwaterbalancecontrol). Here we only mention those control parameters specific to the `growth()` function:

+ `allocationStrategy  [="Plant_kmax"]` defines the allocation strategy (investment in leaf area vs. sapwood area) of the growth model. If `allocationStrategy = "Plant_kmax"` then the target leaf area is set to maintain the input whole-plant maximum conductance. If `allocationStrategy = "Al2As"` then the target leaf area is set to maintain the input Huber value.
+ `nonStomatalPhotosynthesisLimitation  [=TRUE]`: A flag to apply limitations of pho-tosynthesis when leaf sugar levels become too high (only for `transpirationMode = "Sperry"`).
+ `nonSugarConcentration [=0.3]`: A constant specifying non-sugar (inorganic) solute concentration ($mol \cdot l^{-1}$) in cells.
+ `equilibriumOsmoticConcentration [= c(leaf = 0.8, sapwood = 0.6)]`: Equilibrium osmotic concentrations ($mol \cdot l^{-1}$) for leaf and sapwood cells. 
+ `minimumSugarForGrowth [= c(leaf = 0.25, sapwood=0.25, fineroot = 0.25)]`:  Minimum concentration of sugars ($mol \cdot l^{-1}$) for growth to occur in different tissues. 
+ `respirationRates [= c(leaf = 0.00260274, sapwood = 6.849315e-05, fineroot = 0.002054795)]`: Maintenance respiration rates for different tissues ($g\,gluc \cdot g\, dry^{-1} · day^{-1}$).
+ `turnoverRates [= c(sapwood = 0.0001261398, fineroot = 0.001897231)]`: Relative turnover rates ($day^{-1}$) for sapwood and fineroots. Default are equivalent to 4.5% and 50% annual turnover for sapwood and fine roots, respectively.
+ `constructionCosts [= c(leaf = 1.5, sapwood = 1.47, fineroot = 1.30)]`: Construction costs, including respiration and structural carbon, per dry weight of new tissue ($g\,gluc \cdot g\,dry^{-1}$).
+ `maximumRelativeGrowthRates [= c(leaf = 0.01, sapwood = 0.001, fineroot = 0.1)]`: Maximum leaf growth rate relative to sapwood area ($m^{2}\cdot cm^{-2} \cdot day^{-1}$), maximum sapwood relative growth rate ($cm^{2}\cdot cm^{-2} \cdot day^{-1}$) and maximum fine root growth rate relative to sapwood area ($g\,dry \cdot g\,dry^{-1} \cdot day^{-1}$). Values for leaves and fine roots are used for all species, whereas the value for sapwood is the default used when relative growth rate is not specified via SpParams.

### Model output {#forestgrowthoutput}

#### Daily and annual output

Function `growth` returns a list object with the following elements (many of them equal to the output of function `spwb`, see sections \@ref(basicwaterbalanceoutput) and \@ref(advancedwaterbalanceoutput)):

| Element | Description                                                |
|---------|------------------------------------------------------------|
| `WaterBalance`| Climatic input and water balance flows (i.e. net precipitation, infiltration, runoff, transpiration...). All of them in $mm = l \cdot m^{-2}$. |
| `EnergyBalance` | Energy balance components (instantaneous values) for the soil and the canopy |
| `Temperature` | Minimum and maximum temperature values for topsoil, canopy and atmosphere |
| `Soil`| Soil variables for each soil layer: Moisture relative to field capacity ($W_s$), water potential ($\Psi_s$) and volumetric water content ($V_s$). |
| `Stand`| Stand-level variables, such as $LAI^{\phi}_{stand}$, $LAI^{dead}_{stand}$, the water retention capacity of the canopy ($S_{canopy}$) or the fraction of light reaching the ground ($L^{PAR}_{ground}$ and $L^{SWR}_{ground}$).|
| `Plants`| Plant-level variables, such as $LAI^{phi}_i$, plant transpiration, plant water potential, etc. |
| `SunlitLeaves` | Leaf-level output variables for sunlit leaves (`transpirationMode = "Sperry"`). |
| `ShadeLeaves` | Leaf-level output variables for shade leaves (`transpirationMode = "Sperry"`). |
| `PlantCarbonBalance`| A list with the daily results of carbon balance components (photosynthesis and respiration) and carbon pools. |
| `PlantGrowth`| A list with daily results of leaf area, sapwood area, fine root area and the corresponding daily growth rates. |
| `StandStructures`| A list with the aboveground structure of the stand at the beginning of the simulation and after each simulated year. |
| `StandSummary`| Stand-level summaries (leaf area index, tree basal area, tree density, shrub cover, etc.) at the beginning of the simulation and after each simulated year. |

The following table describes the child elements of `PlantCarbonBalance`, each of them a data frame with dates in rows and plant cohorts in columns:

| Element | Symbol | Units | Description                               |
|---------|--------|-------|-------------------------------------------|
| `GrossPhotosynthesis`|$A_{g,i}$ | $g\,gluc \cdot g\,dry^{-1} \cdot day^{-1}$ | Gross photosynthesis rate per dry weight of living biomass. |
| `MaintentanceRespiration`|$R_{m,i}$ | $g\,gluc \cdot g\,dry^{-1} \cdot day^{-1}$ | Maintenance respiration rate (including leaves, sapwood and fine roots) per dry weight of living biomass. |
| `GrowthRespiration`|$R_{g,i}$ | $g\,gluc \cdot g\,dry^{-1} \cdot day^{-1}$ | Growth respiration rate  (including leaves, sapwood and fine roots) per dry weight of living biomass. |
| `CarbonBalance`|$CB_{i}$ | $g\,gluc \cdot g\,dry^{-1}$ | Daily plant carbon balance (difference of photosynthesis - respiration) per dry weight of living biomass. |
| `SugarLeaf`|$SS_{leaf,i}$ | $mol\,gluc ·L^{-1}$ | Sugar concentration in leaves. |
| `StarchLeaf`|$ST_{leaf,i}$ | $mol\,gluc ·L^{-1}$ | Starch concentration in leaves. |
| `SugarSapwood`|$SS_{sapwood,i}$ | $mol\,gluc ·L^{-1}$ | Sugar concentration in sapwood. |
| `StarchSapwood`|$ST_{sapwood,i}$ | $mol gluc ·L^{-1}$ | Starch concentration in sapwood. |

The following table describes the child elements of `PlantGrowth`, again each of them a data frame with dates in rows and plant cohorts in columns:

| Element | Symbol | Units | Description                               |
|---------|--------|-------|-------------------------------------------|
| `LeafArea`|$LA_{i}$ | $m^{2}$ | Daily amount of leaf area for an average individual. |
| `SapwoodArea`|$SA_{i}$ | $cm^{2}$ | Daily amount of sapwood area for an average individual. |
| `FineRootArea`|$FRA_{i}$ | $m^{2}$ | Daily amount of fine root area for an average individual. |
| `LAgrowth`|$LA_{g,i}$ | $m^{2}\cdot cm^{-2} \cdot day^{-1}$ | Leaf area growth relative to sapwood area for an average individual. |
| `SAgrowth`|$SA_{g,i}$ | $cm^{2}\cdot cm^{-2} \cdot day^{-1}$ | Leaf area growth relative to sapwood area for an average individual. |
| `FRAgrowth`|$FRA_{g,i}$ | $m^{2}\cdot cm^{-2} \cdot day^{-1}$ | Fine root area growth relative to sapwood area for an average individual. |

#### Subdaily output

As with function `spwb()`, subdaily output can also be generated with function `growth()`. This is done via setting  `subdailyResults = TRUE` in the control parameter list. In that case, the output list of `growth()` will include an element `subdaily`, whose subelements correspond to the results of `growth_day()` for each date simulated. Refer to the documentation of functions `growth_day()` for details of subdaily output.

## Applications

We believe the model is suited to study variations of plant growth derived from environmental conditions and competition for light and water.