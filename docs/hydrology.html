<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Forest hydrology | The medfate reference book</title>
  <meta name="description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Forest hydrology | The medfate reference book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Forest hydrology | The medfate reference book" />
  
  <meta name="twitter:description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  



<meta name="date" content="2025-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="leafphenologylight.html"/>
<link rel="next" href="transpirationgranier.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">The medfate book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#an-collaborative-project"><i class="fa fa-check"></i>An collaborative project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#package-medfate"><i class="fa fa-check"></i><b>1.1.1</b> Package medfate</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#package-medfateland"><i class="fa fa-check"></i><b>1.1.2</b> Package medfateland</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#companion-packages"><i class="fa fa-check"></i><b>1.1.3</b> Companion packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#requirements"><i class="fa fa-check"></i><b>1.2.1</b> Requirements</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#installing-medfate"><i class="fa fa-check"></i><b>1.2.2</b> Installing medfate</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#installing-medfateland"><i class="fa fa-check"></i><b>1.2.3</b> Installing medfateland</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#main-functions-in-medfate"><i class="fa fa-check"></i><b>1.3</b> Main functions in medfate</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#dynamic-simulation-functions"><i class="fa fa-check"></i><b>1.3.1</b> Dynamic simulation functions</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#sub-model-functions"><i class="fa fa-check"></i><b>1.3.2</b> Sub-model functions</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#static-functions"><i class="fa fa-check"></i><b>1.3.3</b> Static functions</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#main-functions-in-medfateland"><i class="fa fa-check"></i><b>1.4</b> Main functions in medfateland</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="model-inputs.html"><a href="model-inputs.html"><i class="fa fa-check"></i><b>2</b> Model inputs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="model-inputs.html"><a href="model-inputs.html#input-structures"><i class="fa fa-check"></i><b>2.1</b> Input structures</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="model-inputs.html"><a href="model-inputs.html#inputstructuresmedfate"><i class="fa fa-check"></i><b>2.1.1</b> Input structures in medfate</a></li>
<li class="chapter" data-level="2.1.2" data-path="model-inputs.html"><a href="model-inputs.html#medfatelandstructures"><i class="fa fa-check"></i><b>2.1.2</b> Input structures in medfateland</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="model-inputs.html"><a href="model-inputs.html#topoinput"><i class="fa fa-check"></i><b>2.2</b> Latitude and topography</a></li>
<li class="chapter" data-level="2.3" data-path="model-inputs.html"><a href="model-inputs.html#soilinput"><i class="fa fa-check"></i><b>2.3</b> Soil description</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="model-inputs.html"><a href="model-inputs.html#soil-physical-properties"><i class="fa fa-check"></i><b>2.3.1</b> Soil physical properties</a></li>
<li class="chapter" data-level="2.3.2" data-path="model-inputs.html"><a href="model-inputs.html#waterretentioncurves"><i class="fa fa-check"></i><b>2.3.2</b> Water retention curves</a></li>
<li class="chapter" data-level="2.3.3" data-path="model-inputs.html"><a href="model-inputs.html#soilinitialization"><i class="fa fa-check"></i><b>2.3.3</b> Soil initialization</a></li>
<li class="chapter" data-level="2.3.4" data-path="model-inputs.html"><a href="model-inputs.html#watercontent"><i class="fa fa-check"></i><b>2.3.4</b> Water content and depth to saturation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="model-inputs.html"><a href="model-inputs.html#vegetationinput"><i class="fa fa-check"></i><b>2.4</b> Vegetation description</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="model-inputs.html"><a href="model-inputs.html#structural-attributes-of-woody-plant-cohorts"><i class="fa fa-check"></i><b>2.4.1</b> Structural attributes of woody plant cohorts</a></li>
<li class="chapter" data-level="2.4.2" data-path="model-inputs.html"><a href="model-inputs.html#structural-attributes-of-herbaceous-vegetation"><i class="fa fa-check"></i><b>2.4.2</b> Structural attributes of herbaceous vegetation</a></li>
<li class="chapter" data-level="2.4.3" data-path="model-inputs.html"><a href="model-inputs.html#leaf-area-index-of-the-forest-stand"><i class="fa fa-check"></i><b>2.4.3</b> Leaf area index of the forest stand</a></li>
<li class="chapter" data-level="2.4.4" data-path="model-inputs.html"><a href="model-inputs.html#forestobjects"><i class="fa fa-check"></i><b>2.4.4</b> Forest objects</a></li>
<li class="chapter" data-level="2.4.5" data-path="model-inputs.html"><a href="model-inputs.html#single-cohort-forests"><i class="fa fa-check"></i><b>2.4.5</b> Single-cohort forests</a></li>
<li class="chapter" data-level="2.4.6" data-path="model-inputs.html"><a href="model-inputs.html#leafdistribution"><i class="fa fa-check"></i><b>2.4.6</b> Vertical leaf distribution</a></li>
<li class="chapter" data-level="2.4.7" data-path="model-inputs.html"><a href="model-inputs.html#rootdistribution"><i class="fa fa-check"></i><b>2.4.7</b> Vertical root distribution</a></li>
<li class="chapter" data-level="2.4.8" data-path="model-inputs.html"><a href="model-inputs.html#optional-variables-in-forest-objects"><i class="fa fa-check"></i><b>2.4.8</b> Optional variables in forest objects</a></li>
<li class="chapter" data-level="2.4.9" data-path="model-inputs.html"><a href="model-inputs.html#plantwaterpools"><i class="fa fa-check"></i><b>2.4.9</b> Water pools and root horizontal distribution</a></li>
<li class="chapter" data-level="2.4.10" data-path="model-inputs.html"><a href="model-inputs.html#functionaltraits"><i class="fa fa-check"></i><b>2.4.10</b> Functional traits and vegetation initialization</a></li>
<li class="chapter" data-level="2.4.11" data-path="model-inputs.html"><a href="model-inputs.html#update-of-structural-variables-during-simulations"><i class="fa fa-check"></i><b>2.4.11</b> Update of structural variables during simulations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="model-inputs.html"><a href="model-inputs.html#meteoinput"><i class="fa fa-check"></i><b>2.5</b> Metereological input</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="model-inputs.html"><a href="model-inputs.html#date-format"><i class="fa fa-check"></i><b>2.5.1</b> Date format</a></li>
<li class="chapter" data-level="2.5.2" data-path="model-inputs.html"><a href="model-inputs.html#required-weather-variables"><i class="fa fa-check"></i><b>2.5.2</b> Required weather variables</a></li>
<li class="chapter" data-level="2.5.3" data-path="model-inputs.html"><a href="model-inputs.html#optional-weather-variables"><i class="fa fa-check"></i><b>2.5.3</b> Optional weather variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="model-inputs.html"><a href="model-inputs.html#derived-weather-variables"><i class="fa fa-check"></i><b>2.5.4</b> Derived weather variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="model-inputs.html"><a href="model-inputs.html#controlparameters"><i class="fa fa-check"></i><b>2.6</b> Simulation control</a></li>
</ul></li>
<li class="part"><span><b>II Basic water balance modelling</b></span></li>
<li class="chapter" data-level="3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html"><i class="fa fa-check"></i><b>3</b> Basic water balance model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicdesign"><i class="fa fa-check"></i><b>3.1</b> Design principles</a></li>
<li class="chapter" data-level="3.2" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#statevariablesbasic"><i class="fa fa-check"></i><b>3.2</b> State variables</a></li>
<li class="chapter" data-level="3.3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#soilwaterbalance"><i class="fa fa-check"></i><b>3.3</b> Water balance</a></li>
<li class="chapter" data-level="3.4" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalancescheduling"><i class="fa fa-check"></i><b>3.4</b> Process scheduling</a></li>
<li class="chapter" data-level="3.5" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceinputsoutputs"><i class="fa fa-check"></i><b>3.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#soil-vegetation-and-meteorology"><i class="fa fa-check"></i><b>3.5.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="3.5.2" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwatervegetationparameters"><i class="fa fa-check"></i><b>3.5.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="3.5.3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalancecontrol"><i class="fa fa-check"></i><b>3.5.3</b> Control parameters</a></li>
<li class="chapter" data-level="3.5.4" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceoutput"><i class="fa fa-check"></i><b>3.5.4</b> Model output</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceapplications"><i class="fa fa-check"></i><b>3.6</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="leafphenologylight.html"><a href="leafphenologylight.html"><i class="fa fa-check"></i><b>4</b> Leaf phenology and radiation extinction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenology"><i class="fa fa-check"></i><b>4.1</b> Leaf phenology</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="leafphenologylight.html"><a href="leafphenologylight.html#phenological-types-and-leaf-expanded-area"><i class="fa fa-check"></i><b>4.1.1</b> Phenological types and leaf expanded area</a></li>
<li class="chapter" data-level="4.1.2" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenobudburst"><i class="fa fa-check"></i><b>4.1.2</b> Bud burst and leaf unfolding</a></li>
<li class="chapter" data-level="4.1.3" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenosenescence"><i class="fa fa-check"></i><b>4.1.3</b> Leaf senescence</a></li>
<li class="chapter" data-level="4.1.4" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leaf-abscission"><i class="fa fa-check"></i><b>4.1.4</b> Leaf abscission</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="leafphenologylight.html"><a href="leafphenologylight.html#basiclightextinction"><i class="fa fa-check"></i><b>4.2</b> Radiation extinction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hydrology.html"><a href="hydrology.html"><i class="fa fa-check"></i><b>5</b> Forest hydrology</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hydrology.html"><a href="hydrology.html#precipitation"><i class="fa fa-check"></i><b>5.1</b> Snow and rainfall</a></li>
<li class="chapter" data-level="5.2" data-path="hydrology.html"><a href="hydrology.html#snowpack"><i class="fa fa-check"></i><b>5.2</b> Snow pack dynamics</a></li>
<li class="chapter" data-level="5.3" data-path="hydrology.html"><a href="hydrology.html#interception"><i class="fa fa-check"></i><b>5.3</b> Rainfall interception loss</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="hydrology.html"><a href="hydrology.html#gash-1995-model"><i class="fa fa-check"></i><b>5.3.1</b> Gash (1995) model</a></li>
<li class="chapter" data-level="5.3.2" data-path="hydrology.html"><a href="hydrology.html#liu-2001-model"><i class="fa fa-check"></i><b>5.3.2</b> Liu (2001) model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hydrology.html"><a href="hydrology.html#soilevaporation"><i class="fa fa-check"></i><b>5.4</b> Bare soil evaporation</a></li>
<li class="chapter" data-level="5.5" data-path="hydrology.html"><a href="hydrology.html#herbaceoustranspiration"><i class="fa fa-check"></i><b>5.5</b> Transpiration of the herbaceous layer</a></li>
<li class="chapter" data-level="5.6" data-path="hydrology.html"><a href="hydrology.html#infiltration"><i class="fa fa-check"></i><b>5.6</b> Infiltration</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="hydrology.html"><a href="hydrology.html#boughton-1989-model"><i class="fa fa-check"></i><b>5.6.1</b> Boughton (1989) model</a></li>
<li class="chapter" data-level="5.6.2" data-path="hydrology.html"><a href="hydrology.html#green-ampt-1911-model"><i class="fa fa-check"></i><b>5.6.2</b> Green-Ampt (1911) model</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="hydrology.html"><a href="hydrology.html#soilflows"><i class="fa fa-check"></i><b>5.7</b> Soil water flows</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="hydrology.html"><a href="hydrology.html#design-of-soil-water-flows"><i class="fa fa-check"></i><b>5.7.1</b> Design of soil water flows</a></li>
<li class="chapter" data-level="5.7.2" data-path="hydrology.html"><a href="hydrology.html#darcian-flow-and-richards-equation"><i class="fa fa-check"></i><b>5.7.2</b> Darcian flow and Richards equation</a></li>
<li class="chapter" data-level="5.7.3" data-path="hydrology.html"><a href="hydrology.html#hydraulic-properties-in-the-single-domain-model"><i class="fa fa-check"></i><b>5.7.3</b> Hydraulic properties in the single-domain model</a></li>
<li class="chapter" data-level="5.7.4" data-path="hydrology.html"><a href="hydrology.html#hydraulic-properties-in-the-dual-permeability-model"><i class="fa fa-check"></i><b>5.7.4</b> Hydraulic properties in the dual-permeability model</a></li>
<li class="chapter" data-level="5.7.5" data-path="hydrology.html"><a href="hydrology.html#finite-approximation-to-flows-in-the-soil-matrix"><i class="fa fa-check"></i><b>5.7.5</b> Finite approximation to flows in the soil matrix</a></li>
<li class="chapter" data-level="5.7.6" data-path="hydrology.html"><a href="hydrology.html#finite-approximation-to-flows-in-the-macropore-domain"><i class="fa fa-check"></i><b>5.7.6</b> Finite approximation to flows in the macropore domain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transpirationgranier.html"><a href="transpirationgranier.html"><i class="fa fa-check"></i><b>6</b> Woody plant transpiration, photosynthesis and water status</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-transpiration-and-photosynthesis"><i class="fa fa-check"></i><b>6.1</b> Plant transpiration and photosynthesis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#maximumtranspiration"><i class="fa fa-check"></i><b>6.1.1</b> Maximum transpiration</a></li>
<li class="chapter" data-level="6.1.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#actualtranspiration"><i class="fa fa-check"></i><b>6.1.2</b> Actual plant transpiration and plant water potential</a></li>
<li class="chapter" data-level="6.1.3" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-water-potential"><i class="fa fa-check"></i><b>6.1.3</b> Plant water potential</a></li>
<li class="chapter" data-level="6.1.4" data-path="transpirationgranier.html"><a href="transpirationgranier.html#minimum-transpiration"><i class="fa fa-check"></i><b>6.1.4</b> Minimum transpiration</a></li>
<li class="chapter" data-level="6.1.5" data-path="transpirationgranier.html"><a href="transpirationgranier.html#transpirationpools"><i class="fa fa-check"></i><b>6.1.5</b> Transpiration with water pools</a></li>
<li class="chapter" data-level="6.1.6" data-path="transpirationgranier.html"><a href="transpirationgranier.html#basicphotosynthesis"><i class="fa fa-check"></i><b>6.1.6</b> Plant photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-drought-stress-and-cavitation"><i class="fa fa-check"></i><b>6.2</b> Plant drought stress and cavitation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#dailystressbasicwater"><i class="fa fa-check"></i><b>6.2.1</b> Daily drought stress</a></li>
<li class="chapter" data-level="6.2.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#irreversiblecavitation"><i class="fa fa-check"></i><b>6.2.2</b> Cavitation and hydraulic recovery</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Advanced water balance modelling</b></span></li>
<li class="chapter" data-level="7" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html"><i class="fa fa-check"></i><b>7</b> Advanced water balance model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#aboutsureau"><i class="fa fa-check"></i><b>7.1</b> About Sureau</a></li>
<li class="chapter" data-level="7.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advanceddesign"><i class="fa fa-check"></i><b>7.2</b> Design principles</a></li>
<li class="chapter" data-level="7.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#statevariablesadvanced"><i class="fa fa-check"></i><b>7.3</b> State variables</a></li>
<li class="chapter" data-level="7.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#waterenergybalances"><i class="fa fa-check"></i><b>7.4</b> Water and energy balances</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#water-balance"><i class="fa fa-check"></i><b>7.4.1</b> Water balance</a></li>
<li class="chapter" data-level="7.4.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#single-layer-canopy-energy-balance"><i class="fa fa-check"></i><b>7.4.2</b> Single-layer canopy energy balance</a></li>
<li class="chapter" data-level="7.4.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#multiple-layer-canopy-energy-balance"><i class="fa fa-check"></i><b>7.4.3</b> Multiple-layer canopy energy balance</a></li>
<li class="chapter" data-level="7.4.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#soil-energy-balance"><i class="fa fa-check"></i><b>7.4.4</b> Soil energy balance</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalancescheduling"><i class="fa fa-check"></i><b>7.5</b> Process scheduling</a></li>
<li class="chapter" data-level="7.6" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#inputs-and-outputs"><i class="fa fa-check"></i><b>7.6</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#soil-vegetation-and-meteorology-1"><i class="fa fa-check"></i><b>7.6.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="7.6.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwatervegetationparameters"><i class="fa fa-check"></i><b>7.6.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="7.6.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalancecontrol"><i class="fa fa-check"></i><b>7.6.3</b> Control parameters</a></li>
<li class="chapter" data-level="7.6.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalanceoutput"><i class="fa fa-check"></i><b>7.6.4</b> Model output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="subdailytemplight.html"><a href="subdailytemplight.html"><i class="fa fa-check"></i><b>8</b> Sub-daily atmospheric temperature and radiation variation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="subdailytemplight.html"><a href="subdailytemplight.html#above-canopy-air-temperature"><i class="fa fa-check"></i><b>8.1</b> Above-canopy air temperature</a></li>
<li class="chapter" data-level="8.2" data-path="subdailytemplight.html"><a href="subdailytemplight.html#directdiffuseSWR"><i class="fa fa-check"></i><b>8.2</b> Incoming diffuse and direct short-wave radiation</a></li>
<li class="chapter" data-level="8.3" data-path="subdailytemplight.html"><a href="subdailytemplight.html#longwaveatmradiation"><i class="fa fa-check"></i><b>8.3</b> Incoming long-wave radiation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="radiationbalance.html"><a href="radiationbalance.html"><i class="fa fa-check"></i><b>9</b> Radiation transfer</a>
<ul>
<li class="chapter" data-level="9.1" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiation"><i class="fa fa-check"></i><b>9.1</b> Short-wave radiation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="radiationbalance.html"><a href="radiationbalance.html#irradiancecanopy"><i class="fa fa-check"></i><b>9.1.1</b> Direct and diffuse irradiance across the canopy</a></li>
<li class="chapter" data-level="9.1.2" data-path="radiationbalance.html"><a href="radiationbalance.html#sunlitshadeleaves"><i class="fa fa-check"></i><b>9.1.2</b> Sunlit and shade leaves</a></li>
<li class="chapter" data-level="9.1.3" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiationcanopyabs"><i class="fa fa-check"></i><b>9.1.3</b> Short-wave radiation absorbed by canopy elements</a></li>
<li class="chapter" data-level="9.1.4" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiationsoilabs"><i class="fa fa-check"></i><b>9.1.4</b> Short-wave radiation absorbed by the soil</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiation"><i class="fa fa-check"></i><b>9.2</b> Long-wave radiation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiationbalance"><i class="fa fa-check"></i><b>9.2.1</b> Long-wave radiation balance by canopy layers</a></li>
<li class="chapter" data-level="9.2.2" data-path="radiationbalance.html"><a href="radiationbalance.html#net-long-wave-radiation-of-the-whole-canopy-and-the-soil"><i class="fa fa-check"></i><b>9.2.2</b> Net long-wave radiation of the whole canopy and the soil</a></li>
<li class="chapter" data-level="9.2.3" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiationcohorts"><i class="fa fa-check"></i><b>9.2.3</b> Long-wave radiation balance by plant cohorts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="planthydraulics.html"><a href="planthydraulics.html"><i class="fa fa-check"></i><b>10</b> Plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="planthydraulics.html"><a href="planthydraulics.html#hydraulicnetworks"><i class="fa fa-check"></i><b>10.1</b> Hydraulic architecture</a></li>
<li class="chapter" data-level="10.2" data-path="planthydraulics.html"><a href="planthydraulics.html#vulnerabilitycurves"><i class="fa fa-check"></i><b>10.2</b> Vulnerability curves</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="planthydraulics.html"><a href="planthydraulics.html#xylem-vulnerability-curves"><i class="fa fa-check"></i><b>10.2.1</b> Xylem vulnerability curves</a></li>
<li class="chapter" data-level="10.2.2" data-path="planthydraulics.html"><a href="planthydraulics.html#rhizosphere-vulnerability-curve"><i class="fa fa-check"></i><b>10.2.2</b> Rhizosphere vulnerability curve</a></li>
<li class="chapter" data-level="10.2.3" data-path="planthydraulics.html"><a href="planthydraulics.html#sapviscosity"><i class="fa fa-check"></i><b>10.2.3</b> Xylem sap viscosity</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="planthydraulics.html"><a href="planthydraulics.html#plantwatercontent"><i class="fa fa-check"></i><b>10.3</b> Water content of plant tissues</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="planthydraulics.html"><a href="planthydraulics.html#pressurevolumecurves"><i class="fa fa-check"></i><b>10.3.1</b> Relative water content of symplasmic tissues</a></li>
<li class="chapter" data-level="10.3.2" data-path="planthydraulics.html"><a href="planthydraulics.html#relative-water-content-of-apoplastic-tissues"><i class="fa fa-check"></i><b>10.3.2</b> Relative water content of apoplastic tissues</a></li>
<li class="chapter" data-level="10.3.3" data-path="planthydraulics.html"><a href="planthydraulics.html#averagerelativewatercontent"><i class="fa fa-check"></i><b>10.3.3</b> Average relative water content of a compartment</a></li>
<li class="chapter" data-level="10.3.4" data-path="planthydraulics.html"><a href="planthydraulics.html#lfmc"><i class="fa fa-check"></i><b>10.3.4</b> Live fuel moisture content</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="planthydraulics.html"><a href="planthydraulics.html#supplyfunctions"><i class="fa fa-check"></i><b>10.4</b> Sperry’s sub-model of plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-for-a-single-xylem-element"><i class="fa fa-check"></i><b>10.4.1</b> Supply function for a single xylem element</a></li>
<li class="chapter" data-level="10.4.2" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-two-elements-in-series"><i class="fa fa-check"></i><b>10.4.2</b> Supply function of two elements in series</a></li>
<li class="chapter" data-level="10.4.3" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-three-elements-in-series"><i class="fa fa-check"></i><b>10.4.3</b> Supply function of three elements in series</a></li>
<li class="chapter" data-level="10.4.4" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-a-root-system"><i class="fa fa-check"></i><b>10.4.4</b> Supply function of a root system</a></li>
<li class="chapter" data-level="10.4.5" data-path="planthydraulics.html"><a href="planthydraulics.html#supplycontinuum"><i class="fa fa-check"></i><b>10.4.5</b> Supply function of the soil-plant continuum</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="planthydraulics.html"><a href="planthydraulics.html#hydraulicssureau"><i class="fa fa-check"></i><b>10.5</b> Sureau’s sub-model of plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="planthydraulics.html"><a href="planthydraulics.html#constitutive-equations"><i class="fa fa-check"></i><b>10.5.1</b> Constitutive equations</a></li>
<li class="chapter" data-level="10.5.2" data-path="planthydraulics.html"><a href="planthydraulics.html#conductancessureau"><i class="fa fa-check"></i><b>10.5.2</b> Plant and soil conductances</a></li>
<li class="chapter" data-level="10.5.3" data-path="planthydraulics.html"><a href="planthydraulics.html#plant-capacitances"><i class="fa fa-check"></i><b>10.5.3</b> Plant capacitances</a></li>
<li class="chapter" data-level="10.5.4" data-path="planthydraulics.html"><a href="planthydraulics.html#cavitation-flows"><i class="fa fa-check"></i><b>10.5.4</b> Cavitation flows</a></li>
<li class="chapter" data-level="10.5.5" data-path="planthydraulics.html"><a href="planthydraulics.html#transpiration-flows"><i class="fa fa-check"></i><b>10.5.5</b> Transpiration flows</a></li>
<li class="chapter" data-level="10.5.6" data-path="planthydraulics.html"><a href="planthydraulics.html#numerical-scheme"><i class="fa fa-check"></i><b>10.5.6</b> Numerical scheme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html"><i class="fa fa-check"></i><b>11</b> Leaf/canopy photosynthesis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafenergybalancephoto"><i class="fa fa-check"></i><b>11.1</b> Leaf energy balance, gas exchange and photosynthesis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leaf-temperature"><i class="fa fa-check"></i><b>11.1.1</b> Leaf temperature</a></li>
<li class="chapter" data-level="11.1.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafVPD"><i class="fa fa-check"></i><b>11.1.2</b> Leaf vapor pressure deficit</a></li>
<li class="chapter" data-level="11.1.3" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafgasexchange"><i class="fa fa-check"></i><b>11.1.3</b> Leaf gas exchange</a></li>
<li class="chapter" data-level="11.1.4" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafphotosynthesis"><i class="fa fa-check"></i><b>11.1.4</b> Leaf photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#crownphotosynthesis"><i class="fa fa-check"></i><b>11.2</b> Crown/canopy photosynthesis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#multi-layer-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.1</b> Multi-layer canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#big-leaf-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.2</b> Big-leaf canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.3" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#sun-shade-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.3</b> Sun-shade canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.4" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#within-canopy-variation-in-environmental-conditions"><i class="fa fa-check"></i><b>11.2.4</b> Within-canopy variation in environmental conditions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html"><i class="fa fa-check"></i><b>12</b> Stomatal regulation, transpiration and photosynthesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#transpirationsperry"><i class="fa fa-check"></i><b>12.1</b> Stomatal regulation, transpiration and photosynthesis under Sperry’s sub-model</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#water-supply-function"><i class="fa fa-check"></i><b>12.1.1</b> Water supply function</a></li>
<li class="chapter" data-level="12.1.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#from-water-supply-to-sunlitshade-photosynthesis-functions"><i class="fa fa-check"></i><b>12.1.2</b> From water supply to sunlit/shade photosynthesis functions</a></li>
<li class="chapter" data-level="12.1.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatalregulation"><i class="fa fa-check"></i><b>12.1.3</b> Leaf stomatal regulation by profit maximization</a></li>
<li class="chapter" data-level="12.1.4" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#plant-level-transpiration-rates-and-plant-water-potentials"><i class="fa fa-check"></i><b>12.1.4</b> Plant-level transpiration rates and plant water potentials</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatal-regulation-transpiration-and-photosynthesis-under-sureaus-sub-model"><i class="fa fa-check"></i><b>12.2</b> Stomatal regulation, transpiration and photosynthesis under Sureau’s sub-model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#transpirationsureau"><i class="fa fa-check"></i><b>12.2.1</b> Transpiration flows</a></li>
<li class="chapter" data-level="12.2.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#cuticularconductancesureau"><i class="fa fa-check"></i><b>12.2.2</b> Cuticular conductances</a></li>
<li class="chapter" data-level="12.2.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatalconductancesureau"><i class="fa fa-check"></i><b>12.2.3</b> Stomatal conductance</a></li>
<li class="chapter" data-level="12.2.4" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#photosynthesissureau"><i class="fa fa-check"></i><b>12.2.4</b> Photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#scalingtranspirationphotosynthesis"><i class="fa fa-check"></i><b>12.3</b> Scaling of transpiration, soil water uptake and photosynthesis rates</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html"><i class="fa fa-check"></i><b>13</b> Closing energy balances</a>
<ul>
<li class="chapter" data-level="13.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#single-layer-canopy"><i class="fa fa-check"></i><b>13.1</b> Single-layer canopy</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#latent-heat"><i class="fa fa-check"></i><b>13.1.1</b> Latent heat</a></li>
<li class="chapter" data-level="13.1.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#convective-energy"><i class="fa fa-check"></i><b>13.1.2</b> Convective energy</a></li>
<li class="chapter" data-level="13.1.3" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#canopycapacitancetemperature"><i class="fa fa-check"></i><b>13.1.3</b> Canopy temperature changes</a></li>
<li class="chapter" data-level="13.1.4" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#soil-temperature-changes"><i class="fa fa-check"></i><b>13.1.4</b> Soil temperature changes</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#multi-layer-canopy"><i class="fa fa-check"></i><b>13.2</b> Multi-layer canopy</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#latent-heat-of-vaporization"><i class="fa fa-check"></i><b>13.2.1</b> Latent heat of vaporization</a></li>
<li class="chapter" data-level="13.2.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#sensible-heat-between-leaves-and-the-canopy-air-space"><i class="fa fa-check"></i><b>13.2.2</b> Sensible heat between leaves and the canopy air space</a></li>
<li class="chapter" data-level="13.2.3" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#turbulent-heat-exchange"><i class="fa fa-check"></i><b>13.2.3</b> Turbulent heat exchange</a></li>
<li class="chapter" data-level="13.2.4" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#canopy-and-soil-temperature-changes"><i class="fa fa-check"></i><b>13.2.4</b> Canopy and soil temperature changes</a></li>
<li class="chapter" data-level="13.2.5" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#within-canopy-changes-in-water-vapor-and-co_2"><i class="fa fa-check"></i><b>13.2.5</b> Within-canopy changes in water vapor and <span class="math inline">\(CO_2\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="daylevelresults.html"><a href="daylevelresults.html"><i class="fa fa-check"></i><b>14</b> Day-level results</a>
<ul>
<li class="chapter" data-level="14.1" data-path="daylevelresults.html"><a href="daylevelresults.html#daylevelphototransp"><i class="fa fa-check"></i><b>14.1</b> Photosynthesis and transpiration</a></li>
<li class="chapter" data-level="14.2" data-path="daylevelresults.html"><a href="daylevelresults.html#plant-water-potentials-and-relative-water-contents"><i class="fa fa-check"></i><b>14.2</b> Plant water potentials and relative water contents</a></li>
<li class="chapter" data-level="14.3" data-path="daylevelresults.html"><a href="daylevelresults.html#advanceddroughtstress"><i class="fa fa-check"></i><b>14.3</b> Plant drought stress</a></li>
<li class="chapter" data-level="14.4" data-path="daylevelresults.html"><a href="daylevelresults.html#cavitationRecovery"><i class="fa fa-check"></i><b>14.4</b> Cavitation and conduit refilling</a></li>
</ul></li>
<li class="part"><span><b>IV Forest growth modelling</b></span></li>
<li class="chapter" data-level="15" data-path="growthmodelling.html"><a href="growthmodelling.html"><i class="fa fa-check"></i><b>15</b> Forest growth model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="growthmodelling.html"><a href="growthmodelling.html#growthdesign"><i class="fa fa-check"></i><b>15.1</b> Design principles</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="growthmodelling.html"><a href="growthmodelling.html#overview"><i class="fa fa-check"></i><b>15.1.1</b> Overview</a></li>
<li class="chapter" data-level="15.1.2" data-path="growthmodelling.html"><a href="growthmodelling.html#carbon-compartments-transport-and-carbon-balance"><i class="fa fa-check"></i><b>15.1.2</b> Carbon compartments, transport and carbon balance</a></li>
<li class="chapter" data-level="15.1.3" data-path="growthmodelling.html"><a href="growthmodelling.html#tissue-growth-senescence-and-allocation"><i class="fa fa-check"></i><b>15.1.3</b> Tissue growth, senescence and allocation</a></li>
<li class="chapter" data-level="15.1.4" data-path="growthmodelling.html"><a href="growthmodelling.html#carbonwaterlinks"><i class="fa fa-check"></i><b>15.1.4</b> Coordination between water and carbon balances</a></li>
<li class="chapter" data-level="15.1.5" data-path="growthmodelling.html"><a href="growthmodelling.html#mortalitydesign"><i class="fa fa-check"></i><b>15.1.5</b> Plant mortality</a></li>
<li class="chapter" data-level="15.1.6" data-path="growthmodelling.html"><a href="growthmodelling.html#fireseveritydesign"><i class="fa fa-check"></i><b>15.1.6</b> Fire occurrence and severity</a></li>
<li class="chapter" data-level="15.1.7" data-path="growthmodelling.html"><a href="growthmodelling.html#tree-diameter-tree-height-and-shrub-cover-updates"><i class="fa fa-check"></i><b>15.1.7</b> Tree diameter, tree height and shrub cover updates</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="growthmodelling.html"><a href="growthmodelling.html#state-variables"><i class="fa fa-check"></i><b>15.2</b> State variables</a></li>
<li class="chapter" data-level="15.3" data-path="growthmodelling.html"><a href="growthmodelling.html#mass-and-energy-balances"><i class="fa fa-check"></i><b>15.3</b> Mass and energy balances</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="growthmodelling.html"><a href="growthmodelling.html#water-and-energy-balance"><i class="fa fa-check"></i><b>15.3.1</b> Water and energy balance</a></li>
<li class="chapter" data-level="15.3.2" data-path="growthmodelling.html"><a href="growthmodelling.html#labile-carbon-balance"><i class="fa fa-check"></i><b>15.3.2</b> Labile carbon balance</a></li>
<li class="chapter" data-level="15.3.3" data-path="growthmodelling.html"><a href="growthmodelling.html#biomass-balance"><i class="fa fa-check"></i><b>15.3.3</b> Biomass balance</a></li>
<li class="chapter" data-level="15.3.4" data-path="growthmodelling.html"><a href="growthmodelling.html#stand-level-carbon-balance"><i class="fa fa-check"></i><b>15.3.4</b> Stand-level carbon balance</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="growthmodelling.html"><a href="growthmodelling.html#growthscheduling"><i class="fa fa-check"></i><b>15.4</b> Process scheduling</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="growthmodelling.html"><a href="growthmodelling.html#regular-scheduling"><i class="fa fa-check"></i><b>15.4.1</b> Regular scheduling</a></li>
<li class="chapter" data-level="15.4.2" data-path="growthmodelling.html"><a href="growthmodelling.html#advanced-scheduling"><i class="fa fa-check"></i><b>15.4.2</b> Advanced scheduling</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="growthmodelling.html"><a href="growthmodelling.html#inputs-and-outputs-1"><i class="fa fa-check"></i><b>15.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="growthmodelling.html"><a href="growthmodelling.html#soil-vegetation-and-meteorology-2"><i class="fa fa-check"></i><b>15.5.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="15.5.2" data-path="growthmodelling.html"><a href="growthmodelling.html#growthvegetationparameters"><i class="fa fa-check"></i><b>15.5.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="15.5.3" data-path="growthmodelling.html"><a href="growthmodelling.html#forestgrowthcontrol"><i class="fa fa-check"></i><b>15.5.3</b> Control parameters</a></li>
<li class="chapter" data-level="15.5.4" data-path="growthmodelling.html"><a href="growthmodelling.html#forestgrowthoutput"><i class="fa fa-check"></i><b>15.5.4</b> Model output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html"><i class="fa fa-check"></i><b>16</b> Carbon pools and components of the carbon balance</a>
<ul>
<li class="chapter" data-level="16.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#estimationcarbonpools"><i class="fa fa-check"></i><b>16.1</b> Size of carbon pools</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#leaf-structural-metabolic-and-storage-biomass"><i class="fa fa-check"></i><b>16.1.1</b> Leaf structural, metabolic and storage biomass</a></li>
<li class="chapter" data-level="16.1.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#sapwood-structural-metabolic-and-storage-biomass"><i class="fa fa-check"></i><b>16.1.2</b> Sapwood structural, metabolic and storage biomass</a></li>
<li class="chapter" data-level="16.1.3" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#fine-root-area-and-biomass"><i class="fa fa-check"></i><b>16.1.3</b> Fine root area and biomass</a></li>
<li class="chapter" data-level="16.1.4" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#total-living-biomass"><i class="fa fa-check"></i><b>16.1.4</b> Total living biomass</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#carbonbalancecomponents"><i class="fa fa-check"></i><b>16.2</b> Components of labile carbon balance</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#gross-photosynthesis"><i class="fa fa-check"></i><b>16.2.1</b> Gross photosynthesis</a></li>
<li class="chapter" data-level="16.2.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#maintenance-respiration"><i class="fa fa-check"></i><b>16.2.2</b> Maintenance respiration</a></li>
<li class="chapter" data-level="16.2.3" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#growth-respiration"><i class="fa fa-check"></i><b>16.2.3</b> Growth respiration</a></li>
<li class="chapter" data-level="16.2.4" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#phloemtransport"><i class="fa fa-check"></i><b>16.2.4</b> Phloem transport</a></li>
<li class="chapter" data-level="16.2.5" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#sugarstarchdynamics"><i class="fa fa-check"></i><b>16.2.5</b> Sugar-starch dynamics</a></li>
<li class="chapter" data-level="16.2.6" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#root-exudation"><i class="fa fa-check"></i><b>16.2.6</b> Root exudation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html"><i class="fa fa-check"></i><b>17</b> Growth, senescence and mortality</a>
<ul>
<li class="chapter" data-level="17.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#growth"><i class="fa fa-check"></i><b>17.1</b> Growth</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#temperature-and-turgor-sink-limitations"><i class="fa fa-check"></i><b>17.1.1</b> Temperature and turgor sink limitations</a></li>
<li class="chapter" data-level="17.1.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#leafgrowth"><i class="fa fa-check"></i><b>17.1.2</b> Leaf growth</a></li>
<li class="chapter" data-level="17.1.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#sapwoodgrowth"><i class="fa fa-check"></i><b>17.1.3</b> Sapwood growth</a></li>
<li class="chapter" data-level="17.1.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#finerootgrowth"><i class="fa fa-check"></i><b>17.1.4</b> Fine root growth</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#senescence"><i class="fa fa-check"></i><b>17.2</b> Senescence</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#leafsenescence"><i class="fa fa-check"></i><b>17.2.1</b> Leaf senescence and cavitation effects on leaves and buds</a></li>
<li class="chapter" data-level="17.2.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#sapwoodsenescence"><i class="fa fa-check"></i><b>17.2.2</b> Sapwood senescence</a></li>
<li class="chapter" data-level="17.2.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#finerootsenescence"><i class="fa fa-check"></i><b>17.2.3</b> Fine root senescence</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#update-of-plant-traits-and-allocation-targets"><i class="fa fa-check"></i><b>17.3</b> Update of plant traits and allocation targets</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#updateplanttraits"><i class="fa fa-check"></i><b>17.3.1</b> Plant traits</a></li>
<li class="chapter" data-level="17.3.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#updateallocationtargets"><i class="fa fa-check"></i><b>17.3.2</b> Leaf area and fine root biomass targets</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#plantmortality"><i class="fa fa-check"></i><b>17.4</b> Plant mortality</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#selfthinning"><i class="fa fa-check"></i><b>17.4.1</b> Self-thinning of small trees</a></li>
<li class="chapter" data-level="17.4.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#basalmortality"><i class="fa fa-check"></i><b>17.4.2</b> Basal mortality rates</a></li>
<li class="chapter" data-level="17.4.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#starvationmortality"><i class="fa fa-check"></i><b>17.4.3</b> Mortality due to starvation</a></li>
<li class="chapter" data-level="17.4.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#dessicationmortality"><i class="fa fa-check"></i><b>17.4.4</b> Mortality due to dessication</a></li>
<li class="chapter" data-level="17.4.5" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#overall-mortality-probability"><i class="fa fa-check"></i><b>17.4.5</b> Overall mortality probability</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#fireseverity"><i class="fa fa-check"></i><b>17.5</b> Fire severity</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#plume-temperature-distribution"><i class="fa fa-check"></i><b>17.5.1</b> Plume temperature distribution</a></li>
<li class="chapter" data-level="17.5.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#foliage-and-crown-bud-necrosis"><i class="fa fa-check"></i><b>17.5.2</b> Foliage and crown bud necrosis</a></li>
<li class="chapter" data-level="17.5.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#cambium-necrosis"><i class="fa fa-check"></i><b>17.5.3</b> Cambium necrosis</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#structuralupdate"><i class="fa fa-check"></i><b>17.6</b> Update of structural variables</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#tree-diameter-height-and-crown-ratio"><i class="fa fa-check"></i><b>17.6.1</b> Tree diameter, height and crown ratio</a></li>
<li class="chapter" data-level="17.6.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#shrub-height-and-cover"><i class="fa fa-check"></i><b>17.6.2</b> Shrub height and cover</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Forest dynamics modelling</b></span></li>
<li class="chapter" data-level="18" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html"><i class="fa fa-check"></i><b>18</b> Forest dynamics model</a>
<ul>
<li class="chapter" data-level="18.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#design-principles"><i class="fa fa-check"></i><b>18.1</b> Design principles</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#recruitment-from-seeds"><i class="fa fa-check"></i><b>18.1.1</b> Recruitment from seeds</a></li>
<li class="chapter" data-level="18.1.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#resprouting"><i class="fa fa-check"></i><b>18.1.2</b> Resprouting</a></li>
<li class="chapter" data-level="18.1.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forest-management"><i class="fa fa-check"></i><b>18.1.3</b> Forest management</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#state-variables-1"><i class="fa fa-check"></i><b>18.2</b> State variables</a></li>
<li class="chapter" data-level="18.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#process-scheduling"><i class="fa fa-check"></i><b>18.3</b> Process scheduling</a></li>
<li class="chapter" data-level="18.4" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#inputs-and-outputs-2"><i class="fa fa-check"></i><b>18.4</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#soil-vegetation-and-meteorology-3"><i class="fa fa-check"></i><b>18.4.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="18.4.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#vegetation-functional-parameters"><i class="fa fa-check"></i><b>18.4.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="18.4.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forestdynamicscontrol"><i class="fa fa-check"></i><b>18.4.3</b> Control parameters</a></li>
<li class="chapter" data-level="18.4.4" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forestdynamicsoutput"><i class="fa fa-check"></i><b>18.4.4</b> Model output</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#process-details"><i class="fa fa-check"></i><b>18.5</b> Process details</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#seedbankdynamics"><i class="fa fa-check"></i><b>18.5.1</b> Seed production and seed bank dynamics</a></li>
<li class="chapter" data-level="18.5.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#recruitment-from-seeds-1"><i class="fa fa-check"></i><b>18.5.2</b> Recruitment from seeds</a></li>
<li class="chapter" data-level="18.5.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#resprouting-1"><i class="fa fa-check"></i><b>18.5.3</b> Resprouting</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Landscape/regional modelling</b></span></li>
<li class="chapter" data-level="19" data-path="watershedhydrology.html"><a href="watershedhydrology.html"><i class="fa fa-check"></i><b>19</b> Watershed hydrology</a>
<ul>
<li class="chapter" data-level="19.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#design-principles-1"><i class="fa fa-check"></i><b>19.1</b> Design principles</a></li>
<li class="chapter" data-level="19.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#statevariableswatershed"><i class="fa fa-check"></i><b>19.2</b> State variables</a></li>
<li class="chapter" data-level="19.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalance"><i class="fa fa-check"></i><b>19.3</b> Water balance</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#cell-level-water-balance"><i class="fa fa-check"></i><b>19.3.1</b> Cell level water balance</a></li>
<li class="chapter" data-level="19.3.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershed-water-balance"><i class="fa fa-check"></i><b>19.3.2</b> Watershed water balance</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancescheduling"><i class="fa fa-check"></i><b>19.4</b> Process scheduling</a></li>
<li class="chapter" data-level="19.5" data-path="watershedhydrology.html"><a href="watershedhydrology.html#inputs-and-outputs-3"><i class="fa fa-check"></i><b>19.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#gridded-inputs"><i class="fa fa-check"></i><b>19.5.1</b> Gridded inputs</a></li>
<li class="chapter" data-level="19.5.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershed-meteorology-input"><i class="fa fa-check"></i><b>19.5.2</b> Watershed meteorology input</a></li>
<li class="chapter" data-level="19.5.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancecontrol"><i class="fa fa-check"></i><b>19.5.3</b> Watershed hydraulic control parameters</a></li>
<li class="chapter" data-level="19.5.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalanceoutput"><i class="fa fa-check"></i><b>19.5.4</b> Model outputs</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancedetails"><i class="fa fa-check"></i><b>19.6</b> Process details</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#subsurfaceflows"><i class="fa fa-check"></i><b>19.6.1</b> Soil and groundwater lateral fluxes</a></li>
<li class="chapter" data-level="19.6.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#overlandflows"><i class="fa fa-check"></i><b>19.6.2</b> Overland runoff</a></li>
<li class="chapter" data-level="19.6.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedexport"><i class="fa fa-check"></i><b>19.6.3</b> Channel routing and water exported from the watershed</a></li>
<li class="chapter" data-level="19.6.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#deepaquiferloss"><i class="fa fa-check"></i><b>19.6.4</b> Losses towards a deeper aquifer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="seeddispersal.html"><a href="seeddispersal.html"><i class="fa fa-check"></i><b>20</b> Seed dispersal</a>
<ul>
<li class="chapter" data-level="20.1" data-path="seeddispersal.html"><a href="seeddispersal.html#design-principles-2"><i class="fa fa-check"></i><b>20.1</b> Design principles</a></li>
<li class="chapter" data-level="20.2" data-path="seeddispersal.html"><a href="seeddispersal.html#process-scheduling-1"><i class="fa fa-check"></i><b>20.2</b> Process scheduling</a></li>
<li class="chapter" data-level="20.3" data-path="seeddispersal.html"><a href="seeddispersal.html#process-details-1"><i class="fa fa-check"></i><b>20.3</b> Process details</a></li>
</ul></li>
<li class="part"><span><b>VII Static modules</b></span></li>
<li class="chapter" data-level="21" data-path="allometricmodels.html"><a href="allometricmodels.html"><i class="fa fa-check"></i><b>21</b> Allometric models</a>
<ul>
<li class="chapter" data-level="21.1" data-path="allometricmodels.html"><a href="allometricmodels.html#input-data"><i class="fa fa-check"></i><b>21.1</b> Input data</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="allometricmodels.html"><a href="allometricmodels.html#forest-plot-data"><i class="fa fa-check"></i><b>21.1.1</b> Forest plot data</a></li>
<li class="chapter" data-level="21.1.2" data-path="allometricmodels.html"><a href="allometricmodels.html#species-parameters"><i class="fa fa-check"></i><b>21.1.2</b> Species parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="allometricmodels.html"><a href="allometricmodels.html#allometric-relationships"><i class="fa fa-check"></i><b>21.2</b> Allometric relationships</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="allometricmodels.html"><a href="allometricmodels.html#leaf-biomass"><i class="fa fa-check"></i><b>21.2.1</b> Leaf biomass</a></li>
<li class="chapter" data-level="21.2.2" data-path="allometricmodels.html"><a href="allometricmodels.html#leaf-area-and-lai"><i class="fa fa-check"></i><b>21.2.2</b> Leaf area and LAI</a></li>
<li class="chapter" data-level="21.2.3" data-path="allometricmodels.html"><a href="allometricmodels.html#crownbaseheight"><i class="fa fa-check"></i><b>21.2.3</b> Crown vertical dimensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="post-simulation-procedures.html"><a href="post-simulation-procedures.html"><i class="fa fa-check"></i><b>22</b> Post-simulation procedures</a>
<ul>
<li class="chapter" data-level="22.1" data-path="post-simulation-procedures.html"><a href="post-simulation-procedures.html#water-use-efficiency"><i class="fa fa-check"></i><b>22.1</b> Water use efficiency</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="windextinction.html"><a href="windextinction.html"><i class="fa fa-check"></i><b>23</b> Wind extinction</a>
<ul>
<li class="chapter" data-level="23.1" data-path="windextinction.html"><a href="windextinction.html#wind-speed-at-the-top-of-the-canopy"><i class="fa fa-check"></i><b>23.1</b> Wind speed at the top of the canopy</a></li>
<li class="chapter" data-level="23.2" data-path="windextinction.html"><a href="windextinction.html#windextinctionprofile"><i class="fa fa-check"></i><b>23.2</b> Wind extinction profile</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html"><i class="fa fa-check"></i><b>24</b> Fuel characteristics and fire behaviour</a>
<ul>
<li class="chapter" data-level="24.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#overview-1"><i class="fa fa-check"></i><b>24.1</b> Overview</a></li>
<li class="chapter" data-level="24.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#input-data-1"><i class="fa fa-check"></i><b>24.2</b> Input data</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#forest-plot-data-1"><i class="fa fa-check"></i><b>24.2.1</b> Forest plot data</a></li>
<li class="chapter" data-level="24.2.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#species-parameters-1"><i class="fa fa-check"></i><b>24.2.2</b> Species parameters</a></li>
<li class="chapter" data-level="24.2.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#other-inputs"><i class="fa fa-check"></i><b>24.2.3</b> Other inputs</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-characteristics"><i class="fa fa-check"></i><b>24.3</b> Fuel characteristics</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-strata"><i class="fa fa-check"></i><b>24.3.1</b> Fuel strata</a></li>
<li class="chapter" data-level="24.3.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#cohort-fuel-loading"><i class="fa fa-check"></i><b>24.3.2</b> Cohort fuel loading</a></li>
<li class="chapter" data-level="24.3.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#vertical-distribution-of-cohort-fuels"><i class="fa fa-check"></i><b>24.3.3</b> Vertical distribution of cohort fuels</a></li>
<li class="chapter" data-level="24.3.4" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-bulk-density-profile"><i class="fa fa-check"></i><b>24.3.4</b> Fuel bulk density profile</a></li>
<li class="chapter" data-level="24.3.5" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-loading-w-and-fuel-depth-delta"><i class="fa fa-check"></i><b>24.3.5</b> Fuel loading (<span class="math inline">\(w\)</span>) and fuel depth (<span class="math inline">\(\delta\)</span>)</a></li>
<li class="chapter" data-level="24.3.6" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#other-fuel-characteristics"><i class="fa fa-check"></i><b>24.3.6</b> Other fuel characteristics</a></li>
<li class="chapter" data-level="24.3.7" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#unit-conversion-of-fuel-characteristics"><i class="fa fa-check"></i><b>24.3.7</b> Unit conversion of fuel characteristics</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-fire-behavior"><i class="fa fa-check"></i><b>24.4</b> Surface fire behavior</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-rate-of-spread-r"><i class="fa fa-check"></i><b>24.4.1</b> Surface rate of spread (<span class="math inline">\(R\)</span>)</a></li>
<li class="chapter" data-level="24.4.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#heat-sink-q"><i class="fa fa-check"></i><b>24.4.2</b> Heat sink (<span class="math inline">\(q\)</span>)</a></li>
<li class="chapter" data-level="24.4.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fireline-intensity-i_b-and-flame-length-fl"><i class="fa fa-check"></i><b>24.4.3</b> Fireline intensity (<span class="math inline">\(I_B\)</span>) and flame length (<span class="math inline">\(FL\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#crown-fire-behavior"><i class="fa fa-check"></i><b>24.5</b> Crown fire behavior</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#canopy-reaction-intensity-i_r-ca"><i class="fa fa-check"></i><b>24.5.1</b> Canopy reaction intensity (<span class="math inline">\(I_{R, ca}\)</span>)</a></li>
<li class="chapter" data-level="24.5.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#canopy-heat-sink-q_ca"><i class="fa fa-check"></i><b>24.5.2</b> Canopy heat sink (<span class="math inline">\(q_{ca}\)</span>)</a></li>
<li class="chapter" data-level="24.5.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fireline-intensity-i_bcrown-and-flame-length-fl_crown"><i class="fa fa-check"></i><b>24.5.3</b> Fireline intensity (<span class="math inline">\(I_{B,crown}\)</span>) and flame length (<span class="math inline">\(FL_{crown}\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fire-potentials"><i class="fa fa-check"></i><b>24.6</b> Fire potentials</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-fire-behavior-potentials"><i class="fa fa-check"></i><b>24.6.1</b> Surface fire behavior potentials</a></li>
<li class="chapter" data-level="24.6.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#crown-fire-behavior-potentials"><i class="fa fa-check"></i><b>24.6.2</b> Crown fire behavior potentials</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#unit-conversion-of-outputs"><i class="fa fa-check"></i><b>24.7</b> Unit conversion of outputs</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="modelparametrization.html"><a href="modelparametrization.html"><i class="fa fa-check"></i><b>A</b> Inbuilt parameter estimation</a>
<ul>
<li class="chapter" data-level="A.1" data-path="modelparametrization.html"><a href="modelparametrization.html#introduction"><i class="fa fa-check"></i><b>A.1</b> Introduction</a></li>
<li class="chapter" data-level="A.2" data-path="modelparametrization.html"><a href="modelparametrization.html#strict-scaled-and-imputable-parameters"><i class="fa fa-check"></i><b>A.2</b> Strict, scaled and imputable parameters</a></li>
<li class="chapter" data-level="A.3" data-path="modelparametrization.html"><a href="modelparametrization.html#imputation-of-missing-values"><i class="fa fa-check"></i><b>A.3</b> Imputation of missing values</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRootingDepth"><i class="fa fa-check"></i><b>A.3.1</b> Rooting depth</a></li>
<li class="chapter" data-level="A.3.2" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationShrubAllometries"><i class="fa fa-check"></i><b>A.3.2</b> Shrub allometric coefficients</a></li>
<li class="chapter" data-level="A.3.3" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationTreeAllometries"><i class="fa fa-check"></i><b>A.3.3</b> Tree allometric coefficients</a></li>
<li class="chapter" data-level="A.3.4" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationLWSLA"><i class="fa fa-check"></i><b>A.3.4</b> Leaf width, specific leaf area and fine foliar ratio</a></li>
<li class="chapter" data-level="A.3.5" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationtissuedensity"><i class="fa fa-check"></i><b>A.3.5</b> Tissue density</a></li>
<li class="chapter" data-level="A.3.6" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationSRLRLD"><i class="fa fa-check"></i><b>A.3.6</b> Specific root length and root length density</a></li>
<li class="chapter" data-level="A.3.7" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationAl2As"><i class="fa fa-check"></i><b>A.3.7</b> Huber value and ratio of conduits to sapwood</a></li>
<li class="chapter" data-level="A.3.8" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationAr2Al"><i class="fa fa-check"></i><b>A.3.8</b> Fine root to leaf area ratio</a></li>
<li class="chapter" data-level="A.3.9" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationphenology"><i class="fa fa-check"></i><b>A.3.9</b> Leaf phenology</a></li>
<li class="chapter" data-level="A.3.10" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationtranspwue"><i class="fa fa-check"></i><b>A.3.10</b> Basic transpiration and water-use efficiency</a></li>
<li class="chapter" data-level="A.3.11" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationLEWI"><i class="fa fa-check"></i><b>A.3.11</b> Radiation balance and water interception</a></li>
<li class="chapter" data-level="A.3.12" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationstomatalconductance"><i class="fa fa-check"></i><b>A.3.12</b> Stomatal conductance</a></li>
<li class="chapter" data-level="A.3.13" data-path="modelparametrization.html"><a href="modelparametrization.html#inputationPV"><i class="fa fa-check"></i><b>A.3.13</b> Pressure-volume curves</a></li>
<li class="chapter" data-level="A.3.14" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationKstemKroot"><i class="fa fa-check"></i><b>A.3.14</b> Stem and root maximum hydraulic conductivity</a></li>
<li class="chapter" data-level="A.3.15" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationkleaf"><i class="fa fa-check"></i><b>A.3.15</b> Leaf maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.3.16" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationVCs"><i class="fa fa-check"></i><b>A.3.16</b> Xylem vulnerability</a></li>
<li class="chapter" data-level="A.3.17" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationphotosynthesis"><i class="fa fa-check"></i><b>A.3.17</b> Photosynthesis rates</a></li>
<li class="chapter" data-level="A.3.18" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRER"><i class="fa fa-check"></i><b>A.3.18</b> Maintenance respiration rates</a></li>
<li class="chapter" data-level="A.3.19" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRGR"><i class="fa fa-check"></i><b>A.3.19</b> Relative growth rates</a></li>
<li class="chapter" data-level="A.3.20" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationSR"><i class="fa fa-check"></i><b>A.3.20</b> Senescence rates</a></li>
<li class="chapter" data-level="A.3.21" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRSSG"><i class="fa fa-check"></i><b>A.3.21</b> Relative starch for sapwood growth</a></li>
<li class="chapter" data-level="A.3.22" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationCwood"><i class="fa fa-check"></i><b>A.3.22</b> Wood carbon</a></li>
<li class="chapter" data-level="A.3.23" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationMortalityBaseline"><i class="fa fa-check"></i><b>A.3.23</b> Mortality baseline rate</a></li>
<li class="chapter" data-level="A.3.24" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationrecruitment"><i class="fa fa-check"></i><b>A.3.24</b> Recruitment</a></li>
<li class="chapter" data-level="A.3.25" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationflammability"><i class="fa fa-check"></i><b>A.3.25</b> Flammability</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="modelparametrization.html"><a href="modelparametrization.html#scaling-size-related-parameters"><i class="fa fa-check"></i><b>A.4</b> Scaling size-related parameters</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkstem"><i class="fa fa-check"></i><b>A.4.1</b> Stem xylem maximum conductance</a></li>
<li class="chapter" data-level="A.4.2" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkleaf"><i class="fa fa-check"></i><b>A.4.2</b> Leaf maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.3" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkroot"><i class="fa fa-check"></i><b>A.4.3</b> Root xylem maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.4" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkrhizo"><i class="fa fa-check"></i><b>A.4.4</b> Rhizosphere maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.5" data-path="modelparametrization.html"><a href="modelparametrization.html#plantwaterstoragecapacity"><i class="fa fa-check"></i><b>A.4.5</b> Plant water storage capacity</a></li>
<li class="chapter" data-level="A.4.6" data-path="modelparametrization.html"><a href="modelparametrization.html#horizontalrootoverlap"><i class="fa fa-check"></i><b>A.4.6</b> Horizontal root overlap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="symbols.html"><a href="symbols.html"><i class="fa fa-check"></i><b>B</b> Symbols</a>
<ul>
<li class="chapter" data-level="B.1" data-path="symbols.html"><a href="symbols.html#dimensions"><i class="fa fa-check"></i><b>B.1</b> Dimensions</a></li>
<li class="chapter" data-level="B.2" data-path="symbols.html"><a href="symbols.html#soils"><i class="fa fa-check"></i><b>B.2</b> Soils</a></li>
<li class="chapter" data-level="B.3" data-path="symbols.html"><a href="symbols.html#plantleaf-classification"><i class="fa fa-check"></i><b>B.3</b> Plant/leaf classification</a></li>
<li class="chapter" data-level="B.4" data-path="symbols.html"><a href="symbols.html#vegetation"><i class="fa fa-check"></i><b>B.4</b> Vegetation</a></li>
<li class="chapter" data-level="B.5" data-path="symbols.html"><a href="symbols.html#meteorology"><i class="fa fa-check"></i><b>B.5</b> Meteorology</a></li>
<li class="chapter" data-level="B.6" data-path="symbols.html"><a href="symbols.html#anatomy"><i class="fa fa-check"></i><b>B.6</b> Anatomy</a></li>
<li class="chapter" data-level="B.7" data-path="symbols.html"><a href="symbols.html#radiation"><i class="fa fa-check"></i><b>B.7</b> Radiation</a></li>
<li class="chapter" data-level="B.8" data-path="symbols.html"><a href="symbols.html#water-balance-1"><i class="fa fa-check"></i><b>B.8</b> Water balance</a></li>
<li class="chapter" data-level="B.9" data-path="symbols.html"><a href="symbols.html#energy-balance"><i class="fa fa-check"></i><b>B.9</b> Energy balance</a></li>
<li class="chapter" data-level="B.10" data-path="symbols.html"><a href="symbols.html#forest-hydrology"><i class="fa fa-check"></i><b>B.10</b> Forest hydrology</a></li>
<li class="chapter" data-level="B.11" data-path="symbols.html"><a href="symbols.html#plant-hydraulics"><i class="fa fa-check"></i><b>B.11</b> Plant hydraulics</a></li>
<li class="chapter" data-level="B.12" data-path="symbols.html"><a href="symbols.html#photosynthesis"><i class="fa fa-check"></i><b>B.12</b> Photosynthesis</a></li>
<li class="chapter" data-level="B.13" data-path="symbols.html"><a href="symbols.html#plant-water-content"><i class="fa fa-check"></i><b>B.13</b> Plant water content</a></li>
<li class="chapter" data-level="B.14" data-path="symbols.html"><a href="symbols.html#stomatal-regulation"><i class="fa fa-check"></i><b>B.14</b> Stomatal regulation</a></li>
<li class="chapter" data-level="B.15" data-path="symbols.html"><a href="symbols.html#carbon-pools"><i class="fa fa-check"></i><b>B.15</b> Carbon pools</a></li>
<li class="chapter" data-level="B.16" data-path="symbols.html"><a href="symbols.html#carbon-balance"><i class="fa fa-check"></i><b>B.16</b> Carbon balance</a></li>
<li class="chapter" data-level="B.17" data-path="symbols.html"><a href="symbols.html#growth-senescence-and-mortality"><i class="fa fa-check"></i><b>B.17</b> Growth, senescence and mortality</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The medfate reference book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hydrology" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Forest hydrology<a href="hydrology.html#hydrology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Forest hydrological processes are key for soil and plant water balances. This chapter details the design and implementation of most of the vertical hydrological processes included in package <strong>medfate</strong>. These processes determine the value of the water flows mentioned in eq. <a href="basicwaterbalance.html#eq:basicwaterbalanceequation">(3.3)</a>. The only process that is not described here is woody plant transpiration (<span class="math inline">\(Tr_w\)</span>), as it will be covered in detail in chapter <a href="transpirationgranier.html#transpirationgranier">6</a>.</p>
<p>Although each process can be simulated in specific sub-model functions, function <code>hydrology_verticalInputs()</code> allows simulating soil water input processes altogether, including canopy water interception, snow accumulation/melt, soil infiltration and percolation.</p>
<div id="precipitation" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Snow and rainfall<a href="hydrology.html#precipitation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Precipitation (<span class="math inline">\(P\)</span>) is considered be snow precipitation (<span class="math inline">\(Ps\)</span>) when <span class="math inline">\(T_{mean}&lt;0\)</span>, and is considered rainfall (<span class="math inline">\(Pr\)</span>) otherwise. Thus, we have:
<span class="math display">\[\begin{equation}
P = Pr + Ps
\end{equation}\]</span></p>
<p>Interception of snow by the canopy is neglected, and all snow is assumed to accumulate in a single storage compartment <span class="math inline">\(S_{snow}\)</span> over the soil (i.e. canopy snow storage capacity is neglected). Rainfall interception is described in section <a href="hydrology.html#interception">5.3</a>.</p>
</div>
<div id="snowpack" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Snow pack dynamics<a href="hydrology.html#snowpack" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A very simple snow submodel is used for snow pack dynamics (accumulation and melt), taken from <span class="citation">Kergoat (<a href="#ref-Kergoat1998">1998</a>)</span>. When mean air temperature is above 0 Celsius (<span class="math inline">\(T_{mean}&gt;0\)</span>), a simple energy budget relates snow melt, <span class="math inline">\(Sm\)</span> (mm), to air temperature and soil-level radiation (see function <code>hydrology_snowMelt()</code>):
<span class="math display">\[\begin{equation}
Sm = \frac{Rad\cdot L^{SWR}_{ground}\cdot (1-\alpha_{ice}) + \tau_{day} \cdot T_{mean} \cdot \rho_{air} \cdot C_p/r_{s}}{\lambda_{ice}}
\end{equation}\]</span>
where <span class="math inline">\(Rad\)</span> is solar radiation (<span class="math inline">\(MJ \cdot m^{-2}\)</span>), <span class="math inline">\(L^{SWR}_{ground}\)</span> is the fraction of (short-wave) radiation reaching the ground, <span class="math inline">\(\alpha_{ice} = 0.9\)</span> is the albedo of snow, <span class="math inline">\(\tau_{day} = 86400\)</span> is the day duration in seconds, <span class="math inline">\(\rho_{air}\)</span> is the air density (<span class="math inline">\(kg \cdot m^{-3}\)</span>), depending on temperature and elevation (see <a href="http://emf-creaf.github.io/meteolandbook/miscellaneous.html#physicalutils">utility functions</a> of the <strong>meteoland</strong> reference manual), <span class="math inline">\(C_{p} = 1013.86 \cdot 10^{-6}\, MJ \cdot kg^{-1} \cdot C^{-1}\)</span> is the specific heat capacity of the air and <span class="math inline">\(r_{s} = 100\,s \cdot m^{-1}\)</span> is the snow aerodynamic resistance and <span class="math inline">\(\lambda_{ice} = 0.33355\, MJ \cdot kg^{-1}\)</span> is the (latent) heat of fusion of snow.</p>
</div>
<div id="interception" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Rainfall interception loss<a href="hydrology.html#interception" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned above, interception loss is only modelled for liquid precipitation (i.e. snow interception is not modelled). Rainfall interception loss, <span class="math inline">\(In\)</span>, is estimated using either the <span class="citation">Gash <em>et al.</em> (<a href="#ref-Gash1995">1995</a>)</span> or <span class="citation">Liu (<a href="#ref-liu_evaluation_2001">2001</a>)</span> models.</p>
<div id="gash-1995-model" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Gash (1995) model<a href="hydrology.html#gash-1995-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the <span class="citation">Gash <em>et al.</em> (<a href="#ref-Gash1995">1995</a>)</span> analytical interception model for sparse canopies, rain is assumed to fall in a single event during the day. First, the amount of rainfall needed to saturate the canopy is calculated:
<span class="math display">\[\begin{equation}
P_G = - \frac{S_{canopy}/C_{canopy}}{ER_{ratio}} \cdot \ln(1-ER_{ratio})
\end{equation}\]</span>
where <span class="math inline">\(S_{canopy}\)</span> is the canopy water storage capacity (in mm) – i.e. the minimum amount of water needed to saturate the canopy –, <span class="math inline">\(C_{canopy}\)</span> is the canopy cover and <span class="math inline">\(ER_{ratio}\)</span> is the ratio of evaporation rate to rainfall intensity during the rainfall event (<span class="math inline">\(R_{int}\)</span>; in <span class="math inline">\(mm \cdot h^{-1}\)</span>). Although interception models are normally applied to single-canopy stands, we apply the sparse Gash model to the whole stand (including shrubs and the herbaceous layer). Moreover, in our implementation stem interception is lumped with crown interception, so that <span class="math inline">\(S_{canopy}\)</span> represents both.</p>
<p>Following <span class="citation">Watanabe &amp; Mizutani (<a href="#ref-Watanabe1996">1996</a>)</span> we estimate <span class="math inline">\(S_{canopy}\)</span>, the canopy water storage capacity, from adjusted LAI values:
<span class="math display">\[\begin{equation}
S_{canopy}=LAI_{herb}+\sum_{i}{s_{water,i}\cdot LAI_{i}^{\phi}}
\end{equation}\]</span>
where <span class="math inline">\(s_{water,i}\)</span> is the depth of water that can be retained by leaves, branches and stems of cohort <span class="math inline">\(i\)</span> per unit of leaf area index (<span class="math inline">\(mm \cdot LAI^{-1}\)</span>). To estimate the stand cover, <span class="math inline">\(C_{canopy}\)</span>, we use the complement of the percentage of PAR that reaches the ground, i.e. <span class="math inline">\(C_{canopy} = 1 - L^{PAR}_{ground}\)</span> <span class="citation">(<a href="#ref-Deguchi2006">Deguchi <em>et al.</em> 2006</a>)</span>.</p>
<p>The amount of water evaporated from interception (<span class="math inline">\(In\)</span>, in mm), is calculated as:
<span class="math display">\[\begin{eqnarray}
In = C_{canopy}\cdot P_G+C_{canopy}\cdot ER_{ratio}\cdot(Pr-P_G) \: {if}\: Pr &gt; P_G \\
In = C_{canopy}\cdot Pr\: {if}\: Pr \leq P_G
\end{eqnarray}\]</span>
where <span class="math inline">\(Pr\)</span> is the daily gross rainfall (in mm). Net rainfall (<span class="math inline">\(Pr_{net}\)</span>, also in mm) includes throughfall and stemflow, and is calculated as the difference between gross rainfall and interception loss. Fig. <a href="hydrology.html#fig:interceptionGash">5.1</a> below shows examples of relative throughfall (including stemflow), calculated according to the Gash et al <span class="citation">(<a href="#ref-Gash1995">1995</a>)</span> interception model, under different situations (see function <code>hydrology_rainInterception()</code>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:interceptionGash"></span>
<img src="medfatebook_files/figure-html/interceptionGash-1.png" alt="Examples of canopy interception with different \(S_{canopy}\) (canopy water storage capacity), \(ER_{ratio}\) (ratio between evaporation and rainfall rates) and \(p\) (throughfall coefficient; \(p = 1 - C_{canopy}\)), using the Gash (1995) model." width="768" />
<p class="caption">
Figure 5.1: Examples of canopy interception with different <span class="math inline">\(S_{canopy}\)</span> (canopy water storage capacity), <span class="math inline">\(ER_{ratio}\)</span> (ratio between evaporation and rainfall rates) and <span class="math inline">\(p\)</span> (throughfall coefficient; <span class="math inline">\(p = 1 - C_{canopy}\)</span>), using the Gash (1995) model.
</p>
</div>
</div>
<div id="liu-2001-model" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Liu (2001) model<a href="hydrology.html#liu-2001-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the single-storm form of the <span class="citation">Liu (<a href="#ref-liu_evaluation_2001">2001</a>)</span> model is similar to the <span class="citation">Gash <em>et al.</em> (<a href="#ref-Gash1995">1995</a>)</span> model in terms of its inputs. Rainfall interception during a single storm can be predicted by gross rainfall amount <span class="math inline">\(P_G\)</span>, the ratio of evaporation rate to rainfall rate during the rainfall event, <span class="math inline">\(ER_{ratio}\)</span>, canopy gap fraction (<span class="math inline">\(C_{canopy}\)</span>) and storage capacity (<span class="math inline">\(S_{canopy}\)</span>):</p>
<p><span class="math display">\[\begin{equation}
In = S_{canopy} \cdot \left[ 1.0 - \exp\left(-P_G \cdot \left( \frac{C_{canopy}} {S_{canopy}} \right) \right) \right] \cdot (1.0 - (ER/C_{canopy})) + (ER\cdot P_G)
\end{equation}\]</span></p>
<p>Fig. <a href="hydrology.html#fig:interceptionLiu">5.2</a> below shows examples of relative throughfall (including stemflow), calculated according to the Liu et al <span class="citation">(<a href="#ref-liu_evaluation_2001">2001</a>)</span> interception model, under different situations (see function <code>hydrology_rainInterception()</code>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:interceptionLiu"></span>
<img src="medfatebook_files/figure-html/interceptionLiu-1.png" alt="Examples of canopy interception with different \(S_{canopy}\) (canopy water storage capacity), \(ER_{ratio}\) (ratio between evaporation and rainfall rates) and \(p\) (throughfall coefficient; \(p = 1 - C_{canopy}\)), using the Liu (2001) model." width="768" />
<p class="caption">
Figure 5.2: Examples of canopy interception with different <span class="math inline">\(S_{canopy}\)</span> (canopy water storage capacity), <span class="math inline">\(ER_{ratio}\)</span> (ratio between evaporation and rainfall rates) and <span class="math inline">\(p\)</span> (throughfall coefficient; <span class="math inline">\(p = 1 - C_{canopy}\)</span>), using the Liu (2001) model.
</p>
</div>
</div>
</div>
<div id="soilevaporation" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Bare soil evaporation<a href="hydrology.html#soilevaporation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evaporation from the soil surface is the last component of the soil water balance to be calculated before calculating plant transpiration. Bare soil evaporation cannot happen if there is snow over the soil surface (i.e., if <span class="math inline">\(S_{snow}&gt;0\)</span>).</p>
<p>Potential evaporation from the soil (<span class="math inline">\(PE_{soil}\)</span>; in <span class="math inline">\(mm \cdot day^{-1}\)</span>) is defined as the product between <span class="math inline">\(PET\)</span> and <span class="math inline">\(L^{SWR}_{ground}\)</span>, the proportion of SWR absorbed by the ground:
<span class="math display">\[\begin{equation}
PE_{soil} =  PET \cdot L^{SWR}_{ground}
\end{equation}\]</span></p>
<p>Actual evaporation from the soil surface is modeled as in <span class="citation">Mouillot <em>et al.</em> (<a href="#ref-Mouillot2001">2001</a>)</span>, who in turn followed <span class="citation">Ritchie (<a href="#ref-Ritchie1972">1972</a>)</span>. First, the model determines <span class="math inline">\(t_{soil}\)</span>, the time needed to evaporate the current water deficit (difference between field capacity and current moisture) in the surface soil layer:
<span class="math display">\[\begin{equation}
t_{soil} = \left \{ \frac{V_{fc,1}\cdot(1- W_1)}{\gamma_{soil}} \right \}
\end{equation}\]</span>
where <span class="math inline">\(V_{fc,1}\)</span> is the water retention capacity of layer 1, <span class="math inline">\(W_1\)</span> is the proportion of moisture in relation to field capacity of layer 1 and <span class="math inline">\(\gamma_{soil}\)</span> is the maximum daily evaporation (<span class="math inline">\(mm \cdot day^{-1}\)</span>). The calculated time is used to determine the ‘supplied’ evaporation, <span class="math inline">\(SE_{soil}\)</span>:
<span class="math display">\[\begin{equation}
SE_{soil} = \gamma_{soil} \cdot (\sqrt{t_{soil}+1}-\sqrt{1})
\end{equation}\]</span>
The amount of water actually evaporated from the soil, <span class="math inline">\(Es\)</span>, is then calculated as the minimum between supply, <span class="math inline">\(SE_{soil}\)</span>, and demand <span class="citation">(<a href="#ref-Federer1982">Federer 1982</a>)</span>, i.e. <span class="math inline">\(PE_{soil}\)</span> (see function <code>hydrology_soilEvaporationAmount</code>):</p>
<p><span class="math display">\[\begin{equation}
Es = \min(PE_{soil}, SE_{soil})
\end{equation}\]</span></p>
<p>Figure <a href="hydrology.html#fig:soilevaporation">5.3</a> shows the cumulative evaporation from soils for different values of maximum evaporation rate.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soilevaporation"></span>
<img src="medfatebook_files/figure-html/soilevaporation-1.png" alt="Cumulative bare soil evaporation for different values of maximum evaporation rate (\(\gamma_{soil}\)). Topsoil layer (0 – 30 cm) is initialized at field capacity (\(V_1 = 50 mm\)). \(PE_{soil}\) was assumed not to be limiting." width="480" />
<p class="caption">
Figure 5.3: Cumulative bare soil evaporation for different values of maximum evaporation rate (<span class="math inline">\(\gamma_{soil}\)</span>). Topsoil layer (0 – 30 cm) is initialized at field capacity (<span class="math inline">\(V_1 = 50 mm\)</span>). <span class="math inline">\(PE_{soil}\)</span> was assumed not to be limiting.
</p>
</div>
</div>
<div id="herbaceoustranspiration" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Transpiration of the herbaceous layer<a href="hydrology.html#herbaceoustranspiration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Transpiration of herbaceous layer is modelled analogously to the transpiration of woody plants. First, potential evapotranspiration from the herbaceous layer (<span class="math inline">\(PET_{herb}\)</span>; in <span class="math inline">\(mm \cdot day^{-1}\)</span>) is defined as the product between <span class="math inline">\(PET\)</span> and <span class="math inline">\(L^{SWR}_{herb}\)</span>, the proportion of SWR reaching the herbaceous layer:
<span class="math display">\[\begin{equation}
PET_{herb} =  PET \cdot L^{SWR}_{herb}
\end{equation}\]</span>
Thus, the more dense the woody plant canopy, the lower herbaceous transpiration will be. Maximum herbaceous transpiration <span class="math inline">\(Tr_{herb, \max}\)</span> depends on both <span class="math inline">\(PET_{herb}\)</span> and the amount of transpiring surface, i.e. <span class="math inline">\(LAI_{herb}\)</span>. To estimate <span class="math inline">\(Tr_{\max}\)</span> the model uses the empirical equation of <span class="citation">Granier <em>et al.</em> (<a href="#ref-Granier1999">1999</a>)</span>, as in section <a href="transpirationgranier.html#maximumtranspiration">6.1.1</a>:
<span class="math display">\[\begin{equation}
\frac{Tr_{herb,\max}}{PET}= -0.006\cdot (LAI_{herb})^2+0.134\cdot LAI_{herb}
\end{equation}\]</span></p>
<p>Finally, actual herbaceous transpiration for a given soil layer <span class="math inline">\(s\)</span> (<span class="math inline">\(Tr_{herb,s}\)</span>) is reduced according to the soil water potential (<span class="math inline">\(\Psi_s\)</span>), assuming that transpiration reduction follows Weibull function with fixed coefficients:</p>
<p><span class="math display" id="eq:herbaceoustranspiration">\[\begin{equation}
Tr_{herb, s}= FRP_{herb,s} \cdot Tr_{herb,\max} \cdot \exp \left \{\ln{(0.5)}\cdot \left[ \frac{\Psi_i}{-1.5} \right] ^2 \right \}
\tag{5.1}
\end{equation}\]</span>
where <span class="math inline">\(FRP_{herb,s}\)</span> is the proportion of fine roots in layer <span class="math inline">\(s\)</span>, defined using <span class="math inline">\(Z_{50} = 50 mm\)</span> and <span class="math inline">\(Z_{95} = 500 mm\)</span> (see <a href="model-inputs.html#rootdistribution">2.4.7</a>).</p>
</div>
<div id="infiltration" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Infiltration<a href="hydrology.html#infiltration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The amount of rainfall event water that reaches the soil is the sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>) and runon (<span class="math inline">\(Ro\)</span>, in mm), if any. The amount of rainfall event water infiltrating into the soil matrix (<span class="math inline">\(If\)</span>) is estimated using either the <span class="citation">Boughton (<a href="#ref-Boughton1989">1989</a>)</span> or the <span class="citation">Green &amp; Ampt (<a href="#ref-green_studies_1911">1911</a>)</span> models.</p>
<div id="boughton-1989-model" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Boughton (1989) model<a href="hydrology.html#boughton-1989-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Surface runoff <span class="math inline">\(Ru\)</span> can be estimated using the USDA SCS curve number method, following <span class="citation">Boughton (<a href="#ref-Boughton1989">1989</a>)</span>:
<span class="math display">\[\begin{equation}
Ru=\frac{(Pr_{net} + Ro - 0.2 \cdot V_{fc, soil})^2}{(Pr_{net} + Ro - 0.8 \cdot V_{fc, soil})}
\end{equation}\]</span>
where <span class="math inline">\(V_{fc, soil}\)</span> (in mm) is the overall soil water retention capacity. The <span class="citation">Boughton (<a href="#ref-Boughton1989">1989</a>)</span> model is available in function <code>hydrology_infiltrationBoughton()</code> and examples of its behavior are given in the figure below.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:infiltrationBoughton"></span>
<img src="medfatebook_files/figure-html/infiltrationBoughton-1.png" alt="Examples of infiltration/runoff calculation using the Boughton (1989) model for different values of net rainfall and overall retention capacity, \(V_{soil}\), calculated from different soil depths (topsoil+subsoil) and assuming that soil texture is 15% clay and 25% sand. Rock fragment content was 25% and 40% for the topsoil and subsoil, respectively." width="768" />
<p class="caption">
Figure 5.4: Examples of infiltration/runoff calculation using the Boughton (1989) model for different values of net rainfall and overall retention capacity, <span class="math inline">\(V_{soil}\)</span>, calculated from different soil depths (topsoil+subsoil) and assuming that soil texture is 15% clay and 25% sand. Rock fragment content was 25% and 40% for the topsoil and subsoil, respectively.
</p>
</div>
</div>
<div id="green-ampt-1911-model" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Green-Ampt (1911) model<a href="hydrology.html#green-ampt-1911-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The description of the <span class="citation">Green &amp; Ampt (<a href="#ref-green_studies_1911">1911</a>)</span> model has been adapted from chapter 9 of <span class="citation">Bonan (<a href="#ref-bonan_climate_2019">2019</a>)</span>. The Green-Ampt equation uses the concept of a horizontal wetting front at some distance <span class="math inline">\(L_w\)</span> into the soil. The soil above <span class="math inline">\(L_w\)</span> is saturated (i.e. <span class="math inline">\(\theta_{sat}\)</span>), whreas soil below the wetting front has a uniform content <span class="math inline">\(\theta_{dry}\)</span> corresponding to conditions prior to the rainfall event. Darcy’s law provides the flux of water <span class="math inline">\(i_c\)</span> infiltrating into the soil from the surface to the wetting front at depth <span class="math inline">\(z = -L_w\)</span>:</p>
<p><span class="math display">\[\begin{equation}
i_c = K_{sat} \left[\frac{|\Psi_w| }{L_w} + 1  \right]
\end{equation}\]</span>
where <span class="math inline">\(\Psi_w\)</span> is the matric potential at the wetting front. The total cumulative infiltrated water <span class="math inline">\(I_c\)</span> at time <span class="math inline">\(t\)</span> is the time integral of <span class="math inline">\(i_c\)</span>, and is also equal to the <span class="math inline">\(L_w\)</span> multiplied by the change in water, i.e. <span class="math inline">\(\Delta \theta = \theta_{sat} - \theta_{dry}\)</span>:
<span class="math display">\[\begin{equation}
I_c = \Delta \theta L_w
\end{equation}\]</span>
The infiltration rate can also be expressed as the time derivative of <span class="math inline">\(I_c\)</span>, i.e.:
<span class="math display">\[\begin{equation}
i_c = \frac{dI_c}{dt} = \Delta \theta \frac{dL_w}{dt}
\end{equation}\]</span>
Combining the two equations for <span class="math inline">\(i_c\)</span> we obtain:
<span class="math display">\[\begin{equation}
\Delta \theta \frac{dL_w}{dt} =  K_{sat} \left[\frac{|\Psi_w| }{L_w} + 1  \right]
\end{equation}\]</span>
and substituting <span class="math inline">\(I_c/\Delta \theta\)</span> for <span class="math inline">\(L_w\)</span> gives:
<span class="math display">\[\begin{equation}
\frac{dI_c}{dt} =  K_{sat} \left[\frac{|\Psi_w| \Delta \theta}{I_c} + 1  \right]
\end{equation}\]</span>
By rearranging terms and integrating we obtain an expression for <span class="math inline">\(I_c(t)\)</span>:
<span class="math display">\[\begin{equation}
I_c(t) =  K_{sat}t  + |\Psi_w| \Delta \theta \ln\left[1 + \frac{I_c(t)}{|\Psi_w| \Delta \theta} \right]
\end{equation}\]</span>
This equation defines the cumulative infiltration to time <span class="math inline">\(t\)</span> as a function of <span class="math inline">\(K_{sat}\)</span>, <span class="math inline">\(\Psi_{w}\)</span>, <span class="math inline">\(\theta_{sat}\)</span> and <span class="math inline">\(\theta_{dry}\)</span>. Because <span class="math inline">\(I_c\)</span> appears on both sides of the equation, it must be found using numerical root-finding (the Newton-Raphson method in our case). To estimate <span class="math inline">\(\Psi_{w}\)</span> the following equation is used:
<span class="math display">\[\begin{equation}
\Psi_{w} = \left(\frac{2b + 3}{2b + 6} \right)\Psi_{sat}
\end{equation}\]</span></p>
<p>Parameter <span class="math inline">\(\theta_{dry}\)</span> is the volumetric content of the topmost soil layer (antecendent soil conditions), and parameters <span class="math inline">\(\theta_{sat}\)</span>, <span class="math inline">\(\Psi_{sat}\)</span>, <span class="math inline">\(K_{sat}\)</span> and <span class="math inline">\(b\)</span> are estimated using Campbell’s water retention curves from the texture of the topmost layer. The infiltration time <span class="math inline">\(t\)</span> (in <span class="math inline">\(h\)</span>) is estimated from the sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>) and runon (<span class="math inline">\(Ro\)</span>) (both in <span class="math inline">\(mm\)</span>) using rainfall intensity of the rainfall event (<span class="math inline">\(R_{int}\)</span>; in <span class="math inline">\(mm/h\)</span>). The <span class="citation">Green &amp; Ampt (<a href="#ref-green_studies_1911">1911</a>)</span> model is available in function <code>hydrology_infiltrationGreenAmpt()</code> and examples of its behavior are given in the figure below.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:infiltrationGreenAmpt"></span>
<img src="medfatebook_files/figure-html/infiltrationGreenAmpt-1.png" alt="Examples of infiltration using the Green-Ampt (1911) model for different values of net rainfall. The left panel shows the infiltration for different soil textural types, assuming a \(\theta_{dry} = 0.3\). The right panel shows the infiltration for different values of \(\theta_{dry}\), assuming a silt loam soil. In both cases rainfall intensity is assumed \(R_{int} = 6\,mm/h\)." width="768" />
<p class="caption">
Figure 5.5: Examples of infiltration using the Green-Ampt (1911) model for different values of net rainfall. The left panel shows the infiltration for different soil textural types, assuming a <span class="math inline">\(\theta_{dry} = 0.3\)</span>. The right panel shows the infiltration for different values of <span class="math inline">\(\theta_{dry}\)</span>, assuming a silt loam soil. In both cases rainfall intensity is assumed <span class="math inline">\(R_{int} = 6\,mm/h\)</span>.
</p>
</div>
</div>
</div>
<div id="soilflows" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Soil water flows<a href="hydrology.html#soilflows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="design-of-soil-water-flows" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Design of soil water flows<a href="hydrology.html#design-of-soil-water-flows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter we describe water movement into, out of, and within the soil. The water input to the soil is the sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>, i.e. rainfall minus interception), snow melt (<span class="math inline">\(Sm\)</span>) and (if simulations are done in a spatially-explicit context) runon from an adjacent location (<span class="math inline">\(Ro\)</span>). Water movement can be performed using either a multi-bucket model (<code>soilDomains = "buckets"</code>), the common single domain model (<code>soilDomains = "single"</code>) or the dual permeability model (<code>soilDomains = "dual"</code>), which follows with some modifications the MACRO model <span class="citation">(<a href="#ref-jarvis_modelling_1991">Jarvis <em>et al.</em> 1991</a>; <a href="#ref-larsbo_improved_2005">Larsbo <em>et al.</em> 2005</a>)</span>.</p>
<p>In the <strong>multi-bucket model</strong>, the water coming from rainfall events - i.e. sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>) and run-on (<span class="math inline">\(Ro\)</span>) - is divided between infiltration into the soil (<span class="math inline">\(If\)</span>) and runoff (<span class="math inline">\(Ru\)</span>), following the models explained in <a href="hydrology.html#infiltration">5.6</a>. Rainfall infiltrating into the soil is divided among soil layers, in a crude attempt to emulate the effect of preferential flows (but without accounting for the increase in infiltration caused by macropores). The amount of water reaching each soil layer is modelled using an extinction function that depends on macroporosity (see function <code>hydrology_infiltrationRepartition</code>). Next, the model pools the infiltrated water with input/outputs from plant extraction (or lateral processes). After that, water is added to (or subtracted from) each layer and if content is above field capacity the excess percolates to the layer below. If there is still an excess for the bottom layer, the model will progressively fill upper layers (eventually generating saturation excess if the first layer becomes saturated). Every day if some layers are over field capacity, the model simulates deep drainage up to an amount defined by the saturated conductivity of the bottom layer.</p>
<p>In the <strong>single-domain model</strong> (panel A in Fig. <a href="hydrology.html#fig:soilflowdesign">5.6</a>), the water coming from rainfall events - i.e. sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>) and run-on (<span class="math inline">\(Ro\)</span>) - is divided between infiltration into the soil (<span class="math inline">\(If\)</span>) and runoff (<span class="math inline">\(Ru\)</span>), following the models explained in <a href="hydrology.html#infiltration">5.6</a>. Rainfall infiltrating into the soil is divided among soil layers, in a crude attempt to emulate the effect of preferential flows (but without accounting for the increase in infiltration caused by macropores). The amount of water reaching each soil layer is modelled using an extinction function that depends on macroporosity (see function <code>hydrology_infiltrationRepartition</code>). In contrast to water from rainfall events, water from snow melt (<span class="math inline">\(Sm\)</span>) is assumed to infiltrate slowly and completely into the first layer. Water flows within the soil according to the Richards equation, assuming an homogenous porous media and where fluxes are driven by both gravitational and matric potentials. Root water uptake/redistribution is taken into account as source/sinks from/to the soil layers along with bare soil evaporation. Water leaving the bottom layer (as well as departures from the water balance) is assumed to drain beyond the soil limits (i.e. deep drainage (<span class="math inline">\(Dd\)</span>)). Saturation excess in the topmost layer leads to an increase in runoff (<span class="math inline">\(Ru\)</span>) and a corresponding decrease in infiltration (<span class="math inline">\(If\)</span>).</p>
<p>In the <strong>dual-permeability model</strong> (panel B in Fig. <a href="hydrology.html#fig:soilflowdesign">5.6</a>), total porosity is partitioned into two separate flow regions (matrix and macropores), each with its own degree of saturation, conductivity and flow rate. The water coming from rainfall events - i.e. sum of net rainfall (<span class="math inline">\(Pr_{net}\)</span>) and run-on (<span class="math inline">\(Ro\)</span>) - is divided between infiltration into the soil matrix (<span class="math inline">\(If\)</span>; following models in <a href="hydrology.html#infiltration">5.6</a>) and water infiltrating into the macropore domain. Water from snow melt (<span class="math inline">\(Sm\)</span>) is assumed to infiltrate slowly and completely into the soil matrix. Fluxes within the soil matrix follow the Richards equation and is driven by both gravity and matric potentials, as in the single-domain model. In contrast, fluxes in the macropore region are gravity-driven only. Saturation of micropores of a given soil matrix layer leads to a water source into the corresponding macropore layer, whereas water uptake by the soil matrix via capillarity from the corresponding macropore layer follows a diffusion equation. Root water uptake/redistribution is taken into account as source/sinks in the soil matrix along with bare soil evaporation. Deep drainage (<span class="math inline">\(Dd\)</span>) can occur from both the soil matrix or the macropore domain. Finally, saturation excess in the macropore domain leads to accumulation of water in the above layer and, eventually, to surface runoff (<span class="math inline">\(Ru\)</span>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soilflowdesign"></span>
<img src="figures/soil_flow_design.png" alt="Schematic representation of the (A) single domain and (B) dual-permeability models of flows into, out of and within the soil. Symbols are defined in the main text." width="100%" />
<p class="caption">
Figure 5.6: Schematic representation of the (A) single domain and (B) dual-permeability models of flows into, out of and within the soil. Symbols are defined in the main text.
</p>
</div>
<p>Function <code>hydrology_soilWaterBalance()</code> performs infiltration and vertical water movement flows, given a soil, net rainfall, snowmelt and source/sink vector for each layer. Source/sink terms are defined as follows for the first layer (<span class="math inline">\(i=1\)</span>):
<span class="math display">\[\begin{equation}
S_1 = - Es - Tr_{herb,1} - Ex_{woody,1}
\end{equation}\]</span>
and for <span class="math inline">\(1 &lt; i \leq N\)</span>:
<span class="math display">\[\begin{equation}
S_i = - Tr_{herb,i} - Ex_{woody,i}
\end{equation}\]</span>
where <span class="math inline">\(Es\)</span> is bare soil evaporation, <span class="math inline">\(Tr_{herb, i}\)</span> is herbaceous uptake from layer <span class="math inline">\(i\)</span> and <span class="math inline">\(Ex_{woody}\)</span> is woody plant uptake/redistribution from/to layer <span class="math inline">\(i\)</span>. In the single-domain and dual-permeability models, all right-hand terms are converted from <span class="math inline">\(mm/day\)</span> to instantaneous rates (<span class="math inline">\(m/s\)</span>) for proper units in <span class="math inline">\(S\)</span>. By default, <strong>24 time steps</strong> of 1 hour are used for vertical water simulation of each day, but the time step is modified if required to close the water balance of the matrix or macropore domains. Function <code>hydrology_soilWaterBalance()</code> updates soil moisture and returns daily fluxes corresponding to infiltration, runoff and deep drainage.</p>
<p>The following sections detail the formulation and numerical solving of soil flows, both under the single-domain and the dual-permeability models.</p>
</div>
<div id="darcian-flow-and-richards-equation" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Darcian flow and Richards equation<a href="hydrology.html#darcian-flow-and-richards-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Water flows in the soil <strong>from high to low potential</strong> as described by Darcy’s law. In the soil matrix, the <strong>total potential</strong> is used, i.e. the sum of the <strong>matric</strong> potential (<span class="math inline">\(\Psi_{s}\)</span>, here expressed in <span class="math inline">\(m\)</span>, see <a href="model-inputs.html#soilinitialization">2.3.3</a>) and vertical <strong>depth</strong> <span class="math inline">\(z\)</span> (also in <span class="math inline">\(m\)</span>). The vertical depth <span class="math inline">\(z\)</span> is taken as positive in the upward direction, so that <span class="math inline">\(z = 0\)</span> is the ground surface. In the vertical dimension the <strong>flux</strong> <span class="math inline">\(Q\)</span>, i.e. rate of water movement (in <span class="math inline">\(m s^{-1}\)</span>), according to Darcy’s law is:
<span class="math display">\[\begin{equation}
Q = -K(\theta)\cdot \frac{\delta (\Psi + z)}{\delta z} = -K(\theta)\cdot \frac{\delta \Psi}{\delta z} - K(\theta)
\end{equation}\]</span>
where <span class="math inline">\(K(\theta)\)</span> is the hydraulic conductivity (in <span class="math inline">\(m s^{-1}\)</span>) that describes the ease with which water can move through the porous media space, and depends on soil moisture (<span class="math inline">\(\theta\)</span>). In the macropore domain, only the vertical depth (i.e. gravity potential) is considered, which leads to a <strong>unit gradient</strong>, and hence the flux <span class="math inline">\(Q\)</span> is simply:
<span class="math display">\[\begin{equation}
Q = -K_{ma}(\theta_{ma})
\end{equation}\]</span>
where <span class="math inline">\(K_{ma}\)</span> is the macropore hydraulic conductivity (in <span class="math inline">\(m s^{-1}\)</span>), depending on the macropore water content <span class="math inline">\(\theta_{ma}\)</span> (in <span class="math inline">\(m^3\cdot m^{-3}\)</span>).</p>
<p>Consider a volume of soil with horizontal area <span class="math inline">\(\Delta x \Delta y\)</span>, thickness <span class="math inline">\(\Delta z\)</span> and with non-rock proportion <span class="math inline">\(\lambda = 1 - P_{rocks}\)</span>. The mass flux entering the parcel from above is <span class="math inline">\(\rho_{w} Q_{in} \Delta x \Delta y\)</span> and the flux out of it is <span class="math inline">\(\rho_{w} Q_{out} \Delta x \Delta y\)</span>. Conservation requires that the difference between fluxes and source/sinks equals the rate of change in water storage. The mass of water in the soil volume is <span class="math inline">\(\rho_{w} \theta \Delta x \Delta y \Delta z \lambda\)</span> so the change in water over a time interval <span class="math inline">\(\Delta t\)</span> is:</p>
<p><span class="math display">\[\begin{equation}
\rho_{w} \frac{\Delta \theta}{\Delta t} \Delta x \Delta y \Delta z \lambda  = - \rho_{w} (Q_{in} - Q_{out}) \Delta x \Delta y
\end{equation}\]</span></p>
<p>and gives the continuity equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{\Delta \theta}{\Delta t} \lambda  = - \frac{(Q_{in} - Q_{out})}{\Delta z}
\end{equation}\]</span></p>
<p>which expressed in the notation of calculus is:</p>
<p><span class="math display">\[\begin{equation}
\frac{\delta \theta}{\delta t} \lambda  = - \frac{\delta Q}{\delta z}
\end{equation}\]</span></p>
<p>Substituting Darcy’s law for <span class="math inline">\(Q\)</span>, and accounting for (lateral) sources/sinks <span class="math inline">\(S\)</span>, gives the Richards equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{\delta \theta}{\delta t} \lambda = \frac{\delta}{\delta z} \left[ K(\theta) \frac{\delta \Psi}{\delta z} + K(\theta) \right] \pm S = K(\theta) \frac{\delta^2 \Psi}{\delta^2 z} + \frac{\delta K}{\delta z} \frac{\delta \Psi}{\delta z}  \frac{\delta K}{\delta z} \pm S
\end{equation}\]</span></p>
<p>The former is known as the <em>mixed-form</em> Richards equation, because it includes <span class="math inline">\(\theta\)</span> on the left hand and the vertical gradient in matric potential <span class="math inline">\(\Psi\)</span> on the right hand. The <em>head-based</em> or <span class="math inline">\(\Psi\)</span>-<em>based form</em> expresses the left hand term using <span class="math inline">\(\Psi\)</span> as dependent variable:</p>
<p><span class="math display">\[\begin{equation}
C(\Psi) \frac{\delta \Psi}{\delta t} \lambda =  K(\Psi) \frac{\delta^2 \Psi}{\delta^2 z} + \frac{\delta K}{\delta z} \frac{\delta \Psi}{\delta z} + \frac{\delta K}{\delta z} \pm S
\end{equation}\]</span></p>
<p>where <span class="math inline">\(C(\Psi) = \delta \theta / \delta \Psi\)</span> is known as the <strong>specific moisture capacity</strong>, in <span class="math inline">\(m^{-1}\)</span>. In the macropore domain, the use of the former equation is problematic; a major reason being the lack of information concerning the relationship between <span class="math inline">\(\Psi\)</span> and <span class="math inline">\(\theta\)</span> close to saturation. If we assume capillarity to be negligible in the macropore domain, then <span class="math inline">\(\delta \Psi / \delta z = 0\)</span> and the corresponding governing equation becomes:</p>
<p><span class="math display">\[\begin{equation}
\frac{\delta \theta_{ma}}{\delta t} \lambda =  \frac{\delta K_{ma}}{\delta z} \pm S
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta_{ma}\)</span> and <span class="math inline">\(K_{ma}\)</span> are the soil moisture and soil conductivity, respectively, in the macropore domain.</p>
</div>
<div id="hydraulic-properties-in-the-single-domain-model" class="section level3 hasAnchor" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Hydraulic properties in the single-domain model<a href="hydrology.html#hydraulic-properties-in-the-single-domain-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In single-domain simulations, the Van Genuchten <span class="citation">(<a href="#ref-Genuchten1980">1980</a>)</span> model is used to represent the water retention curve (see section <a href="model-inputs.html#waterretentioncurves">2.3.2</a>):</p>
<p><span class="math display">\[\begin{equation}
\theta(\Psi) = \theta_{res}+\frac{\theta_{sat}-\theta_{res}}{\left[1+ |\alpha \cdot \Psi|^n \right]^{m}}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(m = 1-1/n\)</span> is a shape parameter. It can be re-arranged into:</p>
<p><span class="math display">\[\begin{equation}
S_e = \frac{\theta(\Psi) - \theta_{res}}{\theta_{sat}-\theta_{res}} = \left(1+ |\alpha \cdot \Psi|^n \right)^{-m}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(S_e\)</span> is the degree of saturation. The specific moisture capacity, <span class="math inline">\(C(\Psi)\)</span>, is the derivative <span class="math inline">\(\delta \theta / \delta \Psi\)</span>, i.e.:</p>
<p><span class="math display">\[\begin{equation}
C(\Psi) = \alpha \cdot m \cdot n \cdot (\theta_{sat} - \theta_{res}) \cdot \frac{|\alpha \cdot \Psi|^{n-1}}{\left(1+ |\alpha \cdot \Psi|^n \right)^{m + 1}}
\end{equation}\]</span>
The hydraulic conductivity <span class="math inline">\(K(\Psi)\)</span> for a given water potential <span class="math inline">\(\Psi\)</span> is determined in the Van Genuchten model as a function of <span class="math inline">\(S_e\)</span> using:</p>
<p><span class="math display">\[\begin{equation}
K(\Psi) = K_{sat} \cdot S_e^{l} \cdot \left[ 1 - (1 -  S_e^{1/m})^m \right]^2
\end{equation}\]</span>
where <span class="math inline">\(K_{sat}\)</span> is the saturated hydraulic conductivity and <span class="math inline">\(l = 0.5\)</span> is the tortuosity factor.</p>
</div>
<div id="hydraulic-properties-in-the-dual-permeability-model" class="section level3 hasAnchor" number="5.7.4">
<h3><span class="header-section-number">5.7.4</span> Hydraulic properties in the dual-permeability model<a href="hydrology.html#hydraulic-properties-in-the-dual-permeability-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In MACRO <span class="citation">(<a href="#ref-jarvis_modelling_1991">Jarvis <em>et al.</em> 1991</a>; <a href="#ref-larsbo_improved_2005">Larsbo <em>et al.</em> 2005</a>)</span>, a “cut and join” approach is used to define the hydraulic functions. A water potential <span class="math inline">\(\Psi_{b} = -0.1\,m =  -0.98 \,kPa\)</span> partitions the total porosity into matrix pores and macropores, while the corresponding water content, <span class="math inline">\(\theta_{b}\)</span> and hydraulic conductivity <span class="math inline">\(K_b\)</span> represent the saturated state of the soil matrix.</p>
<p><strong>Matrix domain</strong></p>
<p>Soil water retention in the matrix is calculated using a modified form of Van Genuchten’s <span class="citation">(<a href="#ref-Genuchten1980">1980</a>)</span> equation:
<span class="math display">\[\begin{equation}
S_{mi} = \frac{\theta_{mi}(\Psi) - \theta_{res}}{\theta^{fict}_{sat}-\theta_{res}} = \left(1+ |\alpha \cdot \Psi|^n \right)^{-m}
\end{equation}\]</span>
where <span class="math inline">\(\theta^{fict}_{sat} = \theta_{sat} - P_{macro}\)</span> is a fictious saturated content obtained subtracting the proportion of macropores. <span class="math inline">\(\theta_{b}\)</span> is estimated as <span class="math inline">\(\theta_{mi}(\Psi_b)\)</span>, whereas <span class="math inline">\(K_b\)</span> is estimated with van Genuchten’s <span class="math inline">\(K\)</span> equation but using <span class="math inline">\(S_{mi}(\Psi_b)\)</span> instead of <span class="math inline">\(S_e\)</span>. The capacitance in the matrix domain (<span class="math inline">\(C_{mi}\)</span>) is estimated using the same equation as the single domain model, but replacing <span class="math inline">\(\theta_{sat}\)</span> by <span class="math inline">\(\theta^{fict}_{sat}\)</span>. Finally, the following form is used to describe the unsaturated hydraulic conductivity function in the matrix, using <span class="math inline">\(K_b\)</span> as the matching point:</p>
<p><span class="math display">\[\begin{equation}
K_{mi} = K_b \cdot \left( \frac{S_{mi}}{S_{mi}(\Psi_b)} \right)^{l} \cdot \left[ \frac{1 - (1 -  S_{mi}^{1/m})^m}{1 - (1 -  S_{mi}(\Psi_b)^{1/m})^m} \right]^2
\end{equation}\]</span>
where <span class="math inline">\(l = 0.5\)</span> is the tortuosity factor. For water potentials less negative that <span class="math inline">\(\Psi_b\)</span> the hydraulic conductivity is set to <span class="math inline">\(K_b\)</span>.</p>
<p><strong>Macropore domain</strong></p>
<p>In the macropore domain, the water potential is not defined and flow equations are expressed in <span class="math inline">\(\theta\)</span>-<em>based form</em>. The degree of saturation in the macropores (<span class="math inline">\(S_{ma}\)</span>) is related to soil moisture in the macropores (<span class="math inline">\(\theta_{ma}\)</span>) via:
<span class="math display">\[\begin{equation}
S_{ma} = \frac{\theta_{ma}}{e_{ma}}
\end{equation}\]</span>
where <span class="math inline">\(e_{ma} = \theta_{sat} - \theta_{b}\)</span>. The hydraulic conductivity function in the macropores (<span class="math inline">\(K_{ma}\)</span>) is given as a simple power law of the degree of saturation:</p>
<p><span class="math display">\[\begin{equation}
K_{ma} = (K_{sat} - K_{b}) \cdot S_{ma}^{n_{ma}}
\end{equation}\]</span>
where <span class="math inline">\(n_{ma} = 2.23\)</span> is a kinematic exponent reflecting macropore size distribution and tortuosity. Unlike in MACRO <span class="citation">(<a href="#ref-jarvis_modelling_1991">Jarvis <em>et al.</em> 1991</a>)</span>, the fact that macroporosity and macropore maximum hydraulic conductivity may not be constant but vary due to swelling and shrinkage is not taken into account.</p>
<p><strong>Lateral flows</strong></p>
<p>In the beginning, or at any given step, if <span class="math inline">\(\theta_{mi} &gt; \theta_{b}\)</span>, the excess of water is transferred from the matrix to the macropore domain, i.e. it will be used as a source to increase <span class="math inline">\(\theta_{ma}\)</span>. However, the macropores have a finite storage capacity for water, <span class="math inline">\(C_{ma}\)</span>, equal to:
<span class="math display">\[\begin{equation}
C_{ma} = (1 - S_{ma}) \cdot (\theta_{sat} - \theta_b)
\end{equation}\]</span>
Hence, the flow to the macropore domain is limited by <span class="math inline">\(C_{ma}\)</span>. The reverse flow, i.e the water uptake by the unsaturated matrix is treated as a first-order approximation to a diffusion equation, assuming a rectangular-slab geometry for the aggregates:</p>
<p><span class="math display">\[\begin{equation}
U_w = \left( \frac{G_w\cdot D_w \cdot \gamma_w}{d^2} \right) \cdot (\theta_{b} - \theta_{mi})
\end{equation}\]</span>
where <span class="math inline">\(d\)</span> (in <span class="math inline">\(m\)</span>) is an effective diffusion path length, <span class="math inline">\(D_w\)</span> (in <span class="math inline">\(m^2s^{-1}\)</span>) is an effective water diffusivity that depends on <span class="math inline">\(S_{ma}\)</span>, <span class="math inline">\(G_w = 3\)</span> is a geometry factor and <span class="math inline">\(\gamma_w = 0.1\)</span> is a scaling factor. See details in <span class="citation">(<a href="#ref-larsbo_improved_2005">Larsbo <em>et al.</em> 2005</a>)</span>. Water uptake by the unsaturated matrix is treated as a source for the matrix domain and as a sink for the macropore domain.</p>
</div>
<div id="finite-approximation-to-flows-in-the-soil-matrix" class="section level3 hasAnchor" number="5.7.5">
<h3><span class="header-section-number">5.7.5</span> Finite approximation to flows in the soil matrix<a href="hydrology.html#finite-approximation-to-flows-in-the-soil-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Water movement in the soil matrix was taken from chapter 8 of <span class="citation">Bonan (<a href="#ref-bonan_climate_2019">2019</a>)</span>, and much of the present text has been summarized and adapted from this source, with modifications for the exchange with macropore moisture. The finite difference approximation for the Richards equation represents the soil as a network of <span class="math inline">\(N\)</span> discrete nodal points that vary in space and time. The network is presented in Fig. <a href="hydrology.html#fig:soilmatrixflows">5.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soilmatrixflows"></span>
<img src="figures/soilmatrix_flows.png" alt="Schematic representation of network of soil nodes" width="80%" />
<p class="caption">
Figure 5.7: Schematic representation of network of soil nodes
</p>
</div>
<p>For reasons of numerical stability, Richards equation is solved using an implicit time discretization win which the spatial derivatives <span class="math inline">\(\delta K / \delta z\)</span>, <span class="math inline">\(\delta \Psi / \delta z\)</span> and <span class="math inline">\(\delta^2 \Psi / \delta ^2 z\)</span> are written numerically using a central difference approximation at time <span class="math inline">\(n+1\)</span>, and the time derivative uses a backward difference approximation at <span class="math inline">\(n+1\)</span>.</p>
<p>Soil layer <span class="math inline">\(i\)</span> has a thickness <span class="math inline">\(\Delta z_i\)</span>. Water content <span class="math inline">\(\theta_i\)</span>, matric potential <span class="math inline">\(\Psi_i\)</span> and hydraulic conductivity <span class="math inline">\(K_i\)</span> are defined at the center of the layer at depth <span class="math inline">\(z_i\)</span> and are uniform over the layer. Here <span class="math inline">\(K_i\)</span> values have been corrected by <span class="math inline">\(\lambda_i\)</span>, to account for the fact that the amount of stones in the soil reduce the conductivity, which is expressed per soil area unit (so, in fact, all terms in the mass balance equations are multiplied by <span class="math inline">\(\lambda_i\)</span>, except the source/sinks). Water inputs/outputs from other processes (i.e. infiltration, snow melt, bare soil evaporation, herbaceous transpiration and woody plant uptake/redistribution) are represented as a source/sink term <span class="math inline">\(S_i\)</span> for each node <span class="math inline">\(i\)</span>. If simulations are done in the dual-permeability model, <span class="math inline">\(S_i\)</span> can include positive or negative terms due to saturation excess flow into the macropore domain or capillary imbibition from the macropore domain.</p>
<p>For a given intermediate layer <span class="math inline">\(1 &lt; i &lt; N\)</span>, the outward flux <span class="math inline">\(Q_i\)</span> between layers <span class="math inline">\(i\)</span> and <span class="math inline">\(i+1\)</span> is defined using:</p>
<p><span class="math display">\[\begin{equation}
Q_i =  -\frac{K_{i+1/2}}{\Delta z_{i+1/2}} (\Psi_i - \Psi_{i+1}) - K_{i+1/2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(z_{i+1/2} = z_i - z_{i+1}\)</span> and <span class="math inline">\(K_{i+1/2} = 0.5(K_i + K_{i+1})\)</span> replaces the vertically varying hydraulic conductivity within the two layers with an effective conductivity for an equivalent homogeneous medium. The inward flux <span class="math inline">\(Q_{i-1}\)</span> between layers <span class="math inline">\(i-1\)</span> and <span class="math inline">\(i\)</span> is defined similarly:</p>
<p><span class="math display">\[\begin{equation}
Q_{i-1} =  -\frac{K_{i-1/2}}{\Delta z_{i-1/2}} (\Psi_{i-1} - \Psi_{i}) - K_{i-1/2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(z_{i-1/2} = z_{i-1} - z_{i}\)</span> and <span class="math inline">\(K_{i-1/2} = 0.5(K_{i-1} + K_{i})\)</span>. If we apply the fluxes to the water balance equation, with fluxes and capacitance expressed for time <span class="math inline">\(n+1\)</span>, and considering the <span class="math inline">\(S_i\)</span> source/sink term (in <span class="math inline">\(m s^{-1}\)</span>), we obtain the following <span class="math inline">\(\Psi\)</span>-based form:</p>
<p><span class="math display">\[\begin{equation}
\frac{\Delta z_i}{\Delta t} C_i^{n+1} (\Psi_i^{n+1} - \Psi_i^n) \lambda_i =  \frac{K_{i-1/2}^{n+1}}{\Delta z_{i-1/2}} (\Psi_{i-1}^{n+1} - \Psi_i^{n+1}) - \frac{K_{i+1/2}^{n+1}}{\Delta z_{i+1/2}} (\Psi_i^{n+1} - \Psi_{i+1}^{n+1}) \\ + K_{i-1/2}^{n+1} - K_{i+1/2}^{n+1} + S^{n+1}_i
\end{equation}\]</span></p>
<p>For the first layer (<span class="math inline">\(i=1\)</span>) the boundary condition is defined so that there is no inward flux (but a source/sink term is added), which yields the following <span class="math inline">\(\Psi\)</span>-based form:</p>
<p><span class="math display">\[\begin{equation}
\frac{\Delta z_1}{\Delta t} C_1^{n+1} (\Psi_1^{n+1} - \Psi_1^n) \lambda_1 =  - \frac{K_{1+1/2}^{n+1}}{\Delta z_{1+1/2}} (\Psi_1^{n+1} - \Psi_{2}^{n+1}) - K_{1+1/2}^{n+1} + S^{n+1}_1
\end{equation}\]</span></p>
<p>Finally, for the last layer (<span class="math inline">\(i=N\)</span>) a free drainage condition is specified as boundary condition, where <span class="math inline">\(Q_N = K_N\)</span>, which yields the following <span class="math inline">\(\Psi\)</span>-based form:</p>
<p><span class="math display">\[\begin{equation}
\frac{\Delta z_N}{\Delta t} C_N^{n+1} (\Psi_N^{n+1} - \Psi_N^n) \lambda_N =  \frac{K_{N-1/2}^{n+1}}{\Delta z_{N-1/2}} (\Psi_{N-1}^{n+1} - \Psi_{N}^{n+1}) +  K_{N-1/2}^{n+1} - K_{N}^{n+1} + S^{n+1}_N
\end{equation}\]</span></p>
<p>Alternatively, if a water table depth is supplied and is equal or shallower than soil depth, the model can simulate capillarity rise by changing the lower boundary condition to that of a constant saturated layer (i.e. <span class="math inline">\(\Psi_{N+1} = 0\)</span>).</p>
<p><span class="math display">\[\begin{equation}
\frac{\Delta z_i}{\Delta t} C_N^{n+1} (\Psi_N^{n+1} - \Psi_N^n) \lambda_i =  \frac{K_{N-1/2}^{n+1}}{\Delta z_{N-1/2}} (\Psi_{N-1}^{n+1} - \Psi_N^{n+1}) - \frac{K_{N+1/2}^{n+1}}{\Delta z_{N+1/2}} (\Psi_N^{n+1} - 0) \\ + K_{N-1/2}^{n+1} - K_{N+1/2}^{n+1} + S^{n+1}_N
\end{equation}\]</span>
where <span class="math inline">\(K_{N+1/2} = 0.5(K_{N} + K_{sat})\)</span>. If the water table is shallower than a given layer, it is assumed to be saturated and if not the model simulates water filling until saturation is reached. Gravitational fluxes are set to zero for layers completely below the water table, and in this case deep drainage is evaluated using the water draining from the unsaturated layers.</p>
<p>The numerical form of the <span class="math inline">\(\Psi\)</span>-based Richards equation for a soil with <span class="math inline">\(N\)</span> layers is a tridiagonal system of <span class="math inline">\(N\)</span> equations with <span class="math inline">\(N\)</span> unknown values <span class="math inline">\(\Psi\)</span> at time <span class="math inline">\(n+1\)</span>. An additional complexity is that <span class="math inline">\(\Psi\)</span> at <span class="math inline">\(n+1\)</span> also appears through <span class="math inline">\(K\)</span> and <span class="math inline">\(C\)</span>. The solution requires linearizing with respect to <span class="math inline">\(\Psi\)</span> through various methods. Here the <strong>predictor-corrector</strong> method is employed, a two-step solution that solves the equation twice <span class="citation">(<a href="#ref-haverkamp_comparison_1977">Haverkamp <em>et al.</em> 1977</a>)</span>. The predictor step uses explicit linearization to solve for <span class="math inline">\(\Psi\)</span> over one-half of a full time step (<span class="math inline">\(\Delta t/2\)</span>) at time <span class="math inline">\(n +1/2\)</span> with <span class="math inline">\(K\)</span> and <span class="math inline">\(C\)</span> from time <span class="math inline">\(n\)</span>. The resulting values for <span class="math inline">\(\Psi\)</span> are used to evaluate <span class="math inline">\(K\)</span> and <span class="math inline">\(C\)</span> at <span class="math inline">\(n+1/2\)</span>. The corrector step uses these to obtain <span class="math inline">\(\Psi\)</span> over the full time step (<span class="math inline">\(\Delta t\)</span>) at <span class="math inline">\(n+1\)</span>. An implicit solution is used for the predictor step and the Crank-Nicolson method is used for the corrector step.</p>
</div>
<div id="finite-approximation-to-flows-in-the-macropore-domain" class="section level3 hasAnchor" number="5.7.6">
<h3><span class="header-section-number">5.7.6</span> Finite approximation to flows in the macropore domain<a href="hydrology.html#finite-approximation-to-flows-in-the-macropore-domain" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An implicit solution is used to discretize the local water balance in the macropores of a layer <span class="math inline">\(i\)</span>, using:
<span class="math display">\[\begin{equation}
\frac{\theta_{ma,i}^{n+1} -\theta_{ma,i}^{n}}{\Delta t} \cdot \lambda_i = \frac{K_{ma, i-1}^{n+1} - K_{ma, i}^{n+1}}{\Delta z_i} + S^{n+1}_{i}
\end{equation}\]</span>
since <span class="math inline">\(\theta_{ma}\)</span> is related to <span class="math inline">\(S_{ma}\)</span>, we can re-express the previous equation into:</p>
<p><span class="math display">\[\begin{equation}
S_{ma,i}^{n+1} = S_{ma,i}^{n} + \frac{\Delta t}{\lambda_i \cdot e_{ma, i}} \cdot \left( \frac{K_{ma, i-1}^{n+1} - K_{ma, i}^{n+1}}{\Delta z_i} + S^{n+1}_{i} \right)
\end{equation}\]</span></p>
<p>In this equation, <span class="math inline">\(K_{ma, i-1}^{n+1}\)</span> represents the conductivity of the layer above for the time step <span class="math inline">\(n+1\)</span>, whereas the <span class="math inline">\(K_{ma, i}^{n+1}\)</span> is the conductivity of the current layer for the same time step, hence depending on <span class="math inline">\(S_{ma,i}^{n+1}\)</span>. The local water balance is solved for each layer, in turn, from the soil surface downward, assuming a zero flow from the surface <span class="math inline">\(K_{ma, 0}^{n+1} = 0\)</span> (infiltration into macropores is given by <span class="math inline">\(S_{1}^{n+1}\)</span>). Then for any given layer <span class="math inline">\(i\)</span>, <span class="math inline">\(K_{ma, i-1}^{n+1}\)</span> is already defined and a solution for <span class="math inline">\(S_{ma,i}^{n+1}\)</span> can be found using a bisection method (i.e. internal halving). After solving for all layers, if the capacity of macropores is exceeded in any given layer, the excess is added to the macropore storage of the layer above. Excess of the topmost layer results in runoff via saturation excess.</p>
<p>Like in the matrix domain, if the water table is shallower than a given layer, it is assumed to be saturated and if not the model simulates macropore water filling until saturation is reached. Gravitational fluxes are set to zero for layers completely below the water table, and in this case macropore drainage is evaluated using the water draining from the unsaturated layers.</p>

</div>
</div>
</div>
<h3>Bibliography<a href="bibliography.html#bibliography" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bonan_climate_2019" class="csl-entry">
Bonan, G. (2019). <em><a href="https://doi.org/10.1017/9781107339217">Climate change and terrestrial ecosystem modeling</a></em>. Cambridge University Press, Cambridge, UK.
</div>
<div id="ref-Boughton1989" class="csl-entry">
Boughton, W. (1989). <a href="http://www.publish.csiro.au/?paper=SR9890511">A review of the <span>USDA</span> <span>SCS</span> curve number method</a>. <em>Australian Journal of Soil Research</em>, 27, 511–523.
</div>
<div id="ref-Deguchi2006" class="csl-entry">
Deguchi, A., Hattori, S. &amp; Park, H.-T. (2006). <a href="https://doi.org/10.1016/j.jhydrol.2005.06.005">The influence of seasonal changes in canopy structure on interception loss: <span>Application</span> of the revised <span>Gash</span> model</a>. <em>Journal of Hydrology</em>, 318, 80–102.
</div>
<div id="ref-Federer1982" class="csl-entry">
Federer, C. (1982). <a href="http://onlinelibrary.wiley.com/doi/10.1029/WR018i002p00355/full">Transpirational supply and demand: Plant, soil, and atmospheric effects evaluated by simulation</a>. <em>Water Resources Research</em>, 18, 355–362.
</div>
<div id="ref-Gash1995" class="csl-entry">
Gash, J., Lloyd, C. &amp; Lachaud, G. (1995). <a href="https://doi.org/10.1016/0022-1694(95)02697-N">Estimating sparse forest rainfall interception with an analytical model</a>. <em>Journal of Hydrology</em>, 170.
</div>
<div id="ref-Genuchten1980" class="csl-entry">
Genuchten, M.V. (1980). <a href="https://dl.sciencesocieties.org/publications/sssaj/abstracts/44/5/SS0440050892">A closed-form equation for predicting the hydraulic conductivity of unsaturated soils</a>. <em>Soil science society of America journal</em>, 44, 892–898.
</div>
<div id="ref-Granier1999" class="csl-entry">
Granier, A., Bréda, N., Biron, P. &amp; Villette, S. (1999). <a href="https://doi.org/10.1016/S0304-3800(98)00205-1">A lumped water balance model to evaluate duration and intensity of drought constraints in forest stands</a>. <em>Ecological Modelling</em>, 116, 269–283.
</div>
<div id="ref-green_studies_1911" class="csl-entry">
Green, H.W. &amp; Ampt, G.A. (1911). <a href="https://doi.org/10.1017/S0021859600001441">Studies on <span>Soil</span> <span>Physics</span>.</a> <em>The Journal of Agricultural Science</em>, 4, 1–24.
</div>
<div id="ref-haverkamp_comparison_1977" class="csl-entry">
Haverkamp, R., Vauclin, M., Touma, J., Wierenga, P.J. &amp; Vachaud, G. (1977). <a href="https://doi.org/10.2136/sssaj1977.03615995004100020024x">A <span>Comparison</span> of <span>Numerical</span> <span>Simulation</span> <span>Models</span> <span>For</span> <span>One</span>‐<span>Dimensional</span> <span>Infiltration</span></a>. <em>Soil Science Society of America Journal</em>, 41, 285–294.
</div>
<div id="ref-jarvis_modelling_1991" class="csl-entry">
Jarvis, N.J., Jansson, P‐E., Dik, P.E. &amp; Messing, I. (1991). <a href="https://doi.org/10.1111/j.1365-2389.1991.tb00091.x">Modelling water and solute transport in macroporous soil. <span>I</span>. <span>Model</span> description and sensitivity analysis</a>. <em>Journal of Soil Science</em>, 42, 59–70.
</div>
<div id="ref-Kergoat1998" class="csl-entry">
Kergoat, L. (1998). <a href="https://doi.org/10.1016/S0022-1694(98)00211-X">A model for hydrological equilibrium of leaf area index on a global scale</a>. <em>Journal of Hydrology</em>, 212-213, 268–286.
</div>
<div id="ref-larsbo_improved_2005" class="csl-entry">
Larsbo, M., Roulier, S., Stenemo, F., Kasteel, R. &amp; Jarvis, N. (2005). <a href="https://doi.org/10.2136/vzj2004.0137">An <span>Improved</span> <span>Dual</span>‐<span>Permeability</span> <span>Model</span> of <span>Water</span> <span>Flow</span> and <span>Solute</span> <span>Transport</span> in the <span>Vadose</span> <span>Zone</span></a>. <em>Vadose Zone Journal</em>, 4, 398–406.
</div>
<div id="ref-liu_evaluation_2001" class="csl-entry">
Liu, S. (2001). <a href="https://doi.org/10.1002/hyp.264">Evaluation of the <span>Liu</span> model for predicting rainfall interception in forests world-wide</a>. <em>Hydrological Processes</em>, 15, 2341–2360.
</div>
<div id="ref-Mouillot2001" class="csl-entry">
Mouillot, F., Rambal, S. &amp; Lavorel, S. (2001). <a href="https://doi.org/10.1016/S0378-1127(00)00432-1">A generic process-based <span>SImulator</span> for <span class="nocase">meditERRanean</span> <span class="nocase">landscApes</span> (<span>SIERRA</span>): Design and validation exercises</a>. <em>Forest Ecology and Management</em>, 147, 75–97.
</div>
<div id="ref-Ritchie1972" class="csl-entry">
Ritchie, J. (1972). <a href="http://onlinelibrary.wiley.com/doi/10.1029/WR008i005p01204/full">Model for predicting evaporation from a row crop with incomplete cover</a>. <em>Water resources research</em>, 8, 1204–1213.
</div>
<div id="ref-Watanabe1996" class="csl-entry">
Watanabe, T. &amp; Mizutani, K. (1996). Model study on micrometeorological aspects of rainfall interception over an evergreen broad-leaved. <em>Agricultural and Forest Meteorology</em>, 80, 195–214.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="leafphenologylight.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transpirationgranier.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["medfatebook.pdf", "medfatebook.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
