<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Model inputs | The medfate reference book</title>
  <meta name="description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Model inputs | The medfate reference book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Model inputs | The medfate reference book" />
  
  <meta name="twitter:description" content="This is a reference book for models implemented in packages medfate and medfateland." />
  



<meta name="date" content="2024-05-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="basicwaterbalance.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">The medfate book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#an-collaborative-project"><i class="fa fa-check"></i>An collaborative project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#package-medfate"><i class="fa fa-check"></i><b>1.1.1</b> Package medfate</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#package-medfateland"><i class="fa fa-check"></i><b>1.1.2</b> Package medfateland</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#companion-packages"><i class="fa fa-check"></i><b>1.1.3</b> Companion packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#requirements"><i class="fa fa-check"></i><b>1.2.1</b> Requirements</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#installing-medfate"><i class="fa fa-check"></i><b>1.2.2</b> Installing medfate</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#installing-medfateland"><i class="fa fa-check"></i><b>1.2.3</b> Installing medfateland</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#main-functions-in-medfate"><i class="fa fa-check"></i><b>1.3</b> Main functions in medfate</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#dynamic-simulation-functions"><i class="fa fa-check"></i><b>1.3.1</b> Dynamic simulation functions</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#sub-model-functions"><i class="fa fa-check"></i><b>1.3.2</b> Sub-model functions</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#static-functions"><i class="fa fa-check"></i><b>1.3.3</b> Static functions</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#main-functions-in-medfateland"><i class="fa fa-check"></i><b>1.4</b> Main functions in medfateland</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="model-inputs.html"><a href="model-inputs.html"><i class="fa fa-check"></i><b>2</b> Model inputs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="model-inputs.html"><a href="model-inputs.html#input-structures"><i class="fa fa-check"></i><b>2.1</b> Input structures</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="model-inputs.html"><a href="model-inputs.html#inputstructuresmedfate"><i class="fa fa-check"></i><b>2.1.1</b> Input structures in medfate</a></li>
<li class="chapter" data-level="2.1.2" data-path="model-inputs.html"><a href="model-inputs.html#medfatelandstructures"><i class="fa fa-check"></i><b>2.1.2</b> Input structures in medfateland</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="model-inputs.html"><a href="model-inputs.html#topoinput"><i class="fa fa-check"></i><b>2.2</b> Latitude and topography</a></li>
<li class="chapter" data-level="2.3" data-path="model-inputs.html"><a href="model-inputs.html#soilinput"><i class="fa fa-check"></i><b>2.3</b> Soil description</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="model-inputs.html"><a href="model-inputs.html#soil-physical-properties"><i class="fa fa-check"></i><b>2.3.1</b> Soil physical properties</a></li>
<li class="chapter" data-level="2.3.2" data-path="model-inputs.html"><a href="model-inputs.html#waterretentioncurves"><i class="fa fa-check"></i><b>2.3.2</b> Water retention curves</a></li>
<li class="chapter" data-level="2.3.3" data-path="model-inputs.html"><a href="model-inputs.html#soilinitialization"><i class="fa fa-check"></i><b>2.3.3</b> Soil initialization</a></li>
<li class="chapter" data-level="2.3.4" data-path="model-inputs.html"><a href="model-inputs.html#watercontent"><i class="fa fa-check"></i><b>2.3.4</b> Water content and depth to saturation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="model-inputs.html"><a href="model-inputs.html#vegetationinput"><i class="fa fa-check"></i><b>2.4</b> Vegetation description</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="model-inputs.html"><a href="model-inputs.html#structural-attributes-of-woody-plant-cohorts"><i class="fa fa-check"></i><b>2.4.1</b> Structural attributes of woody plant cohorts</a></li>
<li class="chapter" data-level="2.4.2" data-path="model-inputs.html"><a href="model-inputs.html#structural-attributes-of-herbaceous-vegetation"><i class="fa fa-check"></i><b>2.4.2</b> Structural attributes of herbaceous vegetation</a></li>
<li class="chapter" data-level="2.4.3" data-path="model-inputs.html"><a href="model-inputs.html#leaf-area-index-of-the-forest-stand"><i class="fa fa-check"></i><b>2.4.3</b> Leaf area index of the forest stand</a></li>
<li class="chapter" data-level="2.4.4" data-path="model-inputs.html"><a href="model-inputs.html#forestobjects"><i class="fa fa-check"></i><b>2.4.4</b> Forest plot objects</a></li>
<li class="chapter" data-level="2.4.5" data-path="model-inputs.html"><a href="model-inputs.html#single-cohort-forests"><i class="fa fa-check"></i><b>2.4.5</b> Single-cohort forests</a></li>
<li class="chapter" data-level="2.4.6" data-path="model-inputs.html"><a href="model-inputs.html#leafdistribution"><i class="fa fa-check"></i><b>2.4.6</b> Vertical leaf distribution</a></li>
<li class="chapter" data-level="2.4.7" data-path="model-inputs.html"><a href="model-inputs.html#rootdistribution"><i class="fa fa-check"></i><b>2.4.7</b> Vertical root distribution</a></li>
<li class="chapter" data-level="2.4.8" data-path="model-inputs.html"><a href="model-inputs.html#plantwaterpools"><i class="fa fa-check"></i><b>2.4.8</b> Water pools and root horizontal distribution</a></li>
<li class="chapter" data-level="2.4.9" data-path="model-inputs.html"><a href="model-inputs.html#functionaltraits"><i class="fa fa-check"></i><b>2.4.9</b> Functional traits and vegetation initialization</a></li>
<li class="chapter" data-level="2.4.10" data-path="model-inputs.html"><a href="model-inputs.html#update-of-structural-variables-during-simulations"><i class="fa fa-check"></i><b>2.4.10</b> Update of structural variables during simulations</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="model-inputs.html"><a href="model-inputs.html#meteoinput"><i class="fa fa-check"></i><b>2.5</b> Metereological input</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="model-inputs.html"><a href="model-inputs.html#date-format"><i class="fa fa-check"></i><b>2.5.1</b> Date format</a></li>
<li class="chapter" data-level="2.5.2" data-path="model-inputs.html"><a href="model-inputs.html#required-weather-variables"><i class="fa fa-check"></i><b>2.5.2</b> Required weather variables</a></li>
<li class="chapter" data-level="2.5.3" data-path="model-inputs.html"><a href="model-inputs.html#optional-weather-variables"><i class="fa fa-check"></i><b>2.5.3</b> Optional weather variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="model-inputs.html"><a href="model-inputs.html#derived-weather-variables"><i class="fa fa-check"></i><b>2.5.4</b> Derived weather variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="model-inputs.html"><a href="model-inputs.html#controlparameters"><i class="fa fa-check"></i><b>2.6</b> Simulation control</a></li>
</ul></li>
<li class="part"><span><b>II Basic water balance modelling</b></span></li>
<li class="chapter" data-level="3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html"><i class="fa fa-check"></i><b>3</b> Basic water balance model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicdesign"><i class="fa fa-check"></i><b>3.1</b> Design principles</a></li>
<li class="chapter" data-level="3.2" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#statevariablesbasic"><i class="fa fa-check"></i><b>3.2</b> State variables</a></li>
<li class="chapter" data-level="3.3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#soilwaterbalance"><i class="fa fa-check"></i><b>3.3</b> Water balance</a></li>
<li class="chapter" data-level="3.4" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalancescheduling"><i class="fa fa-check"></i><b>3.4</b> Process scheduling</a></li>
<li class="chapter" data-level="3.5" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceinputsoutputs"><i class="fa fa-check"></i><b>3.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#soil-vegetation-and-meteorology"><i class="fa fa-check"></i><b>3.5.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="3.5.2" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwatervegetationparameters"><i class="fa fa-check"></i><b>3.5.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="3.5.3" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalancecontrol"><i class="fa fa-check"></i><b>3.5.3</b> Control parameters</a></li>
<li class="chapter" data-level="3.5.4" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceoutput"><i class="fa fa-check"></i><b>3.5.4</b> Model output</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basicwaterbalance.html"><a href="basicwaterbalance.html#basicwaterbalanceapplications"><i class="fa fa-check"></i><b>3.6</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="leafphenologylight.html"><a href="leafphenologylight.html"><i class="fa fa-check"></i><b>4</b> Leaf phenology and radiation extinction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenology"><i class="fa fa-check"></i><b>4.1</b> Leaf phenology</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="leafphenologylight.html"><a href="leafphenologylight.html#phenological-types-and-leaf-expanded-area"><i class="fa fa-check"></i><b>4.1.1</b> Phenological types and leaf expanded area</a></li>
<li class="chapter" data-level="4.1.2" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenobudburst"><i class="fa fa-check"></i><b>4.1.2</b> Bud burst and leaf unfolding</a></li>
<li class="chapter" data-level="4.1.3" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leafphenosenescence"><i class="fa fa-check"></i><b>4.1.3</b> Leaf senescence</a></li>
<li class="chapter" data-level="4.1.4" data-path="leafphenologylight.html"><a href="leafphenologylight.html#leaf-abscission"><i class="fa fa-check"></i><b>4.1.4</b> Leaf abscission</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="leafphenologylight.html"><a href="leafphenologylight.html#basiclightextinction"><i class="fa fa-check"></i><b>4.2</b> Radiation extinction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hydrology.html"><a href="hydrology.html"><i class="fa fa-check"></i><b>5</b> Forest hydrology</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hydrology.html"><a href="hydrology.html#precipitation"><i class="fa fa-check"></i><b>5.1</b> Snow and rainfall</a></li>
<li class="chapter" data-level="5.2" data-path="hydrology.html"><a href="hydrology.html#snowpack"><i class="fa fa-check"></i><b>5.2</b> Snow pack dynamics</a></li>
<li class="chapter" data-level="5.3" data-path="hydrology.html"><a href="hydrology.html#interception"><i class="fa fa-check"></i><b>5.3</b> Rainfall interception loss</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="hydrology.html"><a href="hydrology.html#gash-1995-model"><i class="fa fa-check"></i><b>5.3.1</b> Gash (1995) model</a></li>
<li class="chapter" data-level="5.3.2" data-path="hydrology.html"><a href="hydrology.html#liu-2001-model"><i class="fa fa-check"></i><b>5.3.2</b> Liu (2001) model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hydrology.html"><a href="hydrology.html#soilevaporation"><i class="fa fa-check"></i><b>5.4</b> Bare soil evaporation</a></li>
<li class="chapter" data-level="5.5" data-path="hydrology.html"><a href="hydrology.html#herbaceoustranspiration"><i class="fa fa-check"></i><b>5.5</b> Transpiration of the herbaceous layer</a></li>
<li class="chapter" data-level="5.6" data-path="hydrology.html"><a href="hydrology.html#infiltration"><i class="fa fa-check"></i><b>5.6</b> Infiltration</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="hydrology.html"><a href="hydrology.html#boughton-1989-model"><i class="fa fa-check"></i><b>5.6.1</b> Boughton (1989) model</a></li>
<li class="chapter" data-level="5.6.2" data-path="hydrology.html"><a href="hydrology.html#green-ampt-1911-model"><i class="fa fa-check"></i><b>5.6.2</b> Green-Ampt (1911) model</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="hydrology.html"><a href="hydrology.html#soilflows"><i class="fa fa-check"></i><b>5.7</b> Soil water flows</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="hydrology.html"><a href="hydrology.html#design-of-soil-water-flows"><i class="fa fa-check"></i><b>5.7.1</b> Design of soil water flows</a></li>
<li class="chapter" data-level="5.7.2" data-path="hydrology.html"><a href="hydrology.html#darcian-flow-and-richards-equation"><i class="fa fa-check"></i><b>5.7.2</b> Darcian flow and Richards equation</a></li>
<li class="chapter" data-level="5.7.3" data-path="hydrology.html"><a href="hydrology.html#hydraulic-properties-in-the-single-domain-model"><i class="fa fa-check"></i><b>5.7.3</b> Hydraulic properties in the single-domain model</a></li>
<li class="chapter" data-level="5.7.4" data-path="hydrology.html"><a href="hydrology.html#hydraulic-properties-in-the-dual-permeability-model"><i class="fa fa-check"></i><b>5.7.4</b> Hydraulic properties in the dual-permeability model</a></li>
<li class="chapter" data-level="5.7.5" data-path="hydrology.html"><a href="hydrology.html#finite-approximation-to-flows-in-the-soil-matrix"><i class="fa fa-check"></i><b>5.7.5</b> Finite approximation to flows in the soil matrix</a></li>
<li class="chapter" data-level="5.7.6" data-path="hydrology.html"><a href="hydrology.html#finite-approximation-to-flows-in-the-macropore-domain"><i class="fa fa-check"></i><b>5.7.6</b> Finite approximation to flows in the macropore domain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transpirationgranier.html"><a href="transpirationgranier.html"><i class="fa fa-check"></i><b>6</b> Woody plant transpiration, photosynthesis and water status</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-transpiration-and-photosynthesis"><i class="fa fa-check"></i><b>6.1</b> Plant transpiration and photosynthesis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#maximumtranspiration"><i class="fa fa-check"></i><b>6.1.1</b> Maximum transpiration</a></li>
<li class="chapter" data-level="6.1.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#actualtranspiration"><i class="fa fa-check"></i><b>6.1.2</b> Actual plant transpiration and plant water potential</a></li>
<li class="chapter" data-level="6.1.3" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-water-potential"><i class="fa fa-check"></i><b>6.1.3</b> Plant water potential</a></li>
<li class="chapter" data-level="6.1.4" data-path="transpirationgranier.html"><a href="transpirationgranier.html#minimum-transpiration"><i class="fa fa-check"></i><b>6.1.4</b> Minimum transpiration</a></li>
<li class="chapter" data-level="6.1.5" data-path="transpirationgranier.html"><a href="transpirationgranier.html#transpirationpools"><i class="fa fa-check"></i><b>6.1.5</b> Transpiration with water pools</a></li>
<li class="chapter" data-level="6.1.6" data-path="transpirationgranier.html"><a href="transpirationgranier.html#basicphotosynthesis"><i class="fa fa-check"></i><b>6.1.6</b> Plant photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#plant-drought-stress-and-cavitation"><i class="fa fa-check"></i><b>6.2</b> Plant drought stress and cavitation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="transpirationgranier.html"><a href="transpirationgranier.html#dailystressbasicwater"><i class="fa fa-check"></i><b>6.2.1</b> Daily drought stress</a></li>
<li class="chapter" data-level="6.2.2" data-path="transpirationgranier.html"><a href="transpirationgranier.html#irreversiblecavitation"><i class="fa fa-check"></i><b>6.2.2</b> Cavitation and hydraulic recovery</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Advanced water balance modelling</b></span></li>
<li class="chapter" data-level="7" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html"><i class="fa fa-check"></i><b>7</b> Advanced water balance model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#aboutsureau"><i class="fa fa-check"></i><b>7.1</b> About Sureau</a></li>
<li class="chapter" data-level="7.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advanceddesign"><i class="fa fa-check"></i><b>7.2</b> Design principles</a></li>
<li class="chapter" data-level="7.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#statevariablesadvanced"><i class="fa fa-check"></i><b>7.3</b> State variables</a></li>
<li class="chapter" data-level="7.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#waterenergybalances"><i class="fa fa-check"></i><b>7.4</b> Water and energy balances</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#water-balance"><i class="fa fa-check"></i><b>7.4.1</b> Water balance</a></li>
<li class="chapter" data-level="7.4.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#single-layer-canopy-energy-balance"><i class="fa fa-check"></i><b>7.4.2</b> Single-layer canopy energy balance</a></li>
<li class="chapter" data-level="7.4.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#multiple-layer-canopy-energy-balance"><i class="fa fa-check"></i><b>7.4.3</b> Multiple-layer canopy energy balance</a></li>
<li class="chapter" data-level="7.4.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#soil-energy-balance"><i class="fa fa-check"></i><b>7.4.4</b> Soil energy balance</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalancescheduling"><i class="fa fa-check"></i><b>7.5</b> Process scheduling</a></li>
<li class="chapter" data-level="7.6" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#inputs-and-outputs"><i class="fa fa-check"></i><b>7.6</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#soil-vegetation-and-meteorology-1"><i class="fa fa-check"></i><b>7.6.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="7.6.2" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwatervegetationparameters"><i class="fa fa-check"></i><b>7.6.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="7.6.3" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalancecontrol"><i class="fa fa-check"></i><b>7.6.3</b> Control parameters</a></li>
<li class="chapter" data-level="7.6.4" data-path="advancedwaterbalance.html"><a href="advancedwaterbalance.html#advancedwaterbalanceoutput"><i class="fa fa-check"></i><b>7.6.4</b> Model output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="subdailytemplight.html"><a href="subdailytemplight.html"><i class="fa fa-check"></i><b>8</b> Sub-daily atmospheric temperature and radiation variation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="subdailytemplight.html"><a href="subdailytemplight.html#above-canopy-air-temperature"><i class="fa fa-check"></i><b>8.1</b> Above-canopy air temperature</a></li>
<li class="chapter" data-level="8.2" data-path="subdailytemplight.html"><a href="subdailytemplight.html#directdiffuseSWR"><i class="fa fa-check"></i><b>8.2</b> Incoming diffuse and direct short-wave radiation</a></li>
<li class="chapter" data-level="8.3" data-path="subdailytemplight.html"><a href="subdailytemplight.html#longwaveatmradiation"><i class="fa fa-check"></i><b>8.3</b> Incoming long-wave radiation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="radiationbalance.html"><a href="radiationbalance.html"><i class="fa fa-check"></i><b>9</b> Radiation transfer</a>
<ul>
<li class="chapter" data-level="9.1" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiation"><i class="fa fa-check"></i><b>9.1</b> Short-wave radiation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="radiationbalance.html"><a href="radiationbalance.html#irradiancecanopy"><i class="fa fa-check"></i><b>9.1.1</b> Direct and diffuse irradiance across the canopy</a></li>
<li class="chapter" data-level="9.1.2" data-path="radiationbalance.html"><a href="radiationbalance.html#sunlitshadeleaves"><i class="fa fa-check"></i><b>9.1.2</b> Sunlit and shade leaves</a></li>
<li class="chapter" data-level="9.1.3" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiationcanopyabs"><i class="fa fa-check"></i><b>9.1.3</b> Short-wave radiation absorbed by canopy elements</a></li>
<li class="chapter" data-level="9.1.4" data-path="radiationbalance.html"><a href="radiationbalance.html#shortwaveradiationsoilabs"><i class="fa fa-check"></i><b>9.1.4</b> Short-wave radiation absorbed by the soil</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiation"><i class="fa fa-check"></i><b>9.2</b> Long-wave radiation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiationbalance"><i class="fa fa-check"></i><b>9.2.1</b> Long-wave radiation balance by canopy layers</a></li>
<li class="chapter" data-level="9.2.2" data-path="radiationbalance.html"><a href="radiationbalance.html#net-long-wave-radiation-of-the-whole-canopy-and-the-soil"><i class="fa fa-check"></i><b>9.2.2</b> Net long-wave radiation of the whole canopy and the soil</a></li>
<li class="chapter" data-level="9.2.3" data-path="radiationbalance.html"><a href="radiationbalance.html#longwaveradiationcohorts"><i class="fa fa-check"></i><b>9.2.3</b> Long-wave radiation balance by plant cohorts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="planthydraulics.html"><a href="planthydraulics.html"><i class="fa fa-check"></i><b>10</b> Plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="planthydraulics.html"><a href="planthydraulics.html#hydraulicnetworks"><i class="fa fa-check"></i><b>10.1</b> Hydraulic architecture</a></li>
<li class="chapter" data-level="10.2" data-path="planthydraulics.html"><a href="planthydraulics.html#vulnerabilitycurves"><i class="fa fa-check"></i><b>10.2</b> Vulnerability curves</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="planthydraulics.html"><a href="planthydraulics.html#xylem-vulnerability-curves"><i class="fa fa-check"></i><b>10.2.1</b> Xylem vulnerability curves</a></li>
<li class="chapter" data-level="10.2.2" data-path="planthydraulics.html"><a href="planthydraulics.html#rhizosphere-vulnerability-curve"><i class="fa fa-check"></i><b>10.2.2</b> Rhizosphere vulnerability curve</a></li>
<li class="chapter" data-level="10.2.3" data-path="planthydraulics.html"><a href="planthydraulics.html#sapviscosity"><i class="fa fa-check"></i><b>10.2.3</b> Xylem sap viscosity</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="planthydraulics.html"><a href="planthydraulics.html#plantwatercontent"><i class="fa fa-check"></i><b>10.3</b> Water content of plant tissues</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="planthydraulics.html"><a href="planthydraulics.html#pressurevolumecurves"><i class="fa fa-check"></i><b>10.3.1</b> Relative water content of symplasmic tissues</a></li>
<li class="chapter" data-level="10.3.2" data-path="planthydraulics.html"><a href="planthydraulics.html#relative-water-content-of-apoplastic-tissues"><i class="fa fa-check"></i><b>10.3.2</b> Relative water content of apoplastic tissues</a></li>
<li class="chapter" data-level="10.3.3" data-path="planthydraulics.html"><a href="planthydraulics.html#averagerelativewatercontent"><i class="fa fa-check"></i><b>10.3.3</b> Average relative water content of a compartment</a></li>
<li class="chapter" data-level="10.3.4" data-path="planthydraulics.html"><a href="planthydraulics.html#live-fuel-moisture-content"><i class="fa fa-check"></i><b>10.3.4</b> Live fuel moisture content</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="planthydraulics.html"><a href="planthydraulics.html#supplyfunctions"><i class="fa fa-check"></i><b>10.4</b> Sperry’s sub-model of plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-for-a-single-xylem-element"><i class="fa fa-check"></i><b>10.4.1</b> Supply function for a single xylem element</a></li>
<li class="chapter" data-level="10.4.2" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-two-elements-in-series"><i class="fa fa-check"></i><b>10.4.2</b> Supply function of two elements in series</a></li>
<li class="chapter" data-level="10.4.3" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-three-elements-in-series"><i class="fa fa-check"></i><b>10.4.3</b> Supply function of three elements in series</a></li>
<li class="chapter" data-level="10.4.4" data-path="planthydraulics.html"><a href="planthydraulics.html#supply-function-of-a-root-system"><i class="fa fa-check"></i><b>10.4.4</b> Supply function of a root system</a></li>
<li class="chapter" data-level="10.4.5" data-path="planthydraulics.html"><a href="planthydraulics.html#supplycontinuum"><i class="fa fa-check"></i><b>10.4.5</b> Supply function of the soil-plant continuum</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="planthydraulics.html"><a href="planthydraulics.html#hydraulicssureau"><i class="fa fa-check"></i><b>10.5</b> Sureau’s sub-model of plant hydraulics</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="planthydraulics.html"><a href="planthydraulics.html#constitutive-equations"><i class="fa fa-check"></i><b>10.5.1</b> Constitutive equations</a></li>
<li class="chapter" data-level="10.5.2" data-path="planthydraulics.html"><a href="planthydraulics.html#conductancessureau"><i class="fa fa-check"></i><b>10.5.2</b> Plant and soil conductances</a></li>
<li class="chapter" data-level="10.5.3" data-path="planthydraulics.html"><a href="planthydraulics.html#plant-capacitances"><i class="fa fa-check"></i><b>10.5.3</b> Plant capacitances</a></li>
<li class="chapter" data-level="10.5.4" data-path="planthydraulics.html"><a href="planthydraulics.html#cavitation-flows"><i class="fa fa-check"></i><b>10.5.4</b> Cavitation flows</a></li>
<li class="chapter" data-level="10.5.5" data-path="planthydraulics.html"><a href="planthydraulics.html#transpiration-flows"><i class="fa fa-check"></i><b>10.5.5</b> Transpiration flows</a></li>
<li class="chapter" data-level="10.5.6" data-path="planthydraulics.html"><a href="planthydraulics.html#numerical-scheme"><i class="fa fa-check"></i><b>10.5.6</b> Numerical scheme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html"><i class="fa fa-check"></i><b>11</b> Leaf/canopy photosynthesis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafenergybalancephoto"><i class="fa fa-check"></i><b>11.1</b> Leaf energy balance, gas exchange and photosynthesis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leaf-temperature"><i class="fa fa-check"></i><b>11.1.1</b> Leaf temperature</a></li>
<li class="chapter" data-level="11.1.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafVPD"><i class="fa fa-check"></i><b>11.1.2</b> Leaf vapor pressure deficit</a></li>
<li class="chapter" data-level="11.1.3" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafgasexchange"><i class="fa fa-check"></i><b>11.1.3</b> Leaf gas exchange</a></li>
<li class="chapter" data-level="11.1.4" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#leafphotosynthesis"><i class="fa fa-check"></i><b>11.1.4</b> Leaf photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#crownphotosynthesis"><i class="fa fa-check"></i><b>11.2</b> Crown/canopy photosynthesis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#multi-layer-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.1</b> Multi-layer canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.2" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#big-leaf-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.2</b> Big-leaf canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.3" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#sun-shade-canopy-photosynthesis-model"><i class="fa fa-check"></i><b>11.2.3</b> Sun-shade canopy photosynthesis model</a></li>
<li class="chapter" data-level="11.2.4" data-path="plantphotosynthesis.html"><a href="plantphotosynthesis.html#within-canopy-variation-in-environmental-conditions"><i class="fa fa-check"></i><b>11.2.4</b> Within-canopy variation in environmental conditions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html"><i class="fa fa-check"></i><b>12</b> Stomatal regulation, transpiration and photosynthesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#transpirationsperry"><i class="fa fa-check"></i><b>12.1</b> Stomatal regulation, transpiration and photosynthesis under Sperry’s sub-model</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#water-supply-function"><i class="fa fa-check"></i><b>12.1.1</b> Water supply function</a></li>
<li class="chapter" data-level="12.1.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#from-water-supply-to-sunlitshade-photosynthesis-functions"><i class="fa fa-check"></i><b>12.1.2</b> From water supply to sunlit/shade photosynthesis functions</a></li>
<li class="chapter" data-level="12.1.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatalregulation"><i class="fa fa-check"></i><b>12.1.3</b> Leaf stomatal regulation by profit maximization</a></li>
<li class="chapter" data-level="12.1.4" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#plant-level-transpiration-rates-and-plant-water-potentials"><i class="fa fa-check"></i><b>12.1.4</b> Plant-level transpiration rates and plant water potentials</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatal-regulation-transpiration-and-photosynthesis-under-sureaus-sub-model"><i class="fa fa-check"></i><b>12.2</b> Stomatal regulation, transpiration and photosynthesis under Sureau’s sub-model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#transpirationsureau"><i class="fa fa-check"></i><b>12.2.1</b> Transpiration flows</a></li>
<li class="chapter" data-level="12.2.2" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#cuticularconductancesureau"><i class="fa fa-check"></i><b>12.2.2</b> Cuticular conductances</a></li>
<li class="chapter" data-level="12.2.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#stomatalconductancesureau"><i class="fa fa-check"></i><b>12.2.3</b> Stomatal conductance</a></li>
<li class="chapter" data-level="12.2.4" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#photosynthesissureau"><i class="fa fa-check"></i><b>12.2.4</b> Photosynthesis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="transpirationsperrysureau.html"><a href="transpirationsperrysureau.html#scalingtranspirationphotosynthesis"><i class="fa fa-check"></i><b>12.3</b> Scaling of transpiration, soil water uptake and photosynthesis rates</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html"><i class="fa fa-check"></i><b>13</b> Closing energy balances</a>
<ul>
<li class="chapter" data-level="13.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#single-layer-canopy"><i class="fa fa-check"></i><b>13.1</b> Single-layer canopy</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#latent-heat"><i class="fa fa-check"></i><b>13.1.1</b> Latent heat</a></li>
<li class="chapter" data-level="13.1.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#convective-energy"><i class="fa fa-check"></i><b>13.1.2</b> Convective energy</a></li>
<li class="chapter" data-level="13.1.3" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#canopycapacitancetemperature"><i class="fa fa-check"></i><b>13.1.3</b> Canopy temperature changes</a></li>
<li class="chapter" data-level="13.1.4" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#soil-temperature-changes"><i class="fa fa-check"></i><b>13.1.4</b> Soil temperature changes</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#multi-layer-canopy"><i class="fa fa-check"></i><b>13.2</b> Multi-layer canopy</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#latent-heat-of-vaporization"><i class="fa fa-check"></i><b>13.2.1</b> Latent heat of vaporization</a></li>
<li class="chapter" data-level="13.2.2" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#sensible-heat-between-leaves-and-the-canopy-air-space"><i class="fa fa-check"></i><b>13.2.2</b> Sensible heat between leaves and the canopy air space</a></li>
<li class="chapter" data-level="13.2.3" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#turbulent-heat-exchange"><i class="fa fa-check"></i><b>13.2.3</b> Turbulent heat exchange</a></li>
<li class="chapter" data-level="13.2.4" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#canopy-and-soil-temperature-changes"><i class="fa fa-check"></i><b>13.2.4</b> Canopy and soil temperature changes</a></li>
<li class="chapter" data-level="13.2.5" data-path="closecanopysoilenergybalance.html"><a href="closecanopysoilenergybalance.html#within-canopy-changes-in-water-vapor-and-co_2"><i class="fa fa-check"></i><b>13.2.5</b> Within-canopy changes in water vapor and <span class="math inline">\(CO_2\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="daylevelresults.html"><a href="daylevelresults.html"><i class="fa fa-check"></i><b>14</b> Day-level results</a>
<ul>
<li class="chapter" data-level="14.1" data-path="daylevelresults.html"><a href="daylevelresults.html#daylevelphototransp"><i class="fa fa-check"></i><b>14.1</b> Photosynthesis and transpiration</a></li>
<li class="chapter" data-level="14.2" data-path="daylevelresults.html"><a href="daylevelresults.html#plant-water-potentials-and-relative-water-contents"><i class="fa fa-check"></i><b>14.2</b> Plant water potentials and relative water contents</a></li>
<li class="chapter" data-level="14.3" data-path="daylevelresults.html"><a href="daylevelresults.html#advanceddroughtstress"><i class="fa fa-check"></i><b>14.3</b> Plant drought stress</a></li>
<li class="chapter" data-level="14.4" data-path="daylevelresults.html"><a href="daylevelresults.html#cavitationRecovery"><i class="fa fa-check"></i><b>14.4</b> Cavitation and conduit refilling</a></li>
</ul></li>
<li class="part"><span><b>IV Forest growth modelling</b></span></li>
<li class="chapter" data-level="15" data-path="growthmodelling.html"><a href="growthmodelling.html"><i class="fa fa-check"></i><b>15</b> Forest growth model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="growthmodelling.html"><a href="growthmodelling.html#growthdesign"><i class="fa fa-check"></i><b>15.1</b> Design principles</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="growthmodelling.html"><a href="growthmodelling.html#overview"><i class="fa fa-check"></i><b>15.1.1</b> Overview</a></li>
<li class="chapter" data-level="15.1.2" data-path="growthmodelling.html"><a href="growthmodelling.html#carbon-compartments-transport-and-carbon-balance"><i class="fa fa-check"></i><b>15.1.2</b> Carbon compartments, transport and carbon balance</a></li>
<li class="chapter" data-level="15.1.3" data-path="growthmodelling.html"><a href="growthmodelling.html#tissue-growth-senescence-and-allocation"><i class="fa fa-check"></i><b>15.1.3</b> Tissue growth, senescence and allocation</a></li>
<li class="chapter" data-level="15.1.4" data-path="growthmodelling.html"><a href="growthmodelling.html#carbonwaterlinks"><i class="fa fa-check"></i><b>15.1.4</b> Coordination between water and carbon balances</a></li>
<li class="chapter" data-level="15.1.5" data-path="growthmodelling.html"><a href="growthmodelling.html#mortalitydesign"><i class="fa fa-check"></i><b>15.1.5</b> Plant mortality</a></li>
<li class="chapter" data-level="15.1.6" data-path="growthmodelling.html"><a href="growthmodelling.html#fireseveritydesign"><i class="fa fa-check"></i><b>15.1.6</b> Fire occurrence and severity</a></li>
<li class="chapter" data-level="15.1.7" data-path="growthmodelling.html"><a href="growthmodelling.html#tree-diameter-tree-height-and-shrub-cover-updates"><i class="fa fa-check"></i><b>15.1.7</b> Tree diameter, tree height and shrub cover updates</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="growthmodelling.html"><a href="growthmodelling.html#state-variables"><i class="fa fa-check"></i><b>15.2</b> State variables</a></li>
<li class="chapter" data-level="15.3" data-path="growthmodelling.html"><a href="growthmodelling.html#mass-and-energy-balances"><i class="fa fa-check"></i><b>15.3</b> Mass and energy balances</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="growthmodelling.html"><a href="growthmodelling.html#water-and-energy-balance"><i class="fa fa-check"></i><b>15.3.1</b> Water and energy balance</a></li>
<li class="chapter" data-level="15.3.2" data-path="growthmodelling.html"><a href="growthmodelling.html#labile-carbon-balance"><i class="fa fa-check"></i><b>15.3.2</b> Labile carbon balance</a></li>
<li class="chapter" data-level="15.3.3" data-path="growthmodelling.html"><a href="growthmodelling.html#biomass-balance"><i class="fa fa-check"></i><b>15.3.3</b> Biomass balance</a></li>
<li class="chapter" data-level="15.3.4" data-path="growthmodelling.html"><a href="growthmodelling.html#stand-level-carbon-balance"><i class="fa fa-check"></i><b>15.3.4</b> Stand-level carbon balance</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="growthmodelling.html"><a href="growthmodelling.html#growthscheduling"><i class="fa fa-check"></i><b>15.4</b> Process scheduling</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="growthmodelling.html"><a href="growthmodelling.html#regular-scheduling"><i class="fa fa-check"></i><b>15.4.1</b> Regular scheduling</a></li>
<li class="chapter" data-level="15.4.2" data-path="growthmodelling.html"><a href="growthmodelling.html#advanced-scheduling"><i class="fa fa-check"></i><b>15.4.2</b> Advanced scheduling</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="growthmodelling.html"><a href="growthmodelling.html#inputs-and-outputs-1"><i class="fa fa-check"></i><b>15.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="growthmodelling.html"><a href="growthmodelling.html#soil-vegetation-and-meteorology-2"><i class="fa fa-check"></i><b>15.5.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="15.5.2" data-path="growthmodelling.html"><a href="growthmodelling.html#growthvegetationparameters"><i class="fa fa-check"></i><b>15.5.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="15.5.3" data-path="growthmodelling.html"><a href="growthmodelling.html#forestgrowthcontrol"><i class="fa fa-check"></i><b>15.5.3</b> Control parameters</a></li>
<li class="chapter" data-level="15.5.4" data-path="growthmodelling.html"><a href="growthmodelling.html#forestgrowthoutput"><i class="fa fa-check"></i><b>15.5.4</b> Model output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html"><i class="fa fa-check"></i><b>16</b> Carbon pools and components of the carbon balance</a>
<ul>
<li class="chapter" data-level="16.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#estimationcarbonpools"><i class="fa fa-check"></i><b>16.1</b> Size of carbon pools</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#leaf-structural-metabolic-and-storage-biomass"><i class="fa fa-check"></i><b>16.1.1</b> Leaf structural, metabolic and storage biomass</a></li>
<li class="chapter" data-level="16.1.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#sapwood-structural-metabolic-and-storage-biomass"><i class="fa fa-check"></i><b>16.1.2</b> Sapwood structural, metabolic and storage biomass</a></li>
<li class="chapter" data-level="16.1.3" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#fine-root-area-and-biomass"><i class="fa fa-check"></i><b>16.1.3</b> Fine root area and biomass</a></li>
<li class="chapter" data-level="16.1.4" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#total-living-biomass"><i class="fa fa-check"></i><b>16.1.4</b> Total living biomass</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#carbonbalancecomponents"><i class="fa fa-check"></i><b>16.2</b> Components of labile carbon balance</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#gross-photosynthesis"><i class="fa fa-check"></i><b>16.2.1</b> Gross photosynthesis</a></li>
<li class="chapter" data-level="16.2.2" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#maintenance-respiration"><i class="fa fa-check"></i><b>16.2.2</b> Maintenance respiration</a></li>
<li class="chapter" data-level="16.2.3" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#growth-respiration"><i class="fa fa-check"></i><b>16.2.3</b> Growth respiration</a></li>
<li class="chapter" data-level="16.2.4" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#phloemtransport"><i class="fa fa-check"></i><b>16.2.4</b> Phloem transport</a></li>
<li class="chapter" data-level="16.2.5" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#sugarstarchdynamics"><i class="fa fa-check"></i><b>16.2.5</b> Sugar-starch dynamics</a></li>
<li class="chapter" data-level="16.2.6" data-path="carbonpoolsbalance.html"><a href="carbonpoolsbalance.html#root-exudation"><i class="fa fa-check"></i><b>16.2.6</b> Root exudation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html"><i class="fa fa-check"></i><b>17</b> Growth, senescence and mortality</a>
<ul>
<li class="chapter" data-level="17.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#growth"><i class="fa fa-check"></i><b>17.1</b> Growth</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#temperature-and-turgor-sink-limitations"><i class="fa fa-check"></i><b>17.1.1</b> Temperature and turgor sink limitations</a></li>
<li class="chapter" data-level="17.1.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#leafgrowth"><i class="fa fa-check"></i><b>17.1.2</b> Leaf growth</a></li>
<li class="chapter" data-level="17.1.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#sapwoodgrowth"><i class="fa fa-check"></i><b>17.1.3</b> Sapwood growth</a></li>
<li class="chapter" data-level="17.1.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#finerootgrowth"><i class="fa fa-check"></i><b>17.1.4</b> Fine root growth</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#senescence"><i class="fa fa-check"></i><b>17.2</b> Senescence</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#leafsenescence"><i class="fa fa-check"></i><b>17.2.1</b> Leaf senescence and cavitation effects on leaves and buds</a></li>
<li class="chapter" data-level="17.2.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#sapwoodsenescence"><i class="fa fa-check"></i><b>17.2.2</b> Sapwood senescence</a></li>
<li class="chapter" data-level="17.2.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#finerootsenescence"><i class="fa fa-check"></i><b>17.2.3</b> Fine root senescence</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#update-of-plant-traits-and-allocation-targets"><i class="fa fa-check"></i><b>17.3</b> Update of plant traits and allocation targets</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#updateplanttraits"><i class="fa fa-check"></i><b>17.3.1</b> Plant traits</a></li>
<li class="chapter" data-level="17.3.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#updateallocationtargets"><i class="fa fa-check"></i><b>17.3.2</b> Leaf area and fine root biomass targets</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#plantmortality"><i class="fa fa-check"></i><b>17.4</b> Plant mortality</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#selfthinning"><i class="fa fa-check"></i><b>17.4.1</b> Self-thinning of small trees</a></li>
<li class="chapter" data-level="17.4.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#basalmortality"><i class="fa fa-check"></i><b>17.4.2</b> Basal mortality rates</a></li>
<li class="chapter" data-level="17.4.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#starvationmortality"><i class="fa fa-check"></i><b>17.4.3</b> Mortality due to starvation</a></li>
<li class="chapter" data-level="17.4.4" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#dessicationmortality"><i class="fa fa-check"></i><b>17.4.4</b> Mortality due to dessication</a></li>
<li class="chapter" data-level="17.4.5" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#overall-mortality-probability"><i class="fa fa-check"></i><b>17.4.5</b> Overall mortality probability</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#fireseverity"><i class="fa fa-check"></i><b>17.5</b> Fire severity</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#plume-temperature-distribution"><i class="fa fa-check"></i><b>17.5.1</b> Plume temperature distribution</a></li>
<li class="chapter" data-level="17.5.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#foliage-and-crown-bud-necrosis"><i class="fa fa-check"></i><b>17.5.2</b> Foliage and crown bud necrosis</a></li>
<li class="chapter" data-level="17.5.3" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#cambium-necrosis"><i class="fa fa-check"></i><b>17.5.3</b> Cambium necrosis</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#structuralupdate"><i class="fa fa-check"></i><b>17.6</b> Update of structural variables</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#tree-diameter-height-and-crown-ratio"><i class="fa fa-check"></i><b>17.6.1</b> Tree diameter, height and crown ratio</a></li>
<li class="chapter" data-level="17.6.2" data-path="growthsenescencemortality.html"><a href="growthsenescencemortality.html#shrub-height-and-cover"><i class="fa fa-check"></i><b>17.6.2</b> Shrub height and cover</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Forest dynamics modelling</b></span></li>
<li class="chapter" data-level="18" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html"><i class="fa fa-check"></i><b>18</b> Forest dynamics model</a>
<ul>
<li class="chapter" data-level="18.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#design-principles"><i class="fa fa-check"></i><b>18.1</b> Design principles</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#recruitment-from-seeds"><i class="fa fa-check"></i><b>18.1.1</b> Recruitment from seeds</a></li>
<li class="chapter" data-level="18.1.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#resprouting"><i class="fa fa-check"></i><b>18.1.2</b> Resprouting</a></li>
<li class="chapter" data-level="18.1.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forest-management"><i class="fa fa-check"></i><b>18.1.3</b> Forest management</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#state-variables-1"><i class="fa fa-check"></i><b>18.2</b> State variables</a></li>
<li class="chapter" data-level="18.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#process-scheduling"><i class="fa fa-check"></i><b>18.3</b> Process scheduling</a></li>
<li class="chapter" data-level="18.4" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#inputs-and-outputs-2"><i class="fa fa-check"></i><b>18.4</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#soil-vegetation-and-meteorology-3"><i class="fa fa-check"></i><b>18.4.1</b> Soil, vegetation and meteorology</a></li>
<li class="chapter" data-level="18.4.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#vegetation-functional-parameters"><i class="fa fa-check"></i><b>18.4.2</b> Vegetation functional parameters</a></li>
<li class="chapter" data-level="18.4.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forestdynamicscontrol"><i class="fa fa-check"></i><b>18.4.3</b> Control parameters</a></li>
<li class="chapter" data-level="18.4.4" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#forestdynamicsoutput"><i class="fa fa-check"></i><b>18.4.4</b> Model output</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#process-details"><i class="fa fa-check"></i><b>18.5</b> Process details</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#seedbankdynamics"><i class="fa fa-check"></i><b>18.5.1</b> Seed production and seed bank dynamics</a></li>
<li class="chapter" data-level="18.5.2" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#recruitment-from-seeds-1"><i class="fa fa-check"></i><b>18.5.2</b> Recruitment from seeds</a></li>
<li class="chapter" data-level="18.5.3" data-path="dynamicsmodelling.html"><a href="dynamicsmodelling.html#resprouting-1"><i class="fa fa-check"></i><b>18.5.3</b> Resprouting</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Landscape/regional modelling</b></span></li>
<li class="chapter" data-level="19" data-path="watershedhydrology.html"><a href="watershedhydrology.html"><i class="fa fa-check"></i><b>19</b> Watershed hydrology</a>
<ul>
<li class="chapter" data-level="19.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#design-principles-1"><i class="fa fa-check"></i><b>19.1</b> Design principles</a></li>
<li class="chapter" data-level="19.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#statevariableswatershed"><i class="fa fa-check"></i><b>19.2</b> State variables</a></li>
<li class="chapter" data-level="19.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalance"><i class="fa fa-check"></i><b>19.3</b> Water balance</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#cell-level-water-balance"><i class="fa fa-check"></i><b>19.3.1</b> Cell level water balance</a></li>
<li class="chapter" data-level="19.3.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershed-water-balance"><i class="fa fa-check"></i><b>19.3.2</b> Watershed water balance</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancescheduling"><i class="fa fa-check"></i><b>19.4</b> Process scheduling</a></li>
<li class="chapter" data-level="19.5" data-path="watershedhydrology.html"><a href="watershedhydrology.html#inputs-and-outputs-3"><i class="fa fa-check"></i><b>19.5</b> Inputs and outputs</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#gridded-inputs"><i class="fa fa-check"></i><b>19.5.1</b> Gridded inputs</a></li>
<li class="chapter" data-level="19.5.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershed-meteorology-input"><i class="fa fa-check"></i><b>19.5.2</b> Watershed meteorology input</a></li>
<li class="chapter" data-level="19.5.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancecontrol"><i class="fa fa-check"></i><b>19.5.3</b> Watershed hydraulic control parameters</a></li>
<li class="chapter" data-level="19.5.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalanceoutput"><i class="fa fa-check"></i><b>19.5.4</b> Model outputs</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedbalancedetails"><i class="fa fa-check"></i><b>19.6</b> Process details</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="watershedhydrology.html"><a href="watershedhydrology.html#subsurfaceflows"><i class="fa fa-check"></i><b>19.6.1</b> Soil and groundwater lateral fluxes</a></li>
<li class="chapter" data-level="19.6.2" data-path="watershedhydrology.html"><a href="watershedhydrology.html#overlandflows"><i class="fa fa-check"></i><b>19.6.2</b> Overland runoff</a></li>
<li class="chapter" data-level="19.6.3" data-path="watershedhydrology.html"><a href="watershedhydrology.html#watershedexport"><i class="fa fa-check"></i><b>19.6.3</b> Watershed surface runoff</a></li>
<li class="chapter" data-level="19.6.4" data-path="watershedhydrology.html"><a href="watershedhydrology.html#deepaquiferloss"><i class="fa fa-check"></i><b>19.6.4</b> Losses towards a deeper aquifer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="seeddispersal.html"><a href="seeddispersal.html"><i class="fa fa-check"></i><b>20</b> Seed dispersal</a>
<ul>
<li class="chapter" data-level="20.1" data-path="seeddispersal.html"><a href="seeddispersal.html#design-principles-2"><i class="fa fa-check"></i><b>20.1</b> Design principles</a></li>
<li class="chapter" data-level="20.2" data-path="seeddispersal.html"><a href="seeddispersal.html#process-scheduling-1"><i class="fa fa-check"></i><b>20.2</b> Process scheduling</a></li>
<li class="chapter" data-level="20.3" data-path="seeddispersal.html"><a href="seeddispersal.html#process-details-1"><i class="fa fa-check"></i><b>20.3</b> Process details</a></li>
</ul></li>
<li class="part"><span><b>VII Static modules</b></span></li>
<li class="chapter" data-level="21" data-path="allometricmodels.html"><a href="allometricmodels.html"><i class="fa fa-check"></i><b>21</b> Allometric models</a>
<ul>
<li class="chapter" data-level="21.1" data-path="allometricmodels.html"><a href="allometricmodels.html#input-data"><i class="fa fa-check"></i><b>21.1</b> Input data</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="allometricmodels.html"><a href="allometricmodels.html#forest-plot-data"><i class="fa fa-check"></i><b>21.1.1</b> Forest plot data</a></li>
<li class="chapter" data-level="21.1.2" data-path="allometricmodels.html"><a href="allometricmodels.html#species-parameters"><i class="fa fa-check"></i><b>21.1.2</b> Species parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="allometricmodels.html"><a href="allometricmodels.html#allometric-relationships"><i class="fa fa-check"></i><b>21.2</b> Allometric relationships</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="allometricmodels.html"><a href="allometricmodels.html#leaf-biomass"><i class="fa fa-check"></i><b>21.2.1</b> Leaf biomass</a></li>
<li class="chapter" data-level="21.2.2" data-path="allometricmodels.html"><a href="allometricmodels.html#leaf-area-and-lai"><i class="fa fa-check"></i><b>21.2.2</b> Leaf area and LAI</a></li>
<li class="chapter" data-level="21.2.3" data-path="allometricmodels.html"><a href="allometricmodels.html#crownbaseheight"><i class="fa fa-check"></i><b>21.2.3</b> Crown vertical dimensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="post-simulation-procedures.html"><a href="post-simulation-procedures.html"><i class="fa fa-check"></i><b>22</b> Post-simulation procedures</a>
<ul>
<li class="chapter" data-level="22.1" data-path="post-simulation-procedures.html"><a href="post-simulation-procedures.html#water-use-efficiency"><i class="fa fa-check"></i><b>22.1</b> Water use efficiency</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="windextinction.html"><a href="windextinction.html"><i class="fa fa-check"></i><b>23</b> Wind extinction</a>
<ul>
<li class="chapter" data-level="23.1" data-path="windextinction.html"><a href="windextinction.html#wind-speed-at-the-top-of-the-canopy"><i class="fa fa-check"></i><b>23.1</b> Wind speed at the top of the canopy</a></li>
<li class="chapter" data-level="23.2" data-path="windextinction.html"><a href="windextinction.html#windextinctionprofile"><i class="fa fa-check"></i><b>23.2</b> Wind extinction profile</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html"><i class="fa fa-check"></i><b>24</b> Fuel characteristics and fire behaviour</a>
<ul>
<li class="chapter" data-level="24.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#overview-1"><i class="fa fa-check"></i><b>24.1</b> Overview</a></li>
<li class="chapter" data-level="24.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#input-data-1"><i class="fa fa-check"></i><b>24.2</b> Input data</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#forest-plot-data-1"><i class="fa fa-check"></i><b>24.2.1</b> Forest plot data</a></li>
<li class="chapter" data-level="24.2.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#species-parameters-1"><i class="fa fa-check"></i><b>24.2.2</b> Species parameters</a></li>
<li class="chapter" data-level="24.2.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#other-inputs"><i class="fa fa-check"></i><b>24.2.3</b> Other inputs</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-characteristics"><i class="fa fa-check"></i><b>24.3</b> Fuel characteristics</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-strata"><i class="fa fa-check"></i><b>24.3.1</b> Fuel strata</a></li>
<li class="chapter" data-level="24.3.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#cohort-fuel-loading"><i class="fa fa-check"></i><b>24.3.2</b> Cohort fuel loading</a></li>
<li class="chapter" data-level="24.3.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#vertical-distribution-of-cohort-fuels"><i class="fa fa-check"></i><b>24.3.3</b> Vertical distribution of cohort fuels</a></li>
<li class="chapter" data-level="24.3.4" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-bulk-density-profile"><i class="fa fa-check"></i><b>24.3.4</b> Fuel bulk density profile</a></li>
<li class="chapter" data-level="24.3.5" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fuel-loading-w-and-fuel-depth-delta"><i class="fa fa-check"></i><b>24.3.5</b> Fuel loading (<span class="math inline">\(w\)</span>) and fuel depth (<span class="math inline">\(\delta\)</span>)</a></li>
<li class="chapter" data-level="24.3.6" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#other-fuel-characteristics"><i class="fa fa-check"></i><b>24.3.6</b> Other fuel characteristics</a></li>
<li class="chapter" data-level="24.3.7" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#unit-conversion-of-fuel-characteristics"><i class="fa fa-check"></i><b>24.3.7</b> Unit conversion of fuel characteristics</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-fire-behavior"><i class="fa fa-check"></i><b>24.4</b> Surface fire behavior</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-rate-of-spread-r"><i class="fa fa-check"></i><b>24.4.1</b> Surface rate of spread (<span class="math inline">\(R\)</span>)</a></li>
<li class="chapter" data-level="24.4.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#heat-sink-q"><i class="fa fa-check"></i><b>24.4.2</b> Heat sink (<span class="math inline">\(q\)</span>)</a></li>
<li class="chapter" data-level="24.4.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fireline-intensity-i_b-and-flame-length-fl"><i class="fa fa-check"></i><b>24.4.3</b> Fireline intensity (<span class="math inline">\(I_B\)</span>) and flame length (<span class="math inline">\(FL\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#crown-fire-behavior"><i class="fa fa-check"></i><b>24.5</b> Crown fire behavior</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#canopy-reaction-intensity-i_r-ca"><i class="fa fa-check"></i><b>24.5.1</b> Canopy reaction intensity (<span class="math inline">\(I_{R, ca}\)</span>)</a></li>
<li class="chapter" data-level="24.5.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#canopy-heat-sink-q_ca"><i class="fa fa-check"></i><b>24.5.2</b> Canopy heat sink (<span class="math inline">\(q_{ca}\)</span>)</a></li>
<li class="chapter" data-level="24.5.3" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fireline-intensity-i_bcrown-and-flame-length-fl_crown"><i class="fa fa-check"></i><b>24.5.3</b> Fireline intensity (<span class="math inline">\(I_{B,crown}\)</span>) and flame length (<span class="math inline">\(FL_{crown}\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#fire-potentials"><i class="fa fa-check"></i><b>24.6</b> Fire potentials</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#surface-fire-behavior-potentials"><i class="fa fa-check"></i><b>24.6.1</b> Surface fire behavior potentials</a></li>
<li class="chapter" data-level="24.6.2" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#crown-fire-behavior-potentials"><i class="fa fa-check"></i><b>24.6.2</b> Crown fire behavior potentials</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="fuelandfirebehavior.html"><a href="fuelandfirebehavior.html#unit-conversion-of-outputs"><i class="fa fa-check"></i><b>24.7</b> Unit conversion of outputs</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="modelparametrization.html"><a href="modelparametrization.html"><i class="fa fa-check"></i><b>A</b> Inbuilt parameter estimation</a>
<ul>
<li class="chapter" data-level="A.1" data-path="modelparametrization.html"><a href="modelparametrization.html#introduction"><i class="fa fa-check"></i><b>A.1</b> Introduction</a></li>
<li class="chapter" data-level="A.2" data-path="modelparametrization.html"><a href="modelparametrization.html#strict-scaled-and-imputable-parameters"><i class="fa fa-check"></i><b>A.2</b> Strict, scaled and imputable parameters</a></li>
<li class="chapter" data-level="A.3" data-path="modelparametrization.html"><a href="modelparametrization.html#imputation-of-missing-values"><i class="fa fa-check"></i><b>A.3</b> Imputation of missing values</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRootingDepth"><i class="fa fa-check"></i><b>A.3.1</b> Rooting depth</a></li>
<li class="chapter" data-level="A.3.2" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationShrubAllometries"><i class="fa fa-check"></i><b>A.3.2</b> Shrub allometric coefficients</a></li>
<li class="chapter" data-level="A.3.3" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationTreeAllometries"><i class="fa fa-check"></i><b>A.3.3</b> Tree allometric coefficients</a></li>
<li class="chapter" data-level="A.3.4" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationLWSLA"><i class="fa fa-check"></i><b>A.3.4</b> Leaf width, specific leaf area and fine foliar ratio</a></li>
<li class="chapter" data-level="A.3.5" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationtissuedensity"><i class="fa fa-check"></i><b>A.3.5</b> Tissue density</a></li>
<li class="chapter" data-level="A.3.6" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationSRLRLD"><i class="fa fa-check"></i><b>A.3.6</b> Specific root length and root length density</a></li>
<li class="chapter" data-level="A.3.7" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationAl2As"><i class="fa fa-check"></i><b>A.3.7</b> Huber value and ratio of conduits to sapwood</a></li>
<li class="chapter" data-level="A.3.8" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationAr2Al"><i class="fa fa-check"></i><b>A.3.8</b> Fine root to leaf area ratio</a></li>
<li class="chapter" data-level="A.3.9" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationphenology"><i class="fa fa-check"></i><b>A.3.9</b> Leaf phenology</a></li>
<li class="chapter" data-level="A.3.10" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationtranspwue"><i class="fa fa-check"></i><b>A.3.10</b> Basic transpiration and water-use efficiency</a></li>
<li class="chapter" data-level="A.3.11" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationLEWI"><i class="fa fa-check"></i><b>A.3.11</b> Radiation balance and water interception</a></li>
<li class="chapter" data-level="A.3.12" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationstomatalconductance"><i class="fa fa-check"></i><b>A.3.12</b> Stomatal conductance</a></li>
<li class="chapter" data-level="A.3.13" data-path="modelparametrization.html"><a href="modelparametrization.html#inputationPV"><i class="fa fa-check"></i><b>A.3.13</b> Pressure-volume curves</a></li>
<li class="chapter" data-level="A.3.14" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationKstemKroot"><i class="fa fa-check"></i><b>A.3.14</b> Stem and root maximum hydraulic conductivity</a></li>
<li class="chapter" data-level="A.3.15" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationkleaf"><i class="fa fa-check"></i><b>A.3.15</b> Leaf maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.3.16" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationVCs"><i class="fa fa-check"></i><b>A.3.16</b> Xylem vulnerability</a></li>
<li class="chapter" data-level="A.3.17" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationphotosynthesis"><i class="fa fa-check"></i><b>A.3.17</b> Photosynthesis rates</a></li>
<li class="chapter" data-level="A.3.18" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRER"><i class="fa fa-check"></i><b>A.3.18</b> Maintenance respiration rates</a></li>
<li class="chapter" data-level="A.3.19" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRGR"><i class="fa fa-check"></i><b>A.3.19</b> Relative growth rates</a></li>
<li class="chapter" data-level="A.3.20" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationSR"><i class="fa fa-check"></i><b>A.3.20</b> Senescence rates</a></li>
<li class="chapter" data-level="A.3.21" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationRSSG"><i class="fa fa-check"></i><b>A.3.21</b> Relative starch for sapwood growth</a></li>
<li class="chapter" data-level="A.3.22" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationCwood"><i class="fa fa-check"></i><b>A.3.22</b> Wood carbon</a></li>
<li class="chapter" data-level="A.3.23" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationMortalityBaseline"><i class="fa fa-check"></i><b>A.3.23</b> Mortality baseline rate</a></li>
<li class="chapter" data-level="A.3.24" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationrecruitment"><i class="fa fa-check"></i><b>A.3.24</b> Recruitment</a></li>
<li class="chapter" data-level="A.3.25" data-path="modelparametrization.html"><a href="modelparametrization.html#imputationflammability"><i class="fa fa-check"></i><b>A.3.25</b> Flammability</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="modelparametrization.html"><a href="modelparametrization.html#scaling-size-related-parameters"><i class="fa fa-check"></i><b>A.4</b> Scaling size-related parameters</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkstem"><i class="fa fa-check"></i><b>A.4.1</b> Stem xylem maximum conductance</a></li>
<li class="chapter" data-level="A.4.2" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkleaf"><i class="fa fa-check"></i><b>A.4.2</b> Leaf maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.3" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkroot"><i class="fa fa-check"></i><b>A.4.3</b> Root xylem maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.4" data-path="modelparametrization.html"><a href="modelparametrization.html#scalingkrhizo"><i class="fa fa-check"></i><b>A.4.4</b> Rhizosphere maximum hydraulic conductance</a></li>
<li class="chapter" data-level="A.4.5" data-path="modelparametrization.html"><a href="modelparametrization.html#plantwaterstoragecapacity"><i class="fa fa-check"></i><b>A.4.5</b> Plant water storage capacity</a></li>
<li class="chapter" data-level="A.4.6" data-path="modelparametrization.html"><a href="modelparametrization.html#horizontalrootoverlap"><i class="fa fa-check"></i><b>A.4.6</b> Horizontal root overlap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="symbols.html"><a href="symbols.html"><i class="fa fa-check"></i><b>B</b> Symbols</a>
<ul>
<li class="chapter" data-level="B.1" data-path="symbols.html"><a href="symbols.html#dimensions"><i class="fa fa-check"></i><b>B.1</b> Dimensions</a></li>
<li class="chapter" data-level="B.2" data-path="symbols.html"><a href="symbols.html#soils"><i class="fa fa-check"></i><b>B.2</b> Soils</a></li>
<li class="chapter" data-level="B.3" data-path="symbols.html"><a href="symbols.html#plantleaf-classification"><i class="fa fa-check"></i><b>B.3</b> Plant/leaf classification</a></li>
<li class="chapter" data-level="B.4" data-path="symbols.html"><a href="symbols.html#vegetation"><i class="fa fa-check"></i><b>B.4</b> Vegetation</a></li>
<li class="chapter" data-level="B.5" data-path="symbols.html"><a href="symbols.html#meteorology"><i class="fa fa-check"></i><b>B.5</b> Meteorology</a></li>
<li class="chapter" data-level="B.6" data-path="symbols.html"><a href="symbols.html#anatomy"><i class="fa fa-check"></i><b>B.6</b> Anatomy</a></li>
<li class="chapter" data-level="B.7" data-path="symbols.html"><a href="symbols.html#radiation"><i class="fa fa-check"></i><b>B.7</b> Radiation</a></li>
<li class="chapter" data-level="B.8" data-path="symbols.html"><a href="symbols.html#water-balance-1"><i class="fa fa-check"></i><b>B.8</b> Water balance</a></li>
<li class="chapter" data-level="B.9" data-path="symbols.html"><a href="symbols.html#energy-balance"><i class="fa fa-check"></i><b>B.9</b> Energy balance</a></li>
<li class="chapter" data-level="B.10" data-path="symbols.html"><a href="symbols.html#forest-hydrology"><i class="fa fa-check"></i><b>B.10</b> Forest hydrology</a></li>
<li class="chapter" data-level="B.11" data-path="symbols.html"><a href="symbols.html#plant-hydraulics"><i class="fa fa-check"></i><b>B.11</b> Plant hydraulics</a></li>
<li class="chapter" data-level="B.12" data-path="symbols.html"><a href="symbols.html#photosynthesis"><i class="fa fa-check"></i><b>B.12</b> Photosynthesis</a></li>
<li class="chapter" data-level="B.13" data-path="symbols.html"><a href="symbols.html#plant-water-content"><i class="fa fa-check"></i><b>B.13</b> Plant water content</a></li>
<li class="chapter" data-level="B.14" data-path="symbols.html"><a href="symbols.html#stomatal-regulation"><i class="fa fa-check"></i><b>B.14</b> Stomatal regulation</a></li>
<li class="chapter" data-level="B.15" data-path="symbols.html"><a href="symbols.html#carbon-pools"><i class="fa fa-check"></i><b>B.15</b> Carbon pools</a></li>
<li class="chapter" data-level="B.16" data-path="symbols.html"><a href="symbols.html#carbon-balance"><i class="fa fa-check"></i><b>B.16</b> Carbon balance</a></li>
<li class="chapter" data-level="B.17" data-path="symbols.html"><a href="symbols.html#growth-senescence-and-mortality"><i class="fa fa-check"></i><b>B.17</b> Growth, senescence and mortality</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The medfate reference book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-inputs" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Model inputs<a href="model-inputs.html#model-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter describes the inputs required by simulation models of <strong>medfate</strong> and <strong>medfateland</strong> packages. First, we describe the R structures required for the two packages. Then, we provide the details for four different kinds of inputs:</p>
<ol style="list-style-type: decimal">
<li><em>Vegetation existing in the forest stand</em>. This information should be available at a level of detail appropriate for the model design, which in our case includes not only species composition and/or structure, but also functional parameters of woody plants. Vegetation structure is considered static in <code>spwb()</code> calls, but becomes dynamic in calls to <code>growth()</code> or <code>fordyn()</code>. Hence, in these functions the input vegetation describes the starting point.</li>
<li><em>Information on the physical structure of soil</em>. Soil information is also required but, unlike vegetation, the soil physical structure is considered static.</li>
<li><em>Climatic forcing</em>. Daily weather series are always required, defining the temporal extent of the simulation and the temporal variation of environmental conditions in which physical and biological processes occur.</li>
<li><em>Topographic information and geographic location</em>. Topography and latitude are also required, because internal calculations of some physical variables require them.</li>
</ol>
<p>The last section (<a href="model-inputs.html#controlparameters">2.6</a>) describes additional input parameters that are used to specify global options of simulation functions.</p>
<p>Since preparing inputs for simulations can be daunting for most users, package <a href="https://github.com/emf-creaf/medfateutils"><strong>medfateutils</strong></a> provides a set of utility functions aimed at facilitating the preparation of vegetation and soil inputs, whereas package <a href="https://github.com/emf-creaf/meteoland"><strong>meteoland</strong></a> provides functions to assess daily weather over landscapes.</p>
<div id="input-structures" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Input structures<a href="model-inputs.html#input-structures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="inputstructuresmedfate" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Input structures in medfate<a href="model-inputs.html#inputstructuresmedfate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Package <strong>medfate</strong> deals with simulations at stand level and, hence, the data structures defined in the package are meant to encapsulate information about a target forest stands and the properties of the soil where it grows:</p>
<ul>
<li>S3 class <code>soil</code> is a list that is initialized using soil physical properties, but the object includes also soil parameters and state variables. Soil objects are described in subsection <a href="model-inputs.html#soilinitialization">2.3.3</a>.</li>
<li>S3 class <code>forest</code> is a list of forest inventory data (i.e. mainly tree and shrub measurements, but can include herbaceous vegetation) corresponding to a single forest stand. Forest plot objects are described in subsection <a href="model-inputs.html#forestobjects">2.4.4</a>.</li>
<li>S3 classes <code>spwbInput</code> and <code>growthInput</code> are lists containing all the vegetation parameters and state variables necessary to run water-balance simulations (function <code>spwb()</code> and alike) and forest growth simulations (function <code>growth()</code> and alike). Objects of classes <code>spwbInput</code> and <code>growthInput</code> are created using functions whose input includes a <code>forest</code> object and a <code>soil</code> object.</li>
</ul>
<p>The figure below (Fig. <a href="model-inputs.html#fig:inputworkflow">2.1</a>) can be used to illustrate the workflow of soil/forest input creation for the main simulation functions in <strong>medfate</strong>. Note the different inputs in the case of <code>fordyn()</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:inputworkflow"></span>
<img src="figures/input_workflow.png" alt="Schematic workflow of input creation for simulation functions in medfate" width="100%" />
<p class="caption">
Figure 2.1: Schematic workflow of input creation for simulation functions in medfate
</p>
</div>
</div>
<div id="medfatelandstructures" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Input structures in medfateland<a href="model-inputs.html#medfatelandstructures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Spatial information for <strong>medfateland</strong> needs to be provided in <code>sf</code> objects (i.e. data frames with geometry, see package <a href="https://cran.r-project.org/package=sf"><strong>sf</strong></a>), whose actual columns required depend on the simulation function to be used, as described in the following table.</p>
<table>
<colgroup>
<col width="12%" />
<col width="34%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th>Column</th>
<th>Description</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>geom</code></td>
<td>Spatial geometries (points, polygons, …)</td>
<td>Always required</td>
</tr>
<tr class="even">
<td><code>id</code></td>
<td>Stand identifiers</td>
<td>Required for <code>*_spatial()</code>, <code>*_spatial_day()</code> and <code>fordyn_scenario()</code></td>
</tr>
<tr class="odd">
<td><code>elevation</code></td>
<td>Elevation values above sea level (in m)</td>
<td>Always required</td>
</tr>
<tr class="even">
<td><code>slope</code></td>
<td>Slope values (in degrees)</td>
<td>Always required</td>
</tr>
<tr class="odd">
<td><code>aspect</code></td>
<td>Aspect values (in degrees)</td>
<td>Always required</td>
</tr>
<tr class="even">
<td><code>land_cover_type</code></td>
<td>Land cover type: <em>wildland</em>, <em>agriculture</em>, <em>rock</em>, <em>artificial</em> or <em>water</em></td>
<td>Required for <code>*_land()</code>, optional for <code>*_spatial()</code> and <code>*_spatial_day()</code></td>
</tr>
<tr class="odd">
<td><code>forest</code></td>
<td>Objects of class <code>forest</code></td>
<td>Always required</td>
</tr>
<tr class="even">
<td><code>soil</code></td>
<td>Objects of class <code>soil</code></td>
<td>Always required</td>
</tr>
<tr class="odd">
<td><code>state</code></td>
<td>Objects of class <code>spwbInput</code> or <code>growthInput</code></td>
<td>Optional to recover the final state of a previous simulation</td>
</tr>
<tr class="even">
<td><code>meteo</code></td>
<td>Weather data frames (see <a href="model-inputs.html#meteoinput">2.5</a>)</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>crop_factor</code></td>
<td>Crop evapo-transpiration factor</td>
<td>Only required for <em>agriculture</em> land cover type</td>
</tr>
<tr class="even">
<td><code>management_arguments</code></td>
<td>Management arguments for each stand</td>
<td>Optional for <code>fordyn_spatial()</code></td>
</tr>
<tr class="odd">
<td><code>management_unit</code></td>
<td>Management unit corresponding to each stand</td>
<td>Required for <code>fordyn_scenario()</code></td>
</tr>
<tr class="even">
<td><code>represented_area_ha</code></td>
<td>Area represented by each stand, in hectares</td>
<td>Required for <code>fordyn_scenario()</code></td>
</tr>
<tr class="odd">
<td><code>channel</code></td>
<td>Logical values indicating whether cells belong to the channel network.</td>
<td>Required for <code>*_land()</code></td>
</tr>
<tr class="even">
<td><code>depth_to_bedrock</code></td>
<td>Depth to bedrock (mm).</td>
<td>Required for <code>*_land()</code></td>
</tr>
<tr class="odd">
<td><code>bedrock_conductivity</code></td>
<td>Bedrock (saturated) conductivity (in m·day-1).</td>
<td>Required for <code>*_land()</code></td>
</tr>
<tr class="even">
<td><code>bedrock_porosity</code></td>
<td>Bedrock porosity ([0-1]).</td>
<td>Required for <code>*_land()</code></td>
</tr>
<tr class="odd">
<td><code>snowpack</code></td>
<td>Snow water equivalent content of the snowpack (mm).</td>
<td>Required for <code>*_land()</code></td>
</tr>
<tr class="even">
<td><code>aquifer</code></td>
<td>Water content of the aquifer in each cell.</td>
<td>Required for <code>*_land()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="topoinput" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Latitude and topography<a href="model-inputs.html#topoinput" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Topography has a relatively small direct influence in <strong>medfate</strong> simulations, because most topographic effects are assumed to be taken into account in the estimation of weather inputs. Nonetheless, <em>elevation</em> in meters is needed to estimate atmospheric pressure and air density (see <a href="model-inputs.html#meteoinput">2.5</a>), whereas <em>aspect</em> (in degrees from North) and <em>slope</em> (also in degrees) are needed in addition to <em>latitude</em> (also in degrees North) to estimate sunrise/sunset hours and potential radiation. Topographic variables should be readily accessible for users having access to a digital elevation model of the target area.</p>
</div>
<div id="soilinput" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Soil description<a href="model-inputs.html#soilinput" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Soils are described in <strong>medfate</strong> using <span class="math inline">\(S &gt; 1\)</span> different soil layers (<span class="math inline">\(s \in \{1, 2, ..., S\}\)</span>). Here the word <em>soil</em> refers to depths that plant rooting systems can reach (i.e., the critical zone), including cracks within the bedrock. The number and size of soil layers may correspond to changes in soil properties along depth, but also can be chosen to reflect differences in plant rooting depths. The physical properties of the soil are needed to estimate soil hydraulic properties and are considered <strong>static soil parameters</strong> in simulations. In contrast, soil moisture content, other variables that depend on moisture (e.g. soil water potential and soil conductivity) and soil temperature, if the soil energy balance is considered, are all <strong>soil state variables</strong>.</p>
<div id="soil-physical-properties" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Soil physical properties<a href="model-inputs.html#soil-physical-properties" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Soil physical properties, such as <em>texture</em> (i.e. volume percent of sand, silt and clay), <em>organic matter content</em>, <em>bulk density</em> or <em>rock fragment content</em>, can differ between soil layers, and this has important consequences for soil water retention capacity and soil hydraulics. Specifying layers with an elevated rock fragment content (e.g. layers of weathered rock where soil particles are scarce) may be important in seasonally-arid climates like the Mediterranean, because plants often extend their roots into cracks existing in the parent rock to access water during summer <span class="citation">(<a href="#ref-Ruffault2013">Ruffault <em>et al.</em> 2013</a>)</span>.</p>
<p>For each soil layer <span class="math inline">\(s\)</span>, the following physical parameters are needed:</p>
<table>
<colgroup>
<col width="14%" />
<col width="12%" />
<col width="7%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(d_{s}\)</span></td>
<td>mm</td>
<td><code>widths</code></td>
<td>Width of soil layer <span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(P_{clay,s}\)</span></td>
<td>%</td>
<td><code>clay</code></td>
<td>Percent volume of clay (within soil particles fraction) in layer <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P_{sand,s}\)</span></td>
<td>%</td>
<td><code>sand</code></td>
<td>Percent volume of sand (within soil particles fraction) in layer <span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(OM_s\)</span></td>
<td>%</td>
<td><code>om</code></td>
<td>Percentage of organic mater per dry weight (can be missing) in layer <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(BD_{s}\)</span></td>
<td><span class="math inline">\(g \cdot cm^{-3}\)</span></td>
<td><code>bd</code></td>
<td>Bulk density in layer <span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(P_{rocks,s}\)</span></td>
<td>%</td>
<td><code>rfc</code></td>
<td>Rock fragment content as percent volume (within whole soil) in layer <span class="math inline">\(s\)</span></td>
</tr>
</tbody>
</table>
<p>The percent volume of silt is 100% minus the percent volume of clay and sand. Whenever possible, soil physical properties should be measured in soil profiles conducted at the target forest plot (although soil profiles rarely reach rooting depths of deeply-rooted plants). Soil input data should be arranged in a <code>data.frame</code> with soil layers in rows and physical variables in columns (see function <code>defaultSoilParams()</code>). The following is an example with four soil layers:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="model-inputs.html#cb4-1" tabindex="-1"></a>soildf <span class="ot">&lt;-</span> <span class="fu">defaultSoilParams</span>()</span>
<span id="cb4-2"><a href="model-inputs.html#cb4-2" tabindex="-1"></a>soildf</span></code></pre></div>
<pre><code>##   widths clay sand om nitrogen  bd rfc
## 1    300   25   25 NA       NA 1.5  25
## 2    700   25   25 NA       NA 1.5  45
## 3   1000   25   25 NA       NA 1.5  75
## 4   2000   25   25 NA       NA 1.5  95</code></pre>
<p>Package <a href="https://github.com/emf-creaf/medfateutils"><strong>medfateutils</strong></a> includes a function <code>soilgridsParams()</code> to fetch soil information from <a href="https://soilgrids.org/">SoilGrids.org</a>, a global soil database currently providing soil data at 250m scale. This can be helpful to users lacking local soil measurements, but the uncertainty of SoilGrids estimates can be high for some areas and soil properties, especially soil depth and rock fragment content.</p>
<p>The depth of a given soil layer <span class="math inline">\(s\)</span> (<span class="math inline">\(Z_s\)</span>; in mm) is defined as the sum of layer widths from the surface to the target layer:
<span class="math display">\[\begin{equation}
Z_s = \sum_{i=1}^s{d_s}
\end{equation}\]</span>
And the overall <em>soil depth</em> (<span class="math inline">\(Z_{soil}\)</span>; in mm) is the sum of widths across all soil layers. As the soil may include deep rocky layers, the value of <span class="math inline">\(Z_{soil}\)</span> may be larger than the soil depth reported in soil profiles.</p>
</div>
<div id="waterretentioncurves" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Water retention curves<a href="model-inputs.html#waterretentioncurves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>water retention curve</strong> of a soil is the relationship between <em>volumetric soil moisture content</em> (<span class="math inline">\(\theta\)</span>, in <span class="math inline">\(m^3 \cdot m^{-3}\)</span> of soil, excluding rock fragments) and the corresponding <em>soil water potential</em> (<span class="math inline">\(\Psi\)</span>, in MPa), i.e. the amount of work that must be done per unit quantity of pure water in order to transport reversibly and isothermally an infinitesimal quantity of water from a reference pool. The shape of the water retention curve (also called the <em>soil moisture characteristic curve</em>) depends on physical properties (mainly texture and bulk density, but also organic matter content). Since soil layers usually differ in their physical properties they also normally have different water retention curves.</p>
<p>Two water retention curve models are available in <strong>medfate</strong> (fig. <a href="model-inputs.html#fig:retention-curves">2.2</a>):</p>
<ol style="list-style-type: decimal">
<li><em>Saxton model</em>: In this model, volumetric soil moisture <span class="math inline">\(\theta(\Psi)\)</span> corresponding to a given water potential <span class="math inline">\(\Psi\)</span> (in MPa) below field capacity (i.e., <span class="math inline">\(\Psi &lt; \Psi_{fc}\)</span>) is calculated using:
<span class="math display">\[\begin{equation}\theta(\Psi) = (\Psi/A)^{(1/B)}\end{equation}\]</span>
where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> depend on the texture and, if available, organic matter in the soil. If organic matter is available, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are calculated from <span class="math inline">\(P_{clay}\)</span>, <span class="math inline">\(P_{sand}\)</span> and <span class="math inline">\(OM\)</span> following <span class="citation">Saxton &amp; Rawls (<a href="#ref-Saxton2006">2006</a>)</span>. Otherwise, they are calculated from <span class="math inline">\(P_{clay}\)</span> and <span class="math inline">\(P_{sand}\)</span> as indicated in <span class="citation">Saxton <em>et al.</em> (<a href="#ref-Saxton1986">1986</a>)</span>. Volumetric changes between field capacity and saturation (i.e., <span class="math inline">\(\Psi_{fc} \leq \Psi &lt; 0\)</span>) are estimated using a linear function.</li>
<li><em>Van Genuchten model</em>: The well known van Genuchten <span class="citation">(<a href="#ref-Genuchten1980">1980</a>)</span> model is:
<span class="math display">\[\begin{equation}\theta(\Psi) = \theta_{res}+\frac{\theta_{sat}-\theta_{res}}{\left[1+ (\alpha \cdot \Psi)^n \right]^{1-1/n}}\end{equation}\]</span>
where <span class="math inline">\(\theta(\psi)\)</span> is the water retention, <span class="math inline">\(\theta_{sat}\)</span> is the saturated water content, <span class="math inline">\(\theta_{res}\)</span> is the residual water content, <span class="math inline">\(\alpha\)</span> is related to the inverse of the air entry pressure, and <span class="math inline">\(n\)</span> is a measure of the pore-size distribution.</li>
</ol>

<pre><code>## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2 3.5.0.
## ℹ Please use the `legend.position.inside` argument of `theme()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:retention-curves"></span>
<img src="medfatebook_files/figure-html/retention-curves-1.png" alt="Water retention curves under the Saxton and Van Genuchten models, for the same physical attributes (25% sand, 25% clay, 50% silt and bulk density of \(1.5 g \cdot cm^{-3}\)). Parameters of the Van Genuchten curve have been estimated using pedotransfer functions given in Tóth et al. (2015)." width="384" />
<p class="caption">
Figure 2.2: Water retention curves under the Saxton and Van Genuchten models, for the same physical attributes (25% sand, 25% clay, 50% silt and bulk density of <span class="math inline">\(1.5 g \cdot cm^{-3}\)</span>). Parameters of the Van Genuchten curve have been estimated using pedotransfer functions given in <span class="citation">Tóth <em>et al.</em> (<a href="#ref-Toth2015">2015</a>)</span>.
</p>
</div>
<p>Hydraulic conductivity governs the rate of water flow for a unit gradient in potential. It decreases sharply as soil becomes dry, and the relationship also depends on soil texture. The Saxton and Van Genuchten models also describe and parameterize the relationship between conductivity and soil water potential.</p>
</div>
<div id="soilinitialization" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Soil initialization<a href="model-inputs.html#soilinitialization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Soil initialization is needed to estimate hydrological parameters for each soil layer <span class="math inline">\(s\)</span> from its physical attributes. Soil initialization is done using function <code>soil()</code>, which returns an object of a S3 class with the same name (see <a href="model-inputs.html#inputstructuresmedfate">2.1.1</a>). Simulation functions in <strong>medfate</strong> need an object of class <code>soil</code> to be run.</p>
<p>Function <code>soil()</code> adds the following information to the physical soil description:</p>
<table>
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="6%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P_{macro}\)</span></td>
<td>%</td>
<td><code>macro</code></td>
<td>Percentage of macroporosity corresponding to each soil layers</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\gamma_{soil}\)</span></td>
<td><span class="math inline">\(mm \cdot day^{-1}\)</span></td>
<td><code>Gsoil</code></td>
<td>The maximum daily evaporation rate from soil (see <a href="hydrology.html#soilevaporation">5.4</a>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\theta_{sat}\)</span></td>
<td><span class="math inline">\(m^3 \cdot m^{-3}\)</span></td>
<td><code>VG_theta_sat</code></td>
<td>Volumetric soil moisture at saturation for each soil layer</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\theta_{res}\)</span></td>
<td><span class="math inline">\(m^3 \cdot m^{-3}\)</span></td>
<td><code>VG_theta_res</code></td>
<td>Residual volumetric soil moisture for each soil layer</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n\)</span></td>
<td></td>
<td><code>VG_n</code></td>
<td>Parameter <span class="math inline">\(n\)</span> of the Van Genuchten <span class="citation">(<a href="#ref-Genuchten1980">1980</a>)</span> model for each soil layer</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha\)</span></td>
<td><span class="math inline">\(MPa^{-1}\)</span></td>
<td><code>VG_alpha</code></td>
<td>Parameter <span class="math inline">\(\alpha\)</span> of the Van Genuchten <span class="citation">(<a href="#ref-Genuchten1980">1980</a>)</span> model for each soil layer</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(K_{sat}\)</span></td>
<td><span class="math inline">\(mmol \cdot s^{-1} \cdot m^{-2} \cdot MPa^{-1}\)</span></td>
<td><code>Ksat</code></td>
<td>Saturated soil conductivity for each soil layer</td>
</tr>
</tbody>
</table>
<p>Macroporosity values are calculated using the equations given in <span class="citation">Stolf <em>et al.</em> (<a href="#ref-Stolf2011">2011</a>)</span>, while <span class="math inline">\(\gamma_{soil}\)</span> is derived from texture. Parameters of the van Genuchten model for each layer are estimated from the physical description of the layer using one of two pedotransfer functions (see help for <code>soil()</code>):</p>
<ol style="list-style-type: decimal">
<li>Using the USDA texture classification and the average texture class parameters given by <span class="citation">Carsel &amp; Parrish (<a href="#ref-Carsel1988">1988</a>)</span>.</li>
<li>Directly from the soil texture, organic matter and bulk density, using the pedotransfer functions in <span class="citation">Tóth <em>et al.</em> (<a href="#ref-Toth2015">2015</a>)</span>.</li>
</ol>
<p>Parameter <span class="math inline">\(\alpha\)</span> of the Van Genuchten model is given in <span class="math inline">\(MPa^{-1}\)</span>, but it can be transformed to <span class="math inline">\(cm^{-1}\)</span> using the relationship:</p>
<p><span class="math display">\[\begin{equation}
1\, cm = 0.00009804139432\,\,MPa,
\end{equation}\]</span></p>
<p>which can also be applied to water potential units. Soil layer saturated conductivity (<span class="math inline">\(K_{sat}\)</span>) is estimated using <span class="citation">Saxton &amp; Rawls (<a href="#ref-Saxton2006">2006</a>)</span> or <span class="citation">Saxton <em>et al.</em> (<a href="#ref-Saxton1986">1986</a>)</span>, depending on whether an estimate of organic mater is available. <span class="math inline">\(K_{sat}\)</span> is given in physiological units <span class="math inline">\(mmol \cdot s^{-1} \cdot m^{-2} \cdot MPa^{-1}\)</span>, but they can be transformed into <span class="math inline">\(cm\cdot day^{-1}\)</span> using:</p>
<p><span class="math display">\[\begin{equation}
1\, cm\cdot day^{-1} = 655.2934\,\,mmol \cdot s^{-1} \cdot m^{-2} \cdot MPa^{-1}
\end{equation}\]</span></p>
<p>Besides defining soil parameters, function <code>soil()</code> also initializes <em>soil state variables</em>: soil moisture content, soil temperature (although set to a missing value) and water table depth. Users can edit the <code>soil</code> object manually (it is actually a <code>list</code>), for example to provide specific parameters of the Van Genuchten retention curve calibrated from soil measurements.</p>
<p>Saturated conductivity (<span class="math inline">\(K_{sat}\)</span>) is corrected for bulk density (<span class="math inline">\(BD\)</span>) of the soil layer, because compact soils have lower conductivity <span class="citation">(<a href="#ref-rahimi_evaluation_2011">Rahimi <em>et al.</em> 2011</a>)</span>:</p>
<p><span class="math display">\[\begin{equation}
K_{sat} = K_{sat,ref} \cdot \left( \frac{\rho_{s} - BD}{\rho_{s} - BD_{ref}} \right)^3
\end{equation}\]</span>
where <span class="math inline">\(K_{sat,ref}\)</span> is the reference conductivity according to soil texture, <span class="math inline">\(\rho_{s} = 2.73 \,g\cdot cm^{-3}\)</span> is density of soil particles, <span class="math inline">\(BD_{ref} = 1.2\,g\cdot cm^{-3}\)</span> is the reference bulk density.</p>
</div>
<div id="watercontent" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Water content and depth to saturation<a href="model-inputs.html#watercontent" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>volume of water</em> (<span class="math inline">\(V_s\)</span> in <span class="math inline">\(mm = l \cdot m^{-2}\)</span> of ground area) in a soil layer <span class="math inline">\(s\)</span> is calculated from its water potential (<span class="math inline">\(\Psi_s\)</span>) and water retention curve using:
<span class="math display">\[\begin{equation}
V_s(\Psi_s) = d_s\cdot ((100-P_{rocks,s})/100)\cdot\theta_{s}(\Psi_s)
\end{equation}\]</span>
where <span class="math inline">\(d_s\)</span> is the depth of the soil layer (in mm) and <span class="math inline">\(P_{rocks,s}\)</span> is the percentage of rock fragments. The overall volume of water in the soil (accessible by roots) is simply the sum of water content over soil layers:
<span class="math display">\[\begin{equation}
V_{soil} = \sum_{s=1}^S{V_s(\Psi_s)}
\end{equation}\]</span></p>
<p>A number of fixed water volumes (and their corresponding moisture) are important to remember:</p>
<ul>
<li><em>Water holding capacity</em> (<span class="math inline">\(V_{fc, s}\)</span>, in mm) of the soil layer <span class="math inline">\(s\)</span> is defined as the volume of water at <em>field capacity</em>, i.e. at <span class="math inline">\(\Psi_{fc} = -0.033\)</span> MPa, the amount of water held in the soil after gravitational water has drained away:
<span class="math display">\[\begin{equation}
V_{fc,s} = V_{s}(-0.033) = d_s\cdot ((100-P_{rocks,s})/100)\cdot\theta_{fc,s}
\end{equation}\]</span>
where <span class="math inline">\(\theta_{fc,s} = \theta_s(-0.033)\)</span> is the corresponding moisture at field capacity.</li>
<li><em>Water content at saturation</em> (<span class="math inline">\(V_{sat, s}\)</span>, in mm) is calculated anagolously, but replacing <span class="math inline">\(\theta_{fc,s}\)</span> by <span class="math inline">\(\theta_{sat, s} = \theta_s(0)\)</span>, the moisture at <em>saturation</em>, the amount of soil moisture when all easily drained spaces between soil particles (i.e. macropores) are also filled with water.</li>
<li><em>Water content at wilting point</em> (<span class="math inline">\(V_{wp, s}\)</span>, in mm) is calculated replacing <span class="math inline">\(\theta_{fc,s}\)</span> by <span class="math inline">\(\theta_{wp,s} = \theta_s(-1.5)\)</span>, the moisture at <em>wilting point</em>, i.e. at <span class="math inline">\(\Psi_{fc} = -1.5\)</span> MPa, a conventional amount of soil moisture beyond which plants are assumed have problems extracting water and start to wilt. However, plants can often extract water from much drier soils.</li>
<li>The <em>amount of extractable water</em> (in mm) is the difference between water content at field capacity and the water content at a conventional minimum water potential, which can be set at wilting point or lower values (by default at -5 MPa in <strong>medfate</strong>).</li>
</ul>
<p>The <em>saturated water depth</em> (<span class="math inline">\(Z_{sat}\)</span>, in mm) is not defined (i.e. missing) when all soil layers are below field capacity. When some layers are between field capacity and saturation, depth of the saturated water is calculated as:
<span class="math display">\[\begin{equation}
Z_{sat} = \sum_{s}{d_s \cdot \min\left[1,(\theta_{sat,s} - \theta(\Psi_s))/(\theta_{sat,s}-\theta_{fc,s})\right]}
\end{equation}\]</span></p>
</div>
</div>
<div id="vegetationinput" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Vegetation description<a href="model-inputs.html#vegetationinput" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The representation of vegetation within a target forest stand is done in <strong>medfate</strong> primarily by means of <strong>cohorts of woody plants</strong> (i.e. trees and shrubs). A woody plant cohort represents a set of woody plants that belong to the same species (or functional group) and are more or less of the same <em>size</em>. For example, trees in a stand may be grouped by species and diameter class, whereas shrubs may be grouped by species and height. In practice however, plant cohorts are entities that are treated separately when modeling the forest stand. This representation in plant cohorts was chosen so that package functions can be easily applied to <strong>forest inventory data</strong>, for example from national forest surveys. The description of woody plant cohorts includes a measure of <em>abundance</em> of the cohort in the stand, which in the case of trees is <em>density</em> as stems per hectare and for shrubs is <em>percent cover</em> (shrubs are often multi-stemmed). The difference in measurement units for abundance is the main motivation for distinguishing between tree cohorts and shrub cohorts, rather than their size or growth form. Additionally, the description of vegetation in the forest stand may include the cover and mean height of a <strong>herbaceous layer</strong>. The presence or abundance of herbs is not always recorded in forest inventory surveys, but may be relevant vegetation component in open habitats like shrublands.</p>
<p>Note that one limitation of the representation of vegetation in <strong>medfate</strong> is that it is not spatially-explicit (i.e. plants cannot have explicit coordinates within forest stands) and hence spatial (horizontal) interactions between plant cannot be taken into account explicitly (but see <a href="model-inputs.html#plantwaterpools">2.4.8</a>).</p>
<div id="structural-attributes-of-woody-plant-cohorts" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Structural attributes of woody plant cohorts<a href="model-inputs.html#structural-attributes-of-woody-plant-cohorts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A woody plant cohort <span class="math inline">\(i\)</span> is either a <em>tree cohort</em> or a <em>shrub cohort</em>, and is defined using a set of structural attributes shown in the following table, where columns <strong>spwb</strong>, <strong>growth</strong> and <strong>fordyn</strong> indicate whether attributes are required by simulation functions <code>spwb()/pwb()</code>, <code>growth()</code> and <code>fordyn()</code>, respectively:</p>
<table style="width:100%;">
<colgroup>
<col width="11%" />
<col width="10%" />
<col width="5%" />
<col width="51%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R</th>
<th>Description</th>
<th>spwb</th>
<th>growth</th>
<th>fordyn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(SP_i\)</span></td>
<td></td>
<td><code>Species</code></td>
<td>Species identity</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_i\)</span></td>
<td><span class="math inline">\(cm\)</span></td>
<td><code>Height</code></td>
<td>Average tree or shrub height</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(CR_i\)</span></td>
<td></td>
<td><code>CR</code></td>
<td>Crown ratio (i.e. ratio between crown length and plant height)</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="even">
<td><span class="math inline">\(N_i\)</span></td>
<td><span class="math inline">\(ind · ha^{-1}\)</span></td>
<td><code>N</code></td>
<td>Density of tree individuals</td>
<td>N</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(DBH_i\)</span></td>
<td><span class="math inline">\(cm\)</span></td>
<td><code>DBH</code></td>
<td>Tree diameter at breast height</td>
<td>N</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Cover_i\)</span></td>
<td>%</td>
<td><code>Cover</code></td>
<td>Shrub percent cover</td>
<td>N</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(LAI^{live}_i\)</span></td>
<td><span class="math inline">\(m^2 \cdot m^{-2}\)</span></td>
<td><code>LAI_live</code></td>
<td>(Maximum) leaf area index</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="even">
<td><span class="math inline">\(LAI^{dead}_i\)</span></td>
<td><span class="math inline">\(m^2 \cdot m^{-2}\)</span></td>
<td><code>LAI_dead</code></td>
<td>Dead leaf area index</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(LAI^{\phi}_i\)</span></td>
<td><span class="math inline">\(m^2 \cdot m^{-2}\)</span></td>
<td><code>LAI_expanded</code></td>
<td>Current expanded leaf area index</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Z_{50,i}\)</span></td>
<td>mm</td>
<td><code>Z50</code></td>
<td>Depth above which 50% of the fine root mass is located</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Z_{95,i}\)</span></td>
<td>mm</td>
<td><code>Z95</code></td>
<td>Depth above which 95% of the fine root mass is located</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Height (<span class="math inline">\(H\)</span>) values refer to average height of individuals included in the cohort, and the same for crown ratio (<span class="math inline">\(CR\)</span>) and diameter at breast height (<span class="math inline">\(DBH\)</span>). While plant size (i.e. height or diameter) is relatively easy to tally, other measurements are not usually made in the field. Package <strong>medfate</strong> includes utility functions that provide estimates <span class="math inline">\(CR\)</span> and <span class="math inline">\(LAI\)</span> from forest inventory data (e.g. heights, DBH and density for measured trees), using allometric relationships calibrated for Catalonia, Spain (see chapter <a href="allometricmodels.html#allometricmodels">21</a>).</p>
<p><strong>Leaf area index</strong></p>
<p><span class="math inline">\(LAI\)</span> variables refer to <em>one-sided leaf area</em> of plants per surface area of the stand. Leaves standing on branches of woody plants can be alive or dead. We will call <em>total leaf area index</em> of a woody plant cohort <span class="math inline">\(i\)</span> (<span class="math inline">\(LAI^{all}_{i}\)</span>) to the sum of its dead and live (and unfolded) leaf area:
<span class="math display">\[\begin{equation}
LAI^{all}_{i} = LAI^{\phi}_{i}+LAI^{dead}_{i}
\end{equation}\]</span></p>
<p>For simulations not involving growth, winter-deciduous phenology is a prognosed variable, and the current level of leaves unfolded may be lower than the maximum (live) amount of leaves. In simulations involving growth, both <span class="math inline">\(LAI^{\phi}\)</span> and <span class="math inline">\(LAI^{live}\)</span> can change, the former due to leaf phenology (unfolding is simulated explicitly and has carbon costs) and the latter due to leaf allocation limits during plant development.</p>
</div>
<div id="structural-attributes-of-herbaceous-vegetation" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Structural attributes of herbaceous vegetation<a href="model-inputs.html#structural-attributes-of-herbaceous-vegetation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The herbaceous layer of the stand is described collectively, without distinguishing among plant cohorts. Two attributes, cover and height, are required:</p>
<table>
<colgroup>
<col width="14%" />
<col width="12%" />
<col width="7%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(H_{herb}\)</span></td>
<td><span class="math inline">\(cm\)</span></td>
<td><code>herbHeight</code></td>
<td>Average height of herbaceous vegetation</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Cover_{herb}\)</span></td>
<td>%</td>
<td><code>herbCover</code></td>
<td>Percent cover of herbaceous vegetation</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(LAI_{herb}\)</span></td>
<td><span class="math inline">\(m^2 \cdot m^{-2}\)</span></td>
<td><code>LAI_herb</code></td>
<td>Leaf area index of herbaceous vegetation</td>
</tr>
</tbody>
</table>
<p>Leaf area index of herbaceous layer (<span class="math inline">\(LAI_{herb}\)</span>), is normally estimated from <span class="math inline">\(H_{herb}\)</span> and <span class="math inline">\(Cover_{herb}\)</span>, but could be directly prescribed by the user. Rooting depth parameters are not needed for herbaceous vegetation, which is assumed to extract water from the topmost soil layer. Note that neither phenology or growth/senescence processes are modelled in the case of herbaceous vegetation.</p>
</div>
<div id="leaf-area-index-of-the-forest-stand" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Leaf area index of the forest stand<a href="model-inputs.html#leaf-area-index-of-the-forest-stand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If there are <span class="math inline">\(c\)</span> woody plant cohorts, the leaf area index corresponding to living leaves, unfolded leaves and dead leaves can be aggregated across cohorts using:</p>
<p><span class="math display">\[\begin{eqnarray}
LAI^{live}_{woody} &amp;=&amp; \sum_{i=1}^c{LAI_{i}^{live}} \\
LAI^{\phi}_{woody} &amp;=&amp; \sum_{i=1}^c{LAI_{i}^{\phi}} \\
LAI^{dead}_{woody} &amp;=&amp; \sum_{i=1}^c{LAI_{i}^{dead}}
\end{eqnarray}\]</span></p>
<p>We can also estimate the overall leaf area index of woody plant cohorts (<span class="math inline">\(LAI^{all}_{woody}\)</span>):</p>
<p><span class="math display">\[\begin{eqnarray}
LAI^{all}_{woody} &amp;=&amp; \sum_{i=1}^c{LAI_{i}^{woody}}= LAI^{\phi}_{woody}+LAI^{dead}_{woody}
\end{eqnarray}\]</span></p>
<p>Finally, we can also estimate the overall leaf area index of the whole stand (<span class="math inline">\(LAI^{all}_{stand}\)</span>), which also takes into account the herbaceous layer (<span class="math inline">\(LAI_{herb}\)</span>):</p>
<p><span class="math display">\[\begin{eqnarray}
LAI^{all}_{stand} &amp;=&amp; LAI^{all}_{woody} + LAI_{herb} = LAI^{\phi}_{woody}+LAI^{dead}_{woody} + LAI_{herb}
\end{eqnarray}\]</span></p>
</div>
<div id="forestobjects" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Forest plot objects<a href="model-inputs.html#forestobjects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the previous section described the structural forest variables required to run simulations in <strong>medfate</strong>, forest plot data input in the package is easier if one uses a format that follows closely forest inventory plot descriptions. In this format, each forest plot is represented in an object of class <code>forest</code>, a list that contains several elements. Here we use an example forest stand provided with the package:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="model-inputs.html#cb7-1" tabindex="-1"></a><span class="fu">data</span>(exampleforest)</span>
<span id="cb7-2"><a href="model-inputs.html#cb7-2" tabindex="-1"></a>exampleforest</span></code></pre></div>
<pre><code>## $treeData
##            Species   N   DBH Height Z50  Z95
## 1 Pinus halepensis 168 37.55    800 100  600
## 2     Quercus ilex 384 14.60    660 300 1000
## 
## $shrubData
##             Species Cover Height Z50  Z95
## 1 Quercus coccifera  3.75     80 200 1000
## 
## $herbCover
## [1] 10
## 
## $herbHeight
## [1] 20
## 
## $seedBank
## [1] Species Percent
## &lt;0 files&gt; (o «row.names» de longitud 0)
## 
## attr(,&quot;class&quot;)
## [1] &quot;forest&quot; &quot;list&quot;</code></pre>
<p>The most important items of <code>forest</code> are the two data frames describing woody vegetation, <code>treeData</code> (for trees) and <code>shrubData</code> for shrubs, but the herbaceous layer can also be described using <code>herbCover</code> and <code>herbHeight</code>. With the aim to help users in the task of constructing <code>forest</code> objects, package <a href="https://github.com/emf-creaf/medfateutils"><strong>medfateutils</strong></a> includes functions to map user data in into tables <code>treeData</code> and <code>shrubData</code>.</p>
<p><code>forest</code> objects are a convenient format to start calculations with <strong>medfate</strong>, because there are many static functions that take forest objects as input. For example, a <code>summary.forest()</code> function provides the basal area, density, cover and leaf area index of the forest stand, and its different components:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="model-inputs.html#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(exampleforest, SpParamsMED)</span></code></pre></div>
<pre><code>## Tree BA (m2/ha): 25.0333016  adult trees: 25.0333016  saplings: 0 
## Density (ind/ha) adult trees: 552  saplings: 0  shrubs (estimated): 749.4923076 
## Cover (%) adult trees: 100  saplings: 0  shrubs: 3.75  herbs: 10 
## LAI (m2/m2) total: 1.7585845  adult trees: 1.5543216  saplings: 0  shrubs: 0.030626  herbs: 0.1736369 
## Fuel loading (kg/m2) total: 0.5588728  adult trees: 0.5255004  saplings: 0  shrubs: 0.0140795  herbs: 0.019293 
## PAR ground (%): NA  SWR ground (%): NA</code></pre>
</div>
<div id="single-cohort-forests" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Single-cohort forests<a href="model-inputs.html#single-cohort-forests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although <strong>medfate</strong> has been designed to perform simulations on multi-cohort forests, it can also handle simulations where vegetation is described using a single cohort. Functions <code>tree2forest()</code> and <code>shrub2forest()</code> allow defining single-cohort forests from attributes. For example a holm oak (<em>Quercus ilex</em>) forest of 4-m height and having a leaf area index of <span class="math inline">\(2\, m^2\cdot m^{-2}\)</span> can be defined using:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="model-inputs.html#cb11-1" tabindex="-1"></a>oak_forest <span class="ot">&lt;-</span><span class="fu">tree2forest</span>(<span class="st">&quot;Quercus ilex&quot;</span>, <span class="at">Height=</span> <span class="dv">400</span>, <span class="at">LAI =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The function will return a <code>forest</code> object where most attributes are empty:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="model-inputs.html#cb12-1" tabindex="-1"></a>oak_forest</span></code></pre></div>
<pre><code>## $treeData
##        Species DBH Height  N Z50 Z95 LAI
## 1 Quercus ilex  NA    400 NA  NA  NA   2
## 
## $shrubData
## [1] Species Height  Cover   Z50     Z95    
## &lt;0 files&gt; (o «row.names» de longitud 0)
## 
## $herbCover
## [1] NA
## 
## $herbHeight
## [1] NA
## 
## $seedBank
## [1] Species Percent
## &lt;0 files&gt; (o «row.names» de longitud 0)
## 
## attr(,&quot;class&quot;)
## [1] &quot;forest&quot; &quot;list&quot;</code></pre>
<p>Nevertheless, the object is well defined, for example we can summarize it using:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="model-inputs.html#cb14-1" tabindex="-1"></a><span class="fu">summary</span>(oak_forest, SpParamsMED)</span></code></pre></div>
<pre><code>## Tree BA (m2/ha): 0  adult trees: 0  saplings: 0 
## Density (ind/ha) adult trees: 0  saplings: 0  shrubs (estimated): 0 
## Cover (%) adult trees: 0  saplings: 0  shrubs: 0  herbs: 0 
## LAI (m2/m2) total: 2  adult trees: 0  saplings: 0  shrubs: 0  herbs: 0 
## Fuel loading (kg/m2) total: 0.5698237  adult trees: 0  saplings: 0  shrubs: 0  herbs: 0 
## PAR ground (%): NA  SWR ground (%): NA</code></pre>
<p>Since density and diameter have not been provided, simulations in this case will be restricted to function <code>spwb()/pwb()</code>. Moreover, note that when defining single-cohort forests all possible interactions with functionally distinct plants are neglected.</p>
</div>
<div id="leafdistribution" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Vertical leaf distribution<a href="model-inputs.html#leafdistribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The vegetation input structures allow the package to determine the vertical distribution of leaves in the stand. The leaf area of any woody plant cohort is assumed to be distributed vertically following a <strong>truncated Gaussian function</strong> whose standardized values -1.5 and 1.5 correspond to crown base height (<span class="math inline">\(H_{crown,i}\)</span>; in <span class="math inline">\(cm\)</span>) and total plant height (<span class="math inline">\(H_i\)</span>), respectively. Crown base height is defined as the height corresponding to the first living branch. It is calculated from the crown ratio of the cohort (<span class="math inline">\(CR_i\)</span>; a proportion between 0 and 1), which in turn can be estimated as explained in <a href="allometricmodels.html#eq:CrownHeight">(21.6)</a>.</p>
<p>Simulation models in <strong>medfate</strong> divide the vertical dimension into vertical layers (by default are 100 cm width, but see control parameter <code>verticalLayerSize</code>). Let us define <span class="math inline">\(LAI_{i,j}^{all} = LAI_{i,j}^{\phi}+LAI_{i,j}^{dead}\)</span> as the leaf area index of cohort <span class="math inline">\(i\)</span> in layer <span class="math inline">\(j\)</span> including both functional leaves and dead leaves standing on branches. The truncated Gaussian distribution defines the <span class="math inline">\(LAI_{i,j}^{\phi}\)</span> and <span class="math inline">\(LAI_{i,j}^{dead}\)</span> for all plant cohorts and vertical layers.</p>
<p>Dividing the leaf area of a given layer by its width, one obtains the <em>leaf area density</em> (<span class="math inline">\(LAD\)</span> in <span class="math inline">\(m^2 \cdot m^{-3}\)</span>). Figure <a href="model-inputs.html#fig:leafareadensity">2.3</a> illustrates the leaf area density profile (see function <code>vprofile_leafAreaDensity()</code>) corresponding to the forest stand described in the example <code>forest</code> object that we showed above.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:leafareadensity"></span>
<img src="medfatebook_files/figure-html/leafareadensity-1.png" alt="Leaf area density distribution of woody vegetation in a forest stand. The left panel shows the distribution for each plant cohort separately, whereas the right panel shows the overall density distribution." width="768" />
<p class="caption">
Figure 2.3: Leaf area density distribution of woody vegetation in a forest stand. The left panel shows the distribution for each plant cohort separately, whereas the right panel shows the overall density distribution.
</p>
</div>
<p>The leaf area density profile determines the light extinction rates through the forest canopy. The same truncated Gaussian distribution is used to distribute leaf and small branch biomass along the vertical dimension.</p>
<p>When present, we can include herbaceous vegetation (i.e. <span class="math inline">\(LAI_{herb}\)</span>) in the leaf area density profile. Its vertical distribution is also assumed to follow a truncated Gaussian function:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:leafareadensityherbs"></span>
<img src="medfatebook_files/figure-html/leafareadensityherbs-1.png" alt="Leaf area density distribution in a forest stand, including the herbaceous layer. The left panel shows the distribution for each plant cohort separately, whereas the right panel shows the overall density distribution." width="768" />
<p class="caption">
Figure 2.4: Leaf area density distribution in a forest stand, including the herbaceous layer. The left panel shows the distribution for each plant cohort separately, whereas the right panel shows the overall density distribution.
</p>
</div>
</div>
<div id="rootdistribution" class="section level3 hasAnchor" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Vertical root distribution<a href="model-inputs.html#rootdistribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Roots can be distinguished functionally into two different organs: <strong>coarse roots</strong> are responsible for mechanical support and transport of water and nutrients towards the stem, whereas <strong>fine roots</strong> are responsible for absorbing water and nutrients.</p>
<p>Analogously to the aboveground vegetation parameters, inputs describing depths corresponding to 50% and 95% of fine roots (<span class="math inline">\(Z_{50,i}\)</span> and <span class="math inline">\(Z_{95,i}\)</span>) are used to completely specify the distribution of roots across soil layers. The root system of each plant cohort <span class="math inline">\(i\)</span> is described using <span class="math inline">\(FRP_{i,s}\)</span>, the proportion of fine roots (with respect to the whole plant) in each soil layer <span class="math inline">\(s\)</span>. <span class="math inline">\(FRP_{i,s}\)</span> values are normally defined using the linear dose response model <span class="citation">(<a href="#ref-Schenk2002">Schenk &amp; Jackson 2002</a>; <a href="#ref-Collins2007">Collins &amp; Bras 2007</a>)</span>:
<span class="math display">\[\begin{eqnarray}
FRP_{i,s} &amp;=&amp; Y_i(Z_s) - Y_i(Z_{s-1}) \\
Y_i(z) &amp;=&amp; \frac{1}{1+(z/Z_{50,i})^{c_i}}
\end{eqnarray}\]</span>
where <span class="math inline">\(Y_i(z)\)</span> is the cumulative fraction of fine root mass located between surface and depth <span class="math inline">\(z\)</span>; <span class="math inline">\(Z_{50,i}\)</span> is the depth (in mm) above which 50% of the root mass is located; and <span class="math inline">\(c_i\)</span> is a shape parameter related to <span class="math inline">\(Z_{50,i}\)</span> and <span class="math inline">\(Z_{95,i}\)</span> as <span class="math inline">\(c_i  = 2.94 / \ln(Z_{50,i} / Z_{95,i})\)</span>.</p>
<p>The linear dose response model is quite flexible with respect to fine root distribution (see function <code>root_ldrDistribution()</code>). The following figure shows the fine root distribution profile of the same cohorts as in fig. <a href="model-inputs.html#fig:leafareadensity">2.3</a> (see <code>vprofile_rootDistribution()</code>):</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:root-distribution"></span>
<img src="medfatebook_files/figure-html/root-distribution-1.png" alt="Examples of root density profile according to the linear dose response model." width="480" />
<p class="caption">
Figure 2.5: Examples of root density profile according to the linear dose response model.
</p>
</div>
<p>The actual input to simulation functions <code>spwb()</code>, <code>growth()</code> and alike, describes fine root distribution using the matrix of <span class="math inline">\(FRP_{i,s}\)</span> values - not <span class="math inline">\(Z_{50,i}\)</span> and <span class="math inline">\(Z_{95,i}\)</span> -, which means that the proportions of fine roots can be modified manually or be defined by another model. In fact, <strong>medfate</strong> also allows calculating <span class="math inline">\(FRP_{i,s}\)</span> values assuming a conic distribution of fine roots (see <code>root_conicDistribution()</code>).</p>
</div>
<div id="plantwaterpools" class="section level3 hasAnchor" number="2.4.8">
<h3><span class="header-section-number">2.4.8</span> Water pools and root horizontal distribution<a href="model-inputs.html#plantwaterpools" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default, models in <strong>medfate</strong> assume that soil moisture under all plant cohorts is the same (i.e. water sources corresponding to vertical soil layers are shared among cohorts). Therefore, it neglects spatial variation in soil moisture, against moisture variation patterns observed in mixed stands <span class="citation">(<a href="#ref-Schume2004">Schume <em>et al.</em> 2004</a>)</span>. However, variations in soil moisture beneath plant cohorts (and, implicitly, horizontal variation of soil moisture) can also be simulated if required by the user (see parameter <code>rhizosphereOverlap</code> in <a href="model-inputs.html#controlparameters">2.6</a>). This involves considering that a given plant cohort will perform water uptake from the <strong>water pool</strong> surrounding its roots, whereas it may not have access to the water beneath other plants. However, there can exist some degree of horizontal overlap between water pools exploited by different plants.</p>
<p>Considering water pools involves partitioning the stand area into fractions corresponding to the abundance of each plant cohort. More specifically, the model defines as many water pools as plant cohorts, with proportions defined by their LAI values:
<span class="math display">\[\begin{equation}
f_{pool,i} = \frac{LAI^{live}_i}{LAI^{live}_{stand}}
\end{equation}\]</span>
Models assume that the rhizosphere of each plant cohort occupies its own water pool but may extend into the water pools under other plant cohorts. In other words, the root systems of different cohorts may overlap horizontally. Moreover, the horizontal overlap of root systems will vary across soil layers. A given plant cohort <span class="math inline">\(i\)</span> will have its roots in layer <span class="math inline">\(s\)</span> partitioned among different water pools. We thus need to define <span class="math inline">\(fr_{i,s,j}\)</span>, the (horizontal) proportion of fine roots of cohort <span class="math inline">\(i\)</span> in layer <span class="math inline">\(s\)</span> of the water pool <span class="math inline">\(j\)</span>, with the restriction that:
<span class="math display">\[\begin{equation}
\sum_{j}{fr_{i,s,j}} = 1 \,\, \forall i,s
\end{equation}\]</span></p>
<p>A simplifying assumption is to force a complete independence of water pools, which is equal to say that <span class="math inline">\(fr_{i,s,j} = 1\)</span> for <span class="math inline">\(i = j\)</span> and <span class="math inline">\(fr_{i,s,j} = 0\)</span> when <span class="math inline">\(i \neq j\)</span> (this is the simplification adopted when using <code>rhizosphereOverlap = "none"</code>). In the general case of partial overlap (<code>rhizosphereOverlap = "partial"</code>), it is important to realize that proper estimation of <span class="math inline">\(fr_{i,s,j}\)</span> is challenging when we do not have explicit plant coordinates, root lateral widths, etc. At this point, let us assume we have a reasonable estimate of <span class="math inline">\(Vol_{i}\)</span>, the <strong>soil volume explored by coarse roots</strong> of an individual of cohort <span class="math inline">\(i\)</span>. Assuming that the proportion of fine roots in each layer is proportional to the proportion of total soil volume explored by coarse roots that corresponds to the same layer we have that <span class="math inline">\(Vol_{i,s}\)</span>, the soil volume explored by coarse roots in layer <span class="math inline">\(s\)</span> is:
<span class="math display">\[\begin{equation}
Vol_{i,s} = FRP_{i,s}\cdot Vol_{i}
\end{equation}\]</span>
In <strong>medfate</strong>, coarse roots are represented by <em>axial</em> and <em>radial</em> components. The length of axial component of a given layer (<span class="math inline">\(L_{axial, i, s}\)</span>) is simply equivalent to its bottom depth, whereas the radial component (<span class="math inline">\(L_{radial, i, s}\)</span>) is unknown. However, we can assume that the soil volume explored by coarse roots corresponds to a cylinder:<br />
<span class="math display">\[\begin{equation}
Vol_{i,s} = \pi \cdot L_{radial,i,s}^2 \cdot L_{axial, i, s}
\end{equation}\]</span>
and substituting the soil volume <span class="math inline">\(Vol_{i,s}\)</span> in the equation above we can isolate <span class="math inline">\(L_{radial,i,s}\)</span> (see function <code>root_coarseRootLengthsFromVolume()</code>). Once we have the radial component we can estimate the area (<span class="math inline">\(m^2\)</span>) covered by coarse roots of an individual of the cohort in a given layer <span class="math inline">\(s\)</span>:
<span class="math display">\[\begin{equation}
Area_{i,s} = \pi \cdot L_{radial,i,s}^2
\end{equation}\]</span>
We can then compare <span class="math inline">\(Area_{i,s}\)</span> to the area of the water pool for an individual of cohort <span class="math inline">\(i\)</span>, which in <span class="math inline">\(m^2\)</span> is:
<span class="math display">\[\begin{equation}
AreaPool_{i} = 10000 \cdot f_{pool,i}/N_{i}
\end{equation}\]</span>
If <span class="math inline">\(Area_{i,s} \leq AreaPool_{i}\)</span>, then the roots of the individual do not exceed the area of the pool, in other words <span class="math inline">\(fr_{i,s,i} = 1\)</span> and <span class="math inline">\(fr_{i,s,j} = 0\)</span> for all <span class="math inline">\(j \neq i\)</span>. If
<span class="math inline">\(Area_{i,s} &gt; AreaPool_{i}\)</span> then the excess should be counted as overlap with the other pools. Assuming that plants are randomly distributed (i.e. no clumping) the probability of finding the pool of a cohort is equal to the proportion of its water pool (see function <code>root_horizontalProportions()</code>). All these calculations were done assuming <span class="math inline">\(Vol_{i}\)</span> were known. Estimation of <span class="math inline">\(Vol_{i}\)</span> depends on the complexity of the water balance model and is explained in <a href="modelparametrization.html#horizontalrootoverlap">A.4.6</a>.</p>
</div>
<div id="functionaltraits" class="section level3 hasAnchor" number="2.4.9">
<h3><span class="header-section-number">2.4.9</span> Functional traits and vegetation initialization<a href="model-inputs.html#functionaltraits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Besides the physical representation of vegetation, forest ecosystem models require information regarding plant functional traits, because this influences the outcome of physical, physiological and hydrological processes. In the following chapters, we will indicate for each simulated process its required plant functional parameters. A description of all parameters is provided in data frame <code>SpParamsDefinition</code> included in the package.</p>
<p>Normally, functional traits are described at the species level because infra-specific parameters are hard to get. Even at the species level, many functional (e.g. physiological) traits are hard to obtain, so in <strong>medfate</strong> we provide a default species parameter table for woody species found in Spain, with many of them occurring elsewhere in the Mediterranean Basin (<code>SpParamsMED</code>). User can modify this data frame to account for intra-specific trait variation (see function <code>modifySpParams()</code>).</p>
<p>The package provides functions <code>spwbInput()</code> and <code>growthInput()</code> that prepare the <code>forest</code> vegetation input for simulation functions <code>spwb()</code> and <code>growth()</code>, respectively (see <a href="model-inputs.html#inputstructuresmedfate">2.1.1</a>). This initialization mostly consists in compiling the necessary functional traits from the species parameter table, following the <span class="math inline">\(SP_i\)</span> attribute of woody plant cohorts. Some new model parameters are estimated from the initial ones, while taking into account the structural attributes of cohorts (an example of these derived quantities is stem conductance, which estimated from stem xylem conductivity, Huber value and plant height). Users can take the output of these initialization functions and replace parameter values for specific plant cohorts (see function <code>modifyCohortParams()</code>).</p>
</div>
<div id="update-of-structural-variables-during-simulations" class="section level3 hasAnchor" number="2.4.10">
<h3><span class="header-section-number">2.4.10</span> Update of structural variables during simulations<a href="model-inputs.html#update-of-structural-variables-during-simulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vegetation characteristics stay constant during simulations using functions <code>spwb()</code> or <code>pwb()</code>, although the actual (unfolded) leaf area and dead leaf area may vary depending on leaf phenology.</p>
<p>In contrast, growth simulation requires updating the structure of vegetation, i.e. plant heights, tree diameters, tree density and shrub cover. Function <code>growth()</code> can modify any of the vegetation attributes. Finally, function <code>fordyn()</code> modifies not only structural variables of the initial cohorts but also involves the removal of dead (or cut) woody cohorts and recruitment of new woody cohorts during simulations.</p>
</div>
</div>
<div id="meteoinput" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Metereological input<a href="model-inputs.html#meteoinput" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Weather input data must include variables calculated at the <strong>daily</strong> scale. Weather data should be arranged in a data frame with days in <strong>rows</strong> and variables in <strong>columns</strong>.</p>
<p>Since it allows producing data frames with appropriate variable units and row/column names, we recommend meteorological input to be generated using package <strong>meteoland</strong> <span class="citation">(<a href="#ref-DeCaceres2018">De Cáceres <em>et al.</em> 2018</a>)</span>, but other sources are possible.</p>
<div id="date-format" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Date format<a href="model-inputs.html#date-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dates are needed in <strong>medfate</strong> to estimate parameters like solar declination or the day of the year (<span class="math inline">\(DOY\)</span>). Dates can be specified in the input data frame either:</p>
<ul>
<li>As data frame <strong>row names</strong> (in string format <em>year-month-day</em>)</li>
<li>As <code>Date</code> elements in a column called <code>"dates"</code>.</li>
</ul>
</div>
<div id="required-weather-variables" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Required weather variables<a href="model-inputs.html#required-weather-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some weather variables must be present always in the input data frame, whereas others are optional, meaning that the package can estimate them if missing. The following table indicates the symbols, units, definitions and the variable name in R of input weather variables that are always <strong>required</strong>:</p>
<table>
<colgroup>
<col width="11%" />
<col width="10%" />
<col width="12%" />
<col width="51%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R param</th>
<th>Description</th>
<th>Optional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(T_{min}\)</span></td>
<td><span class="math inline">\(^{\circ} \mathrm{C}\)</span></td>
<td><code>MinTemperature</code></td>
<td>Minimum temperature</td>
<td>No</td>
</tr>
<tr class="even">
<td><span class="math inline">\(T_{max}\)</span></td>
<td><span class="math inline">\(^{\circ} \mathrm{C}\)</span></td>
<td><code>MaxTemperature</code></td>
<td>Maximum temperature</td>
<td>No</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(RH_{min}\)</span></td>
<td>%</td>
<td><code>MinRelativeHumidity</code></td>
<td>Minimum relative humidity</td>
<td>No</td>
</tr>
<tr class="even">
<td><span class="math inline">\(RH_{max}\)</span></td>
<td>%</td>
<td><code>MaxRelativeHumidity</code></td>
<td>Maximum relative humidity</td>
<td>No</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P\)</span></td>
<td><span class="math inline">\(L \cdot m^{-2} = mm\)</span></td>
<td><code>Precipitation</code></td>
<td>Precipitation (either rainfall or snow).</td>
<td>No</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Rad\)</span></td>
<td><span class="math inline">\(MJ \cdot m^{-2}\)</span></td>
<td><code>Radiation</code></td>
<td>Solar radiation after accounting for clouds</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<div id="optional-weather-variables" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Optional weather variables<a href="model-inputs.html#optional-weather-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following table lists the same attributes for input weather variables that are <strong>optional</strong>:</p>
<table>
<colgroup>
<col width="11%" />
<col width="10%" />
<col width="12%" />
<col width="51%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R param</th>
<th>Description</th>
<th>Optional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(u\)</span></td>
<td><span class="math inline">\(m \cdot s^{-1}\)</span></td>
<td><code>WindSpeed</code></td>
<td>Wind speed</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><span class="math inline">\(R_{int}\)</span></td>
<td><span class="math inline">\(mm \cdot  h^{-1}\)</span></td>
<td><code>RainfallIntensity</code></td>
<td>Rainfall intensity</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_{atm}\)</span></td>
<td><span class="math inline">\(ppm\)</span></td>
<td><code>CO2</code></td>
<td>Atmospheric (above-canopy) <span class="math inline">\(CO_2\)</span> concentration</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P_{atm}\)</span></td>
<td><span class="math inline">\(kPa\)</span></td>
<td><code>Patm</code></td>
<td>Surface atmospheric pressure</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P_{fire}\)</span></td>
<td>[0-1]</td>
<td><code>FireProbability</code></td>
<td>Probability of wildfire occurrence</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>Missing wind speed (<span class="math inline">\(u\)</span>) and <span class="math inline">\(CO_2\)</span> values will be replaced by defaults defined in control parameters. As an alternative to providing daily atmospheric <span class="math inline">\(CO_2\)</span> concentration values, simulation functions allow the user to provide <span class="math inline">\(CO_2\)</span> concentration values in <strong>annual</strong> time steps using a separate vector.</p>
<p>When missing, atmospheric pressure (<span class="math inline">\(P_{atm}\)</span>) is also derived from elevation using an <a href="http://emf-creaf.github.io/meteolandbook/miscellaneous.html#physicalutils">utility function</a> available in <strong>meteoland</strong>.</p>
<p>Missing rainfall intensity (<span class="math inline">\(R_{int}\)</span>) values will be estimated from the current month using function <code>hydrology_rainfallIntensity()</code> and the seasonality of rainfall intensity given in control parameters (see <code>defaultRainfallIntensityPerMonth</code> in <a href="basicwaterbalance.html#basicwaterbalancecontrol">3.5.3</a>).</p>
</div>
<div id="derived-weather-variables" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Derived weather variables<a href="model-inputs.html#derived-weather-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the weather variables listed in the tables above are provided as inputs, <strong>medfate</strong> derives other atmospheric variables from them, using also topographic information (see <a href="http://emf-creaf.github.io/meteolandbook/miscellaneous.html#physicalutils">utility functions</a> of the <strong>meteoland</strong> reference manual):</p>
<table>
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="15%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Units</th>
<th>R param</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\rho_{air}\)</span></td>
<td><span class="math inline">\(kg \cdot m^{-3}\)</span></td>
<td></td>
<td>Air density</td>
</tr>
<tr class="even">
<td><span class="math inline">\(e_{atm}\)</span></td>
<td><span class="math inline">\(kPa\)</span></td>
<td></td>
<td>Atmospheric water vapor pressure</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(T_{mean}\)</span></td>
<td><span class="math inline">\(^{\circ} \mathrm{C}\)</span></td>
<td><code>MeanTemperature</code></td>
<td>Mean daily temperature</td>
</tr>
<tr class="even">
<td><span class="math inline">\(PET\)</span></td>
<td><span class="math inline">\(L \cdot m^{-2} = mm\)</span></td>
<td><code>PET</code></td>
<td>Potential evapotranspiration, calculated using Penman’s (1948) equation</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="controlparameters" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Simulation control<a href="model-inputs.html#controlparameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulation control parameters are a list of global parameter values, initialized using function <code>defaultControl()</code>, that the user can modify to change the general behavior of simulation functions. Here is the set of global control parameters currently accepted in <strong>medfate</strong>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="model-inputs.html#cb16-1" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">defaultControl</span>())</span></code></pre></div>
<pre><code>##   [1] &quot;fillMissingRootParams&quot;            &quot;fillMissingSpParams&quot;              &quot;fillMissingWithGenusParams&quot;      
##   [4] &quot;verbose&quot;                          &quot;subdailyResults&quot;                  &quot;standResults&quot;                    
##   [7] &quot;soilResults&quot;                      &quot;snowResults&quot;                      &quot;plantResults&quot;                    
##  [10] &quot;leafResults&quot;                      &quot;temperatureResults&quot;               &quot;fireHazardResults&quot;               
##  [13] &quot;fireHazardStandardWind&quot;           &quot;fireHazardStandardDFMC&quot;           &quot;transpirationMode&quot;               
##  [16] &quot;soilFunctions&quot;                    &quot;VG_PTF&quot;                           &quot;ndailysteps&quot;                     
##  [19] &quot;max_nsubsteps_soil&quot;               &quot;defaultWindSpeed&quot;                 &quot;defaultCO2&quot;                      
##  [22] &quot;defaultRainfallIntensityPerMonth&quot; &quot;leafPhenology&quot;                    &quot;bareSoilEvaporation&quot;             
##  [25] &quot;unlimitedSoilWater&quot;               &quot;interceptionMode&quot;                 &quot;infiltrationMode&quot;                
##  [28] &quot;infiltrationCorrection&quot;           &quot;soilDomains&quot;                      &quot;rhizosphereOverlap&quot;              
##  [31] &quot;unfoldingDD&quot;                      &quot;verticalLayerSize&quot;                &quot;windMeasurementHeight&quot;           
##  [34] &quot;segmentedXylemVulnerability&quot;      &quot;stemCavitationRecovery&quot;           &quot;leafCavitationRecovery&quot;          
##  [37] &quot;hydraulicRedistributionFraction&quot;  &quot;nsubsteps_canopy&quot;                 &quot;taper&quot;                           
##  [40] &quot;multiLayerBalance&quot;                &quot;sapFluidityVariation&quot;             &quot;TPhase_gmin&quot;                     
##  [43] &quot;Q10_1_gmin&quot;                       &quot;Q10_2_gmin&quot;                       &quot;rootRadialConductance&quot;           
##  [46] &quot;averageFracRhizosphereResistance&quot; &quot;thermalCapacityLAI&quot;               &quot;boundaryLayerSize&quot;               
##  [49] &quot;cavitationRecoveryMaximumRate&quot;    &quot;sunlitShade&quot;                      &quot;numericParams&quot;                   
##  [52] &quot;leafCavitationEffects&quot;            &quot;stemCavitationEffects&quot;            &quot;stomatalSubmodel&quot;                
##  [55] &quot;plantCapacitance&quot;                 &quot;cavitationFlux&quot;                   &quot;soilDisconnection&quot;               
##  [58] &quot;leafCuticularTranspiration&quot;       &quot;stemCuticularTranspiration&quot;       &quot;C_SApoInit&quot;                      
##  [61] &quot;C_LApoInit&quot;                       &quot;k_SSym&quot;                           &quot;fractionLeafSymplasm&quot;            
##  [64] &quot;gs_NightFrac&quot;                     &quot;JarvisPAR&quot;                        &quot;fTRBToLeaf&quot;                      
##  [67] &quot;subdailyCarbonBalance&quot;            &quot;allowDessication&quot;                 &quot;allowStarvation&quot;                 
##  [70] &quot;sinkLimitation&quot;                   &quot;shrubDynamics&quot;                    &quot;herbDynamics&quot;                    
##  [73] &quot;allocationStrategy&quot;               &quot;phloemConductanceFactor&quot;          &quot;nonSugarConcentration&quot;           
##  [76] &quot;equilibriumOsmoticConcentration&quot;  &quot;minimumRelativeStarchForGrowth&quot;   &quot;constructionCosts&quot;               
##  [79] &quot;senescenceRates&quot;                  &quot;maximumRelativeGrowthRates&quot;       &quot;mortalityMode&quot;                   
##  [82] &quot;mortalityBaselineRate&quot;            &quot;mortalityRelativeSugarThreshold&quot;  &quot;mortalityRWCThreshold&quot;           
##  [85] &quot;recrTreeDBH&quot;                      &quot;recrTreeDensity&quot;                  &quot;ingrowthTreeDBH&quot;                 
##  [88] &quot;ingrowthTreeDensity&quot;              &quot;allowSeedBankDynamics&quot;            &quot;allowRecruitment&quot;                
##  [91] &quot;allowResprouting&quot;                 &quot;recruitmentMode&quot;                  &quot;removeEmptyCohorts&quot;              
##  [94] &quot;minimumTreeCohortDensity&quot;         &quot;minimumShrubCohortCover&quot;          &quot;dynamicallyMergeCohorts&quot;         
##  [97] &quot;seedRain&quot;                         &quot;seedProductionTreeHeight&quot;         &quot;seedProductionShrubHeight&quot;       
## [100] &quot;probRecr&quot;                         &quot;minTempRecr&quot;                      &quot;minMoistureRecr&quot;                 
## [103] &quot;minFPARRecr&quot;                      &quot;recrTreeHeight&quot;                   &quot;recrShrubCover&quot;                  
## [106] &quot;recrShrubHeight&quot;                  &quot;recrTreeZ50&quot;                      &quot;recrShrubZ50&quot;                    
## [109] &quot;recrTreeZ95&quot;                      &quot;recrShrubZ95&quot;</code></pre>
<p>Control parameters are employed when initializing vegetation inputs and state variables using functions <code>spwbInput()</code> and <code>growthInput()</code>, since they are needed also to make decisions at the point of initialization. Control parameters are also stored in the result of these functions, so the user does not need to specify again control parameters when calling simulation functions such as <code>spwb()</code> or <code>growth()</code>. Function <code>fordyn()</code> is different than the other simulation functions, because the list control parameters is directly passed to the function (see <a href="model-inputs.html#inputstructuresmedfate">2.1.1</a>).</p>
<p>Even if the list of control parameters is long, not all control parameters are relevant to all simulation functions (this will be indicated in the following chapters), and most of them should not be altered from their default values. However, there are a set of parameters that are worth learning:</p>
<ul>
<li><code>verbose [=TRUE]</code>: Whether extra console output is desired during simulations.</li>
<li><code>transpirationMode [="Granier"]</code> is an important control parameter, because it allows the user to switch between the <em>basic</em> (i.e. <code>"Granier"</code>) and <em>advanced</em> (i.e., either <code>"Sperry"</code> or <code>"Sureau"</code>) water balance models, corresponding to chapters <a href="basicwaterbalance.html#basicwaterbalance">3</a> and <a href="advancedwaterbalance.html#advancedwaterbalance">7</a>, respectively.</li>
<li><code>rhizosphereOverlap [="total"]</code> is also a relevant parameter, since changing its default value allows considering that plants extract soil water from partially or totally unrelated water pools, as explained in <a href="model-inputs.html#plantwaterpools">2.4.8</a>.</li>
</ul>
<p>Some parameters are only relevant for parameter estimation at the stage of initialization:</p>
<ul>
<li><code>fillMissingRootParams [= TRUE]</code>: Boolean flag to indicate that initialization functions should provide estimates for <code>Z50</code> and <code>Z95</code> if these are lacking in the forest data. Note that if <code>fillMissingRootParams</code> is set to <code>FALSE</code> then simulations may fail if the user does not provide values for <code>Z50</code> and <code>Z95</code> in tree or shrub data.</li>
<li><code>fillMissingSpParams [=TRUE]</code>: Boolean flag to indicate that initialization functions should provide estimates for functional parameters if these are lacking in the species parameter table <code>SpParams</code>. Note that if <code>fillMissingSpParams</code> is set to <code>FALSE</code> then simulations may fail if the user does not provide values for required parameters.</li>
<li><code>fillMissingWithGenusParams [=TRUE]</code>: Boolean flag to indicate that initializing functions should provide estimates from genus value, if species-level values are missing in the species parameter table <code>SpParams</code> but genus-level ones are not.</li>
</ul>

</div>
</div>



<h3>Bibliography<a href="bibliography.html#bibliography" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Carsel1988" class="csl-entry">
Carsel, R.F. &amp; Parrish, R.S. (1988). Developing joint probability distributions of soil water retention characteristics. <em>Water Resources Research</em>, 24, 755–769.
</div>
<div id="ref-Collins2007" class="csl-entry">
Collins, D.B.G. &amp; Bras, R.L. (2007). <a href="https://doi.org/10.1029/2006WR005541">Plant rooting strategies in water-limited ecosystems</a>. <em>Water Resources Research</em>, 43, W06407.
</div>
<div id="ref-DeCaceres2018" class="csl-entry">
De Cáceres, M., Martin-StPaul, N., Turco, M., Cabon, A. &amp; Granda, V. (2018). <a href="https://doi.org/10.1016/j.envsoft.2018.08.003">Estimating daily meteorological data and downscaling climate models over landscapes</a>. <em>Environmental Modelling &amp; Software</em>, 108, 186–196.
</div>
<div id="ref-Genuchten1980" class="csl-entry">
Genuchten, M.V. (1980). <a href="https://dl.sciencesocieties.org/publications/sssaj/abstracts/44/5/SS0440050892">A closed-form equation for predicting the hydraulic conductivity of unsaturated soils</a>. <em>Soil science society of America journal</em>, 44, 892–898.
</div>
<div id="ref-rahimi_evaluation_2011" class="csl-entry">
Rahimi, A.A., Sepaskhah, A.R. &amp; Ahmadi, S.H. (2011). <a href="https://doi.org/10.1080/03650340.2010.498010">Evaluation of different methods for the prediction of saturated hydraulic conductivity in tilled and untilled soils</a>. <em>Archives of Agronomy and Soil Science</em>, 57, 899–914.
</div>
<div id="ref-Ruffault2013" class="csl-entry">
Ruffault, J., Martin-StPaul, N.K., Rambal, S. &amp; Mouillot, F. (2013). <a href="https://doi.org/10.1007/s10584-012-0559-5">Differential regional responses in drought length, intensity and timing to recent climate changes in a <span>Mediterranean</span> forested ecosystem</a>. <em>Climatic Change</em>, 117, 103–117.
</div>
<div id="ref-Saxton2006" class="csl-entry">
Saxton, K.E. &amp; Rawls, W.J. (2006). <a href="https://doi.org/10.2136/sssaj2005.0117">Soil water characteristic estimates by texture and organic matter for hydrologic solutions</a>. <em>Soil Science Society of America Journal</em>, 70, 1569.
</div>
<div id="ref-Saxton1986" class="csl-entry">
Saxton, K.E., Rawls, W.J., Romberger, J.S. &amp; Papendick, R.I. (1986). Estimating generalized soil-water characteristics from texture. <em>Soil Science Society of America Journal</em>, 50, 1031–1036.
</div>
<div id="ref-Schenk2002" class="csl-entry">
Schenk, H.J. &amp; Jackson, R.B. (2002). <a href="https://doi.org/10.1046/j.1365-2745.2002.00682.x">Rooting depths, lateral root spreads and below-ground/above-ground allometries of plants in water-limited ecosystems</a>. <em>Journal of Ecology</em>, 90, 480–494.
</div>
<div id="ref-Schume2004" class="csl-entry">
Schume, H., Jost, G. &amp; Hager, H. (2004). <a href="https://doi.org/10.1016/j.jhydrol.2003.11.036">Soil water depletion and recharge patterns in mixed and pure forest stands of <span>European</span> beech and <span>Norway</span> spruce</a>. <em>Journal of Hydrology</em>, 289, 258–274.
</div>
<div id="ref-Stolf2011" class="csl-entry">
Stolf, R., Thurler, Á., Oliveira, O., Bacchi, S. &amp; Reichardt, K. (2011). <a href="http://www.scielo.br/scielo.php?pid=S0100-06832011000200014&amp;script=sci_arttext">Method to estimate soil macroporosity and microporosity based on sand content and bulk density</a>. <em>Revista Brasileira de Ciencias do Solo</em>, 35, 447–459.
</div>
<div id="ref-Toth2015" class="csl-entry">
Tóth, B., Weynants, M., Nemes, A., Makó, A., Bilas, G. &amp; Tóth, G. (2015). <a href="https://doi.org/10.1111/ejss.12192">New generation of hydraulic pedotransfer functions for <span>Europe</span></a>. <em>European Journal of Soil Science</em>, 66, 226–238.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basicwaterbalance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["medfatebook.pdf", "medfatebook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
